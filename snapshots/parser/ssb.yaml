parser-snapshots:
  - name: q11_sql
    input: |-
      select sum(lo_extendedprice*lo_discount) as revenue
      from lineorder, "date"
      where lo_orderdate = d_datekey
      and d_year = 1993
      and lo_discount between 1 and 3
      and lo_quantity < 25
    expected:
      statements:
        - type: SELECT
          begin: 0
          count: 59
          node:
            type: OBJECT_SQL_SELECT
            text: "select sum..ntity < 25"
            nodes:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "sum(lo_ext..as revenue"
                nodes:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(lo_ext..as revenue"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(lo_ext.._discount)"
                        nodes:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            nodes:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "lo_extende..o_discount"
                            nodes:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "lo_extende..o_discount"
                                nodes:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "lo_extende..o_discount"
                                    nodes:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: MULTIPLY
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "lo_extende..o_discount"
                                        nodes:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "lo_extendedprice"
                                            nodes:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "lo_extendedprice"
                                                nodes:
                                                  - type: NAME
                                                    text: "lo_extendedprice"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "lo_discount"
                                            nodes:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "lo_discount"
                                                nodes:
                                                  - type: NAME
                                                    text: "lo_discount"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "revenue"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from lineo..er, \"date\""
                nodes:
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineorder"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineorder"
                        nodes:
                          - type: NAME
                            text: "lineorder"
                  - type: OBJECT_SQL_TABLEREF
                    text: "\"date\""
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "\"date\""
                        nodes:
                          - type: NAME
                            text: "\"date\""
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "lo_orderda..ntity < 25"
                nodes:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "lo_orderda..ntity < 25"
                    nodes:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_orderda.. d_datekey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_orderda.. d_datekey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_orderdate"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_orderdate"
                                    nodes:
                                      - type: NAME
                                        text: "lo_orderdate"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_datekey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_datekey"
                                    nodes:
                                      - type: NAME
                                        text: "d_datekey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "d_year = 1993"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "d_year = 1993"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_year"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_year"
                                    nodes:
                                      - type: NAME
                                        text: "d_year"
                              - type: LITERAL_INTEGER
                                text: "1993"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_discoun..en 1 and 3"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: BETWEEN_SYMMETRIC
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_discoun..en 1 and 3"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_discount"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_discount"
                                    nodes:
                                      - type: NAME
                                        text: "lo_discount"
                              - type: LITERAL_INTEGER
                                text: "1"
                              - type: LITERAL_INTEGER
                                text: "3"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_quantity < 25"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: LESS_THAN
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_quantity < 25"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_quantity"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_quantity"
                                    nodes:
                                      - type: NAME
                                        text: "lo_quantity"
                              - type: LITERAL_INTEGER
                                text: "25"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [51,52]
        - text: [74,75]
        - text: [105,106]
        - text: [123,124]
        - text: [155,156]
      comments: []
  - name: q12_sql
    input: |-
      select sum(lo_extendedprice*lo_discount) as revenue
      from lineorder, "date"
      where lo_orderdate = d_datekey
      and d_yearmonthnum = 199401
      and lo_discount between 4 and 6
      and lo_quantity between 26 and 35
    expected:
      statements:
        - type: SELECT
          begin: 0
          count: 60
          node:
            type: OBJECT_SQL_SELECT
            text: "select sum.. 26 and 35"
            nodes:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "sum(lo_ext..as revenue"
                nodes:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(lo_ext..as revenue"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(lo_ext.._discount)"
                        nodes:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            nodes:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "lo_extende..o_discount"
                            nodes:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "lo_extende..o_discount"
                                nodes:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "lo_extende..o_discount"
                                    nodes:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: MULTIPLY
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "lo_extende..o_discount"
                                        nodes:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "lo_extendedprice"
                                            nodes:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "lo_extendedprice"
                                                nodes:
                                                  - type: NAME
                                                    text: "lo_extendedprice"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "lo_discount"
                                            nodes:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "lo_discount"
                                                nodes:
                                                  - type: NAME
                                                    text: "lo_discount"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "revenue"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from lineo..er, \"date\""
                nodes:
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineorder"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineorder"
                        nodes:
                          - type: NAME
                            text: "lineorder"
                  - type: OBJECT_SQL_TABLEREF
                    text: "\"date\""
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "\"date\""
                        nodes:
                          - type: NAME
                            text: "\"date\""
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "lo_orderda.. 26 and 35"
                nodes:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "lo_orderda.. 26 and 35"
                    nodes:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_orderda.. d_datekey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_orderda.. d_datekey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_orderdate"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_orderdate"
                                    nodes:
                                      - type: NAME
                                        text: "lo_orderdate"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_datekey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_datekey"
                                    nodes:
                                      - type: NAME
                                        text: "d_datekey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "d_yearmont..m = 199401"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "d_yearmont..m = 199401"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_yearmonthnum"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_yearmonthnum"
                                    nodes:
                                      - type: NAME
                                        text: "d_yearmonthnum"
                              - type: LITERAL_INTEGER
                                text: "199401"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_discoun..en 4 and 6"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: BETWEEN_SYMMETRIC
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_discoun..en 4 and 6"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_discount"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_discount"
                                    nodes:
                                      - type: NAME
                                        text: "lo_discount"
                              - type: LITERAL_INTEGER
                                text: "4"
                              - type: LITERAL_INTEGER
                                text: "6"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_quantit.. 26 and 35"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: BETWEEN_SYMMETRIC
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_quantit.. 26 and 35"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_quantity"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_quantity"
                                    nodes:
                                      - type: NAME
                                        text: "lo_quantity"
                              - type: LITERAL_INTEGER
                                text: "26"
                              - type: LITERAL_INTEGER
                                text: "35"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [51,52]
        - text: [74,75]
        - text: [105,106]
        - text: [133,134]
        - text: [165,166]
      comments: []
  - name: q13_sql
    input: |-
      select sum(lo_extendedprice*lo_discount) as revenue
      from lineorder, "date"
      where lo_orderdate = d_datekey
      and d_weeknuminyear = 6
      and d_year = 1994
      and lo_discount between 5 and 7
      and lo_quantity between 26 and 35
    expected:
      statements:
        - type: SELECT
          begin: 0
          count: 67
          node:
            type: OBJECT_SQL_SELECT
            text: "select sum.. 26 and 35"
            nodes:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "sum(lo_ext..as revenue"
                nodes:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(lo_ext..as revenue"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(lo_ext.._discount)"
                        nodes:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            nodes:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "lo_extende..o_discount"
                            nodes:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "lo_extende..o_discount"
                                nodes:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "lo_extende..o_discount"
                                    nodes:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: MULTIPLY
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "lo_extende..o_discount"
                                        nodes:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "lo_extendedprice"
                                            nodes:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "lo_extendedprice"
                                                nodes:
                                                  - type: NAME
                                                    text: "lo_extendedprice"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "lo_discount"
                                            nodes:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "lo_discount"
                                                nodes:
                                                  - type: NAME
                                                    text: "lo_discount"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "revenue"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from lineo..er, \"date\""
                nodes:
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineorder"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineorder"
                        nodes:
                          - type: NAME
                            text: "lineorder"
                  - type: OBJECT_SQL_TABLEREF
                    text: "\"date\""
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "\"date\""
                        nodes:
                          - type: NAME
                            text: "\"date\""
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "lo_orderda.. 26 and 35"
                nodes:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "lo_orderda.. 26 and 35"
                    nodes:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_orderda.. d_datekey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_orderda.. d_datekey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_orderdate"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_orderdate"
                                    nodes:
                                      - type: NAME
                                        text: "lo_orderdate"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_datekey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_datekey"
                                    nodes:
                                      - type: NAME
                                        text: "d_datekey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "d_weeknuminyear = 6"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "d_weeknuminyear = 6"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_weeknuminyear"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_weeknuminyear"
                                    nodes:
                                      - type: NAME
                                        text: "d_weeknuminyear"
                              - type: LITERAL_INTEGER
                                text: "6"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "d_year = 1994"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "d_year = 1994"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_year"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_year"
                                    nodes:
                                      - type: NAME
                                        text: "d_year"
                              - type: LITERAL_INTEGER
                                text: "1994"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_discoun..en 5 and 7"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: BETWEEN_SYMMETRIC
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_discoun..en 5 and 7"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_discount"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_discount"
                                    nodes:
                                      - type: NAME
                                        text: "lo_discount"
                              - type: LITERAL_INTEGER
                                text: "5"
                              - type: LITERAL_INTEGER
                                text: "7"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_quantit.. 26 and 35"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: BETWEEN_SYMMETRIC
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_quantit.. 26 and 35"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_quantity"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_quantity"
                                    nodes:
                                      - type: NAME
                                        text: "lo_quantity"
                              - type: LITERAL_INTEGER
                                text: "26"
                              - type: LITERAL_INTEGER
                                text: "35"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [51,52]
        - text: [74,75]
        - text: [105,106]
        - text: [129,130]
        - text: [147,148]
        - text: [179,180]
      comments: []
  - name: q21_sql
    input: |-
      select sum(lo_revenue), d_year, p_brand1
      from lineorder, "date", part, supplier
      where lo_orderdate = d_datekey
      and lo_partkey = p_partkey
      and lo_suppkey = s_suppkey
      and p_category = 'MFGR#12'
      and s_region = 'AMERICA'
      group by d_year, p_brand1
      order by d_year, p_brand1
    expected:
      statements:
        - type: SELECT
          begin: 0
          count: 96
          node:
            type: OBJECT_SQL_SELECT
            text: "select sum.., p_brand1"
            nodes:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "sum(lo_rev.., p_brand1"
                nodes:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(lo_revenue)"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(lo_revenue)"
                        nodes:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            nodes:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "lo_revenue"
                            nodes:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "lo_revenue"
                                nodes:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "lo_revenue"
                                    nodes:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "lo_revenue"
                                        nodes:
                                          - type: NAME
                                            text: "lo_revenue"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "d_year"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "p_brand1"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_brand1"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_brand1"
                            nodes:
                              - type: NAME
                                text: "p_brand1"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from lineo.., supplier"
                nodes:
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineorder"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineorder"
                        nodes:
                          - type: NAME
                            text: "lineorder"
                  - type: OBJECT_SQL_TABLEREF
                    text: "\"date\""
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "\"date\""
                        nodes:
                          - type: NAME
                            text: "\"date\""
                  - type: OBJECT_SQL_TABLEREF
                    text: "part"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "part"
                        nodes:
                          - type: NAME
                            text: "part"
                  - type: OBJECT_SQL_TABLEREF
                    text: "supplier"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "supplier"
                        nodes:
                          - type: NAME
                            text: "supplier"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "lo_orderda.. 'AMERICA'"
                nodes:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "lo_orderda.. 'AMERICA'"
                    nodes:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_orderda.. d_datekey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_orderda.. d_datekey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_orderdate"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_orderdate"
                                    nodes:
                                      - type: NAME
                                        text: "lo_orderdate"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_datekey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_datekey"
                                    nodes:
                                      - type: NAME
                                        text: "d_datekey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_partkey.. p_partkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_partkey.. p_partkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_partkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_partkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_partkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_partkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_partkey"
                                    nodes:
                                      - type: NAME
                                        text: "p_partkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_suppkey.. s_suppkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_suppkey.. s_suppkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_suppkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "s_suppkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "p_category.. 'MFGR#12'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "p_category.. 'MFGR#12'"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_category"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_category"
                                    nodes:
                                      - type: NAME
                                        text: "p_category"
                              - type: LITERAL_STRING
                                text: "'MFGR#12'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "s_region =.. 'AMERICA'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "s_region =.. 'AMERICA'"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_region"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_region"
                                    nodes:
                                      - type: NAME
                                        text: "s_region"
                              - type: LITERAL_STRING
                                text: "'AMERICA'"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by d.., p_brand1"
                nodes:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "d_year"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "p_brand1"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_brand1"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_brand1"
                            nodes:
                              - type: NAME
                                text: "p_brand1"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by d.., p_brand1"
                nodes:
                  - type: OBJECT_SQL_ORDER
                    text: "d_year"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_ORDER
                    text: "p_brand1"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_brand1"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_brand1"
                            nodes:
                              - type: NAME
                                text: "p_brand1"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [40,41]
        - text: [79,80]
        - text: [110,111]
        - text: [137,138]
        - text: [164,165]
        - text: [191,192]
        - text: [216,217]
        - text: [242,243]
      comments: []
  - name: q22_sql
    input: |-
      select sum(lo_revenue), d_year, p_brand1
      from lineorder, "date", part, supplier
      where lo_orderdate = d_datekey
      and lo_partkey = p_partkey
      and lo_suppkey = s_suppkey
      and p_brand1 between
      'MFGR#2221' and 'MFGR#2228'
      and s_region = 'ASIA'
      group by d_year, p_brand1
      order by d_year, p_brand1
    expected:
      statements:
        - type: SELECT
          begin: 0
          count: 97
          node:
            type: OBJECT_SQL_SELECT
            text: "select sum.., p_brand1"
            nodes:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "sum(lo_rev.., p_brand1"
                nodes:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(lo_revenue)"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(lo_revenue)"
                        nodes:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            nodes:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "lo_revenue"
                            nodes:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "lo_revenue"
                                nodes:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "lo_revenue"
                                    nodes:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "lo_revenue"
                                        nodes:
                                          - type: NAME
                                            text: "lo_revenue"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "d_year"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "p_brand1"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_brand1"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_brand1"
                            nodes:
                              - type: NAME
                                text: "p_brand1"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from lineo.., supplier"
                nodes:
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineorder"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineorder"
                        nodes:
                          - type: NAME
                            text: "lineorder"
                  - type: OBJECT_SQL_TABLEREF
                    text: "\"date\""
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "\"date\""
                        nodes:
                          - type: NAME
                            text: "\"date\""
                  - type: OBJECT_SQL_TABLEREF
                    text: "part"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "part"
                        nodes:
                          - type: NAME
                            text: "part"
                  - type: OBJECT_SQL_TABLEREF
                    text: "supplier"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "supplier"
                        nodes:
                          - type: NAME
                            text: "supplier"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "lo_orderda..n = 'ASIA'"
                nodes:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "lo_orderda..n = 'ASIA'"
                    nodes:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_orderda.. d_datekey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_orderda.. d_datekey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_orderdate"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_orderdate"
                                    nodes:
                                      - type: NAME
                                        text: "lo_orderdate"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_datekey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_datekey"
                                    nodes:
                                      - type: NAME
                                        text: "d_datekey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_partkey.. p_partkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_partkey.. p_partkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_partkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_partkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_partkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_partkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_partkey"
                                    nodes:
                                      - type: NAME
                                        text: "p_partkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_suppkey.. s_suppkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_suppkey.. s_suppkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_suppkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "s_suppkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "p_brand1 b..MFGR#2228'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: BETWEEN_SYMMETRIC
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "p_brand1 b..MFGR#2228'"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_brand1"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_brand1"
                                    nodes:
                                      - type: NAME
                                        text: "p_brand1"
                              - type: LITERAL_STRING
                                text: "'MFGR#2221'"
                              - type: LITERAL_STRING
                                text: "'MFGR#2228'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "s_region = 'ASIA'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "s_region = 'ASIA'"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_region"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_region"
                                    nodes:
                                      - type: NAME
                                        text: "s_region"
                              - type: LITERAL_STRING
                                text: "'ASIA'"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by d.., p_brand1"
                nodes:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "d_year"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "p_brand1"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_brand1"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_brand1"
                            nodes:
                              - type: NAME
                                text: "p_brand1"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by d.., p_brand1"
                nodes:
                  - type: OBJECT_SQL_ORDER
                    text: "d_year"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_ORDER
                    text: "p_brand1"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_brand1"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_brand1"
                            nodes:
                              - type: NAME
                                text: "p_brand1"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [40,41]
        - text: [79,80]
        - text: [110,111]
        - text: [137,138]
        - text: [164,165]
        - text: [185,186]
        - text: [213,214]
        - text: [235,236]
        - text: [261,262]
      comments: []
  - name: q23_sql
    input: |-
      select sum(lo_revenue), d_year, p_brand1
      from lineorder, "date", part, supplier
      where lo_orderdate = d_datekey
      and lo_partkey = p_partkey
      and lo_suppkey = s_suppkey
      and p_brand1 = 'MFGR#2221'
      and s_region = 'EUROPE'
      group by d_year, p_brand1
      order by d_year, p_brand1
    expected:
      statements:
        - type: SELECT
          begin: 0
          count: 96
          node:
            type: OBJECT_SQL_SELECT
            text: "select sum.., p_brand1"
            nodes:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "sum(lo_rev.., p_brand1"
                nodes:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(lo_revenue)"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(lo_revenue)"
                        nodes:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            nodes:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "lo_revenue"
                            nodes:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "lo_revenue"
                                nodes:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "lo_revenue"
                                    nodes:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "lo_revenue"
                                        nodes:
                                          - type: NAME
                                            text: "lo_revenue"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "d_year"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "p_brand1"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_brand1"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_brand1"
                            nodes:
                              - type: NAME
                                text: "p_brand1"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from lineo.., supplier"
                nodes:
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineorder"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineorder"
                        nodes:
                          - type: NAME
                            text: "lineorder"
                  - type: OBJECT_SQL_TABLEREF
                    text: "\"date\""
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "\"date\""
                        nodes:
                          - type: NAME
                            text: "\"date\""
                  - type: OBJECT_SQL_TABLEREF
                    text: "part"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "part"
                        nodes:
                          - type: NAME
                            text: "part"
                  - type: OBJECT_SQL_TABLEREF
                    text: "supplier"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "supplier"
                        nodes:
                          - type: NAME
                            text: "supplier"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "lo_orderda..= 'EUROPE'"
                nodes:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "lo_orderda..= 'EUROPE'"
                    nodes:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_orderda.. d_datekey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_orderda.. d_datekey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_orderdate"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_orderdate"
                                    nodes:
                                      - type: NAME
                                        text: "lo_orderdate"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_datekey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_datekey"
                                    nodes:
                                      - type: NAME
                                        text: "d_datekey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_partkey.. p_partkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_partkey.. p_partkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_partkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_partkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_partkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_partkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_partkey"
                                    nodes:
                                      - type: NAME
                                        text: "p_partkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_suppkey.. s_suppkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_suppkey.. s_suppkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_suppkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "s_suppkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "p_brand1 =..MFGR#2221'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "p_brand1 =..MFGR#2221'"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_brand1"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_brand1"
                                    nodes:
                                      - type: NAME
                                        text: "p_brand1"
                              - type: LITERAL_STRING
                                text: "'MFGR#2221'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "s_region = 'EUROPE'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "s_region = 'EUROPE'"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_region"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_region"
                                    nodes:
                                      - type: NAME
                                        text: "s_region"
                              - type: LITERAL_STRING
                                text: "'EUROPE'"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by d.., p_brand1"
                nodes:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "d_year"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "p_brand1"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_brand1"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_brand1"
                            nodes:
                              - type: NAME
                                text: "p_brand1"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by d.., p_brand1"
                nodes:
                  - type: OBJECT_SQL_ORDER
                    text: "d_year"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_ORDER
                    text: "p_brand1"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_brand1"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_brand1"
                            nodes:
                              - type: NAME
                                text: "p_brand1"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [40,41]
        - text: [79,80]
        - text: [110,111]
        - text: [137,138]
        - text: [164,165]
        - text: [191,192]
        - text: [215,216]
        - text: [241,242]
      comments: []
  - name: q31_sql
    input: |-
      select c_nation, s_nation, d_year, sum(lo_revenue)
      as revenue from customer, lineorder, supplier, "date"
      where lo_custkey = c_custkey
      and lo_suppkey = s_suppkey
      and lo_orderdate = d_datekey
      and c_region = 'ASIA' and s_region = 'ASIA'
      and d_year >= 1992 and d_year <= 1997
      group by c_nation, s_nation, d_year
      order by d_year asc, revenue desc
    expected:
      statements:
        - type: SELECT
          begin: 0
          count: 122
          node:
            type: OBJECT_SQL_SELECT
            text: "select c_n..venue desc"
            nodes:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "c_nation, ..as revenue"
                nodes:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "c_nation"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_nation"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_nation"
                            nodes:
                              - type: NAME
                                text: "c_nation"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "s_nation"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_nation"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_nation"
                            nodes:
                              - type: NAME
                                text: "s_nation"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "d_year"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(lo_rev..as revenue"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(lo_revenue)"
                        nodes:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            nodes:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "lo_revenue"
                            nodes:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "lo_revenue"
                                nodes:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "lo_revenue"
                                    nodes:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "lo_revenue"
                                        nodes:
                                          - type: NAME
                                            text: "lo_revenue"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "revenue"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from custo..er, \"date\""
                nodes:
                  - type: OBJECT_SQL_TABLEREF
                    text: "customer"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "customer"
                        nodes:
                          - type: NAME
                            text: "customer"
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineorder"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineorder"
                        nodes:
                          - type: NAME
                            text: "lineorder"
                  - type: OBJECT_SQL_TABLEREF
                    text: "supplier"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "supplier"
                        nodes:
                          - type: NAME
                            text: "supplier"
                  - type: OBJECT_SQL_TABLEREF
                    text: "\"date\""
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "\"date\""
                        nodes:
                          - type: NAME
                            text: "\"date\""
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "lo_custkey..ar <= 1997"
                nodes:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "lo_custkey..ar <= 1997"
                    nodes:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_custkey.. c_custkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_custkey.. c_custkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_custkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_custkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_custkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "c_custkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "c_custkey"
                                    nodes:
                                      - type: NAME
                                        text: "c_custkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_suppkey.. s_suppkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_suppkey.. s_suppkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_suppkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "s_suppkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_orderda.. d_datekey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_orderda.. d_datekey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_orderdate"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_orderdate"
                                    nodes:
                                      - type: NAME
                                        text: "lo_orderdate"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_datekey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_datekey"
                                    nodes:
                                      - type: NAME
                                        text: "d_datekey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "c_region = 'ASIA'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "c_region = 'ASIA'"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "c_region"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "c_region"
                                    nodes:
                                      - type: NAME
                                        text: "c_region"
                              - type: LITERAL_STRING
                                text: "'ASIA'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "s_region = 'ASIA'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "s_region = 'ASIA'"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_region"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_region"
                                    nodes:
                                      - type: NAME
                                        text: "s_region"
                              - type: LITERAL_STRING
                                text: "'ASIA'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "d_year >= 1992"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: GREATER_EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "d_year >= 1992"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_year"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_year"
                                    nodes:
                                      - type: NAME
                                        text: "d_year"
                              - type: LITERAL_INTEGER
                                text: "1992"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "d_year <= 1997"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: LESS_EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "d_year <= 1997"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_year"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_year"
                                    nodes:
                                      - type: NAME
                                        text: "d_year"
                              - type: LITERAL_INTEGER
                                text: "1997"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by c..on, d_year"
                nodes:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "c_nation"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_nation"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_nation"
                            nodes:
                              - type: NAME
                                text: "c_nation"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "s_nation"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_nation"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_nation"
                            nodes:
                              - type: NAME
                                text: "s_nation"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "d_year"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by d..venue desc"
                nodes:
                  - type: OBJECT_SQL_ORDER
                    text: "d_year asc"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                      - key: SQL_ORDER_DIRECTION
                        type: ENUM_SQL_ORDER_DIRECTION
                        value: ASCENDING
                  - type: OBJECT_SQL_ORDER
                    text: "revenue desc"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "revenue"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "revenue"
                            nodes:
                              - type: NAME
                                text: "revenue"
                      - key: SQL_ORDER_DIRECTION
                        type: ENUM_SQL_ORDER_DIRECTION
                        value: DESCENDING
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [50,51]
        - text: [104,105]
        - text: [133,134]
        - text: [160,161]
        - text: [189,190]
        - text: [233,234]
        - text: [271,272]
        - text: [307,308]
      comments: []
  - name: q32_sql
    input: |-
      select c_city, s_city, d_year, sum(lo_revenue) as revenue
      from customer, lineorder, supplier, "date"
      where lo_custkey = c_custkey
      and lo_suppkey = s_suppkey
      and lo_orderdate = d_datekey
      and c_nation = 'UNITED STATES'
      and s_nation = 'UNITED STATES'
      and d_year >= 1992 and d_year <= 1997
      group by c_city, s_city, d_year
      order by d_year asc, revenue desc
    expected:
      statements:
        - type: SELECT
          begin: 0
          count: 122
          node:
            type: OBJECT_SQL_SELECT
            text: "select c_c..venue desc"
            nodes:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "c_city, s_..as revenue"
                nodes:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "c_city"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_city"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_city"
                            nodes:
                              - type: NAME
                                text: "c_city"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "s_city"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_city"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_city"
                            nodes:
                              - type: NAME
                                text: "s_city"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "d_year"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(lo_rev..as revenue"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(lo_revenue)"
                        nodes:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            nodes:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "lo_revenue"
                            nodes:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "lo_revenue"
                                nodes:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "lo_revenue"
                                    nodes:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "lo_revenue"
                                        nodes:
                                          - type: NAME
                                            text: "lo_revenue"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "revenue"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from custo..er, \"date\""
                nodes:
                  - type: OBJECT_SQL_TABLEREF
                    text: "customer"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "customer"
                        nodes:
                          - type: NAME
                            text: "customer"
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineorder"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineorder"
                        nodes:
                          - type: NAME
                            text: "lineorder"
                  - type: OBJECT_SQL_TABLEREF
                    text: "supplier"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "supplier"
                        nodes:
                          - type: NAME
                            text: "supplier"
                  - type: OBJECT_SQL_TABLEREF
                    text: "\"date\""
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "\"date\""
                        nodes:
                          - type: NAME
                            text: "\"date\""
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "lo_custkey..ar <= 1997"
                nodes:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "lo_custkey..ar <= 1997"
                    nodes:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_custkey.. c_custkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_custkey.. c_custkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_custkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_custkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_custkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "c_custkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "c_custkey"
                                    nodes:
                                      - type: NAME
                                        text: "c_custkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_suppkey.. s_suppkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_suppkey.. s_suppkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_suppkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "s_suppkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_orderda.. d_datekey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_orderda.. d_datekey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_orderdate"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_orderdate"
                                    nodes:
                                      - type: NAME
                                        text: "lo_orderdate"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_datekey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_datekey"
                                    nodes:
                                      - type: NAME
                                        text: "d_datekey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "c_nation =..ED STATES'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "c_nation =..ED STATES'"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "c_nation"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "c_nation"
                                    nodes:
                                      - type: NAME
                                        text: "c_nation"
                              - type: LITERAL_STRING
                                text: "'UNITED STATES'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "s_nation =..ED STATES'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "s_nation =..ED STATES'"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_nation"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_nation"
                                    nodes:
                                      - type: NAME
                                        text: "s_nation"
                              - type: LITERAL_STRING
                                text: "'UNITED STATES'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "d_year >= 1992"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: GREATER_EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "d_year >= 1992"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_year"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_year"
                                    nodes:
                                      - type: NAME
                                        text: "d_year"
                              - type: LITERAL_INTEGER
                                text: "1992"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "d_year <= 1997"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: LESS_EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "d_year <= 1997"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_year"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_year"
                                    nodes:
                                      - type: NAME
                                        text: "d_year"
                              - type: LITERAL_INTEGER
                                text: "1997"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by c..ty, d_year"
                nodes:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "c_city"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_city"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_city"
                            nodes:
                              - type: NAME
                                text: "c_city"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "s_city"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_city"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_city"
                            nodes:
                              - type: NAME
                                text: "s_city"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "d_year"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by d..venue desc"
                nodes:
                  - type: OBJECT_SQL_ORDER
                    text: "d_year asc"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                      - key: SQL_ORDER_DIRECTION
                        type: ENUM_SQL_ORDER_DIRECTION
                        value: ASCENDING
                  - type: OBJECT_SQL_ORDER
                    text: "revenue desc"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "revenue"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "revenue"
                            nodes:
                              - type: NAME
                                text: "revenue"
                      - key: SQL_ORDER_DIRECTION
                        type: ENUM_SQL_ORDER_DIRECTION
                        value: DESCENDING
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [57,58]
        - text: [100,101]
        - text: [129,130]
        - text: [156,157]
        - text: [185,186]
        - text: [216,217]
        - text: [247,248]
        - text: [285,286]
        - text: [317,318]
      comments: []
  - name: q33_sql
    input: |-
      select c_city, s_city, d_year, sum(lo_revenue) as revenue
      from customer, lineorder, supplier, "date"
      where lo_custkey = c_custkey
      and lo_suppkey = s_suppkey
      and lo_orderdate = d_datekey
      and (c_city='UNITED KI1'
      or c_city='UNITED KI5')
      and (s_city='UNITED KI1'
      or s_city='UNITED KI5')
      and d_year >= 1992 and d_year <= 1997
      group by c_city, s_city, d_year
      order by d_year asc, revenue desc
    expected:
      statements:
        - type: SELECT
          begin: 0
          count: 142
          node:
            type: OBJECT_SQL_SELECT
            text: "select c_c..venue desc"
            nodes:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "c_city, s_..as revenue"
                nodes:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "c_city"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_city"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_city"
                            nodes:
                              - type: NAME
                                text: "c_city"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "s_city"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_city"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_city"
                            nodes:
                              - type: NAME
                                text: "s_city"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "d_year"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(lo_rev..as revenue"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(lo_revenue)"
                        nodes:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            nodes:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "lo_revenue"
                            nodes:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "lo_revenue"
                                nodes:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "lo_revenue"
                                    nodes:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "lo_revenue"
                                        nodes:
                                          - type: NAME
                                            text: "lo_revenue"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "revenue"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from custo..er, \"date\""
                nodes:
                  - type: OBJECT_SQL_TABLEREF
                    text: "customer"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "customer"
                        nodes:
                          - type: NAME
                            text: "customer"
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineorder"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineorder"
                        nodes:
                          - type: NAME
                            text: "lineorder"
                  - type: OBJECT_SQL_TABLEREF
                    text: "supplier"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "supplier"
                        nodes:
                          - type: NAME
                            text: "supplier"
                  - type: OBJECT_SQL_TABLEREF
                    text: "\"date\""
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "\"date\""
                        nodes:
                          - type: NAME
                            text: "\"date\""
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "lo_custkey..ar <= 1997"
                nodes:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "lo_custkey..ar <= 1997"
                    nodes:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_custkey.. c_custkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_custkey.. c_custkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_custkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_custkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_custkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "c_custkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "c_custkey"
                                    nodes:
                                      - type: NAME
                                        text: "c_custkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_suppkey.. s_suppkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_suppkey.. s_suppkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_suppkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "s_suppkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_orderda.. d_datekey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_orderda.. d_datekey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_orderdate"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_orderdate"
                                    nodes:
                                      - type: NAME
                                        text: "lo_orderdate"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_datekey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_datekey"
                                    nodes:
                                      - type: NAME
                                        text: "d_datekey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "c_city='UN..NITED KI5'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: OR
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "c_city='UN..NITED KI5'"
                            nodes:
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "c_city='UNITED KI1'"
                                nodes:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "c_city='UNITED KI1'"
                                    nodes:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "c_city"
                                        nodes:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "c_city"
                                            nodes:
                                              - type: NAME
                                                text: "c_city"
                                      - type: LITERAL_STRING
                                        text: "'UNITED KI1'"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "c_city='UNITED KI5'"
                                nodes:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "c_city='UNITED KI5'"
                                    nodes:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "c_city"
                                        nodes:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "c_city"
                                            nodes:
                                              - type: NAME
                                                text: "c_city"
                                      - type: LITERAL_STRING
                                        text: "'UNITED KI5'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "s_city='UN..NITED KI5'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: OR
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "s_city='UN..NITED KI5'"
                            nodes:
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "s_city='UNITED KI1'"
                                nodes:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "s_city='UNITED KI1'"
                                    nodes:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "s_city"
                                        nodes:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "s_city"
                                            nodes:
                                              - type: NAME
                                                text: "s_city"
                                      - type: LITERAL_STRING
                                        text: "'UNITED KI1'"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "s_city='UNITED KI5'"
                                nodes:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "s_city='UNITED KI5'"
                                    nodes:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "s_city"
                                        nodes:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "s_city"
                                            nodes:
                                              - type: NAME
                                                text: "s_city"
                                      - type: LITERAL_STRING
                                        text: "'UNITED KI5'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "d_year >= 1992"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: GREATER_EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "d_year >= 1992"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_year"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_year"
                                    nodes:
                                      - type: NAME
                                        text: "d_year"
                              - type: LITERAL_INTEGER
                                text: "1992"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "d_year <= 1997"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: LESS_EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "d_year <= 1997"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_year"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_year"
                                    nodes:
                                      - type: NAME
                                        text: "d_year"
                              - type: LITERAL_INTEGER
                                text: "1997"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by c..ty, d_year"
                nodes:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "c_city"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_city"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_city"
                            nodes:
                              - type: NAME
                                text: "c_city"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "s_city"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_city"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_city"
                            nodes:
                              - type: NAME
                                text: "s_city"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "d_year"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by d..venue desc"
                nodes:
                  - type: OBJECT_SQL_ORDER
                    text: "d_year asc"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                      - key: SQL_ORDER_DIRECTION
                        type: ENUM_SQL_ORDER_DIRECTION
                        value: ASCENDING
                  - type: OBJECT_SQL_ORDER
                    text: "revenue desc"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "revenue"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "revenue"
                            nodes:
                              - type: NAME
                                text: "revenue"
                      - key: SQL_ORDER_DIRECTION
                        type: ENUM_SQL_ORDER_DIRECTION
                        value: DESCENDING
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [57,58]
        - text: [100,101]
        - text: [129,130]
        - text: [156,157]
        - text: [185,186]
        - text: [210,211]
        - text: [234,235]
        - text: [259,260]
        - text: [283,284]
        - text: [321,322]
        - text: [353,354]
      comments: []
  - name: q34_sql
    input: |-
      select c_city, s_city, d_year, sum(lo_revenue) as revenue
      from customer, lineorder, supplier, "date"
      where lo_custkey = c_custkey
      and lo_suppkey = s_suppkey
      and lo_orderdate = d_datekey
      and (c_city='UNITED KI1' or
      c_city='UNITED KI5')
      and (s_city='UNITED KI1' or
      s_city='UNITED KI5')
      and d_yearmonth = 'Dec1997'
      group by c_city, s_city, d_year
      order by d_year asc, revenue desc
    expected:
      statements:
        - type: SELECT
          begin: 0
          count: 135
          node:
            type: OBJECT_SQL_SELECT
            text: "select c_c..venue desc"
            nodes:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "c_city, s_..as revenue"
                nodes:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "c_city"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_city"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_city"
                            nodes:
                              - type: NAME
                                text: "c_city"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "s_city"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_city"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_city"
                            nodes:
                              - type: NAME
                                text: "s_city"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "d_year"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(lo_rev..as revenue"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(lo_revenue)"
                        nodes:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            nodes:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "lo_revenue"
                            nodes:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "lo_revenue"
                                nodes:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "lo_revenue"
                                    nodes:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "lo_revenue"
                                        nodes:
                                          - type: NAME
                                            text: "lo_revenue"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "revenue"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from custo..er, \"date\""
                nodes:
                  - type: OBJECT_SQL_TABLEREF
                    text: "customer"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "customer"
                        nodes:
                          - type: NAME
                            text: "customer"
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineorder"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineorder"
                        nodes:
                          - type: NAME
                            text: "lineorder"
                  - type: OBJECT_SQL_TABLEREF
                    text: "supplier"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "supplier"
                        nodes:
                          - type: NAME
                            text: "supplier"
                  - type: OBJECT_SQL_TABLEREF
                    text: "\"date\""
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "\"date\""
                        nodes:
                          - type: NAME
                            text: "\"date\""
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "lo_custkey.. 'Dec1997'"
                nodes:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "lo_custkey.. 'Dec1997'"
                    nodes:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_custkey.. c_custkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_custkey.. c_custkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_custkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_custkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_custkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "c_custkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "c_custkey"
                                    nodes:
                                      - type: NAME
                                        text: "c_custkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_suppkey.. s_suppkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_suppkey.. s_suppkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_suppkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "s_suppkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_orderda.. d_datekey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_orderda.. d_datekey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_orderdate"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_orderdate"
                                    nodes:
                                      - type: NAME
                                        text: "lo_orderdate"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_datekey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_datekey"
                                    nodes:
                                      - type: NAME
                                        text: "d_datekey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "c_city='UN..NITED KI5'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: OR
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "c_city='UN..NITED KI5'"
                            nodes:
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "c_city='UNITED KI1'"
                                nodes:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "c_city='UNITED KI1'"
                                    nodes:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "c_city"
                                        nodes:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "c_city"
                                            nodes:
                                              - type: NAME
                                                text: "c_city"
                                      - type: LITERAL_STRING
                                        text: "'UNITED KI1'"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "c_city='UNITED KI5'"
                                nodes:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "c_city='UNITED KI5'"
                                    nodes:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "c_city"
                                        nodes:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "c_city"
                                            nodes:
                                              - type: NAME
                                                text: "c_city"
                                      - type: LITERAL_STRING
                                        text: "'UNITED KI5'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "s_city='UN..NITED KI5'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: OR
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "s_city='UN..NITED KI5'"
                            nodes:
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "s_city='UNITED KI1'"
                                nodes:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "s_city='UNITED KI1'"
                                    nodes:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "s_city"
                                        nodes:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "s_city"
                                            nodes:
                                              - type: NAME
                                                text: "s_city"
                                      - type: LITERAL_STRING
                                        text: "'UNITED KI1'"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "s_city='UNITED KI5'"
                                nodes:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "s_city='UNITED KI5'"
                                    nodes:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "s_city"
                                        nodes:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "s_city"
                                            nodes:
                                              - type: NAME
                                                text: "s_city"
                                      - type: LITERAL_STRING
                                        text: "'UNITED KI5'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "d_yearmont.. 'Dec1997'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "d_yearmont.. 'Dec1997'"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_yearmonth"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_yearmonth"
                                    nodes:
                                      - type: NAME
                                        text: "d_yearmonth"
                              - type: LITERAL_STRING
                                text: "'Dec1997'"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by c..ty, d_year"
                nodes:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "c_city"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_city"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_city"
                            nodes:
                              - type: NAME
                                text: "c_city"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "s_city"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_city"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_city"
                            nodes:
                              - type: NAME
                                text: "s_city"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "d_year"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by d..venue desc"
                nodes:
                  - type: OBJECT_SQL_ORDER
                    text: "d_year asc"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                      - key: SQL_ORDER_DIRECTION
                        type: ENUM_SQL_ORDER_DIRECTION
                        value: ASCENDING
                  - type: OBJECT_SQL_ORDER
                    text: "revenue desc"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "revenue"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "revenue"
                            nodes:
                              - type: NAME
                                text: "revenue"
                      - key: SQL_ORDER_DIRECTION
                        type: ENUM_SQL_ORDER_DIRECTION
                        value: DESCENDING
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [57,58]
        - text: [100,101]
        - text: [129,130]
        - text: [156,157]
        - text: [185,186]
        - text: [213,214]
        - text: [234,235]
        - text: [262,263]
        - text: [283,284]
        - text: [311,312]
        - text: [343,344]
      comments: []
  - name: q41_sql
    input: |-
      select d_year, c_nation, sum(lo_revenue - lo_supplycost) as profit
      from "date", customer, supplier, part, lineorder
      where lo_custkey = c_custkey
      and lo_suppkey = s_suppkey
      and lo_partkey = p_partkey
      and lo_orderdate = d_datekey
      and c_region = 'AMERICA'
      and s_region = 'AMERICA'
      and (p_mfgr = 'MFGR#1' or p_mfgr = 'MFGR#2')
      group by d_year, c_nation
      order by d_year, c_nation
    expected:
      statements:
        - type: SELECT
          begin: 0
          count: 132
          node:
            type: OBJECT_SQL_SELECT
            text: "select d_y.., c_nation"
            nodes:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "d_year, c_.. as profit"
                nodes:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "d_year"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "c_nation"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_nation"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_nation"
                            nodes:
                              - type: NAME
                                text: "c_nation"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(lo_rev.. as profit"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(lo_rev..upplycost)"
                        nodes:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            nodes:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "lo_revenue..supplycost"
                            nodes:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "lo_revenue..supplycost"
                                nodes:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "lo_revenue..supplycost"
                                    nodes:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: MINUS
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "lo_revenue..supplycost"
                                        nodes:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "lo_revenue"
                                            nodes:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "lo_revenue"
                                                nodes:
                                                  - type: NAME
                                                    text: "lo_revenue"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "lo_supplycost"
                                            nodes:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "lo_supplycost"
                                                nodes:
                                                  - type: NAME
                                                    text: "lo_supplycost"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "profit"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from \"date.. lineorder"
                nodes:
                  - type: OBJECT_SQL_TABLEREF
                    text: "\"date\""
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "\"date\""
                        nodes:
                          - type: NAME
                            text: "\"date\""
                  - type: OBJECT_SQL_TABLEREF
                    text: "customer"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "customer"
                        nodes:
                          - type: NAME
                            text: "customer"
                  - type: OBJECT_SQL_TABLEREF
                    text: "supplier"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "supplier"
                        nodes:
                          - type: NAME
                            text: "supplier"
                  - type: OBJECT_SQL_TABLEREF
                    text: "part"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "part"
                        nodes:
                          - type: NAME
                            text: "part"
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineorder"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineorder"
                        nodes:
                          - type: NAME
                            text: "lineorder"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "lo_custkey.. 'MFGR#2')"
                nodes:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "lo_custkey.. 'MFGR#2')"
                    nodes:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_custkey.. c_custkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_custkey.. c_custkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_custkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_custkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_custkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "c_custkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "c_custkey"
                                    nodes:
                                      - type: NAME
                                        text: "c_custkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_suppkey.. s_suppkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_suppkey.. s_suppkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_suppkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "s_suppkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_partkey.. p_partkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_partkey.. p_partkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_partkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_partkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_partkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_partkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_partkey"
                                    nodes:
                                      - type: NAME
                                        text: "p_partkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_orderda.. d_datekey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_orderda.. d_datekey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_orderdate"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_orderdate"
                                    nodes:
                                      - type: NAME
                                        text: "lo_orderdate"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_datekey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_datekey"
                                    nodes:
                                      - type: NAME
                                        text: "d_datekey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "c_region =.. 'AMERICA'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "c_region =.. 'AMERICA'"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "c_region"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "c_region"
                                    nodes:
                                      - type: NAME
                                        text: "c_region"
                              - type: LITERAL_STRING
                                text: "'AMERICA'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "s_region =.. 'AMERICA'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "s_region =.. 'AMERICA'"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_region"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_region"
                                    nodes:
                                      - type: NAME
                                        text: "s_region"
                              - type: LITERAL_STRING
                                text: "'AMERICA'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "p_mfgr = '..= 'MFGR#2'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: OR
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "p_mfgr = '..= 'MFGR#2'"
                            nodes:
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "p_mfgr = 'MFGR#1'"
                                nodes:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "p_mfgr = 'MFGR#1'"
                                    nodes:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "p_mfgr"
                                        nodes:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "p_mfgr"
                                            nodes:
                                              - type: NAME
                                                text: "p_mfgr"
                                      - type: LITERAL_STRING
                                        text: "'MFGR#1'"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "p_mfgr = 'MFGR#2'"
                                nodes:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "p_mfgr = 'MFGR#2'"
                                    nodes:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "p_mfgr"
                                        nodes:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "p_mfgr"
                                            nodes:
                                              - type: NAME
                                                text: "p_mfgr"
                                      - type: LITERAL_STRING
                                        text: "'MFGR#2'"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by d.., c_nation"
                nodes:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "d_year"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "c_nation"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_nation"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_nation"
                            nodes:
                              - type: NAME
                                text: "c_nation"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by d.., c_nation"
                nodes:
                  - type: OBJECT_SQL_ORDER
                    text: "d_year"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_ORDER
                    text: "c_nation"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_nation"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_nation"
                            nodes:
                              - type: NAME
                                text: "c_nation"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [66,67]
        - text: [115,116]
        - text: [144,145]
        - text: [171,172]
        - text: [198,199]
        - text: [227,228]
        - text: [252,253]
        - text: [277,278]
        - text: [322,323]
        - text: [348,349]
      comments: []
  - name: q42_sql
    input: |-
      select d_year, s_nation, p_category, sum(lo_revenue - lo_supplycost) as profit
      from "date", customer, supplier, part, lineorder
      where lo_custkey = c_custkey
      and lo_suppkey = s_suppkey
      and lo_partkey = p_partkey
      and lo_orderdate = d_datekey
      and c_region = 'AMERICA'
      and s_region = 'AMERICA'
      and (d_year = 1997 or d_year = 1998)
      and (p_mfgr = 'MFGR#1'
      or p_mfgr = 'MFGR#2')
      group by d_year, s_nation, p_category
      order by d_year, s_nation, p_category
    expected:
      statements:
        - type: SELECT
          begin: 0
          count: 162
          node:
            type: OBJECT_SQL_SELECT
            text: "select d_y..p_category"
            nodes:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "d_year, s_.. as profit"
                nodes:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "d_year"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "s_nation"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_nation"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_nation"
                            nodes:
                              - type: NAME
                                text: "s_nation"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "p_category"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_category"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_category"
                            nodes:
                              - type: NAME
                                text: "p_category"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(lo_rev.. as profit"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(lo_rev..upplycost)"
                        nodes:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            nodes:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "lo_revenue..supplycost"
                            nodes:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "lo_revenue..supplycost"
                                nodes:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "lo_revenue..supplycost"
                                    nodes:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: MINUS
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "lo_revenue..supplycost"
                                        nodes:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "lo_revenue"
                                            nodes:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "lo_revenue"
                                                nodes:
                                                  - type: NAME
                                                    text: "lo_revenue"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "lo_supplycost"
                                            nodes:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "lo_supplycost"
                                                nodes:
                                                  - type: NAME
                                                    text: "lo_supplycost"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "profit"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from \"date.. lineorder"
                nodes:
                  - type: OBJECT_SQL_TABLEREF
                    text: "\"date\""
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "\"date\""
                        nodes:
                          - type: NAME
                            text: "\"date\""
                  - type: OBJECT_SQL_TABLEREF
                    text: "customer"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "customer"
                        nodes:
                          - type: NAME
                            text: "customer"
                  - type: OBJECT_SQL_TABLEREF
                    text: "supplier"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "supplier"
                        nodes:
                          - type: NAME
                            text: "supplier"
                  - type: OBJECT_SQL_TABLEREF
                    text: "part"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "part"
                        nodes:
                          - type: NAME
                            text: "part"
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineorder"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineorder"
                        nodes:
                          - type: NAME
                            text: "lineorder"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "lo_custkey.. 'MFGR#2')"
                nodes:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "lo_custkey.. 'MFGR#2')"
                    nodes:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_custkey.. c_custkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_custkey.. c_custkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_custkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_custkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_custkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "c_custkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "c_custkey"
                                    nodes:
                                      - type: NAME
                                        text: "c_custkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_suppkey.. s_suppkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_suppkey.. s_suppkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_suppkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "s_suppkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_partkey.. p_partkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_partkey.. p_partkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_partkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_partkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_partkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_partkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_partkey"
                                    nodes:
                                      - type: NAME
                                        text: "p_partkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_orderda.. d_datekey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_orderda.. d_datekey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_orderdate"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_orderdate"
                                    nodes:
                                      - type: NAME
                                        text: "lo_orderdate"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_datekey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_datekey"
                                    nodes:
                                      - type: NAME
                                        text: "d_datekey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "c_region =.. 'AMERICA'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "c_region =.. 'AMERICA'"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "c_region"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "c_region"
                                    nodes:
                                      - type: NAME
                                        text: "c_region"
                              - type: LITERAL_STRING
                                text: "'AMERICA'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "s_region =.. 'AMERICA'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "s_region =.. 'AMERICA'"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_region"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_region"
                                    nodes:
                                      - type: NAME
                                        text: "s_region"
                              - type: LITERAL_STRING
                                text: "'AMERICA'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "d_year = 1..ear = 1998"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: OR
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "d_year = 1..ear = 1998"
                            nodes:
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "d_year = 1997"
                                nodes:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "d_year = 1997"
                                    nodes:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "d_year"
                                        nodes:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "d_year"
                                            nodes:
                                              - type: NAME
                                                text: "d_year"
                                      - type: LITERAL_INTEGER
                                        text: "1997"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "d_year = 1998"
                                nodes:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "d_year = 1998"
                                    nodes:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "d_year"
                                        nodes:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "d_year"
                                            nodes:
                                              - type: NAME
                                                text: "d_year"
                                      - type: LITERAL_INTEGER
                                        text: "1998"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "p_mfgr = '..= 'MFGR#2'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: OR
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "p_mfgr = '..= 'MFGR#2'"
                            nodes:
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "p_mfgr = 'MFGR#1'"
                                nodes:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "p_mfgr = 'MFGR#1'"
                                    nodes:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "p_mfgr"
                                        nodes:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "p_mfgr"
                                            nodes:
                                              - type: NAME
                                                text: "p_mfgr"
                                      - type: LITERAL_STRING
                                        text: "'MFGR#1'"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "p_mfgr = 'MFGR#2'"
                                nodes:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "p_mfgr = 'MFGR#2'"
                                    nodes:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "p_mfgr"
                                        nodes:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "p_mfgr"
                                            nodes:
                                              - type: NAME
                                                text: "p_mfgr"
                                      - type: LITERAL_STRING
                                        text: "'MFGR#2'"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by d..p_category"
                nodes:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "d_year"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "s_nation"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_nation"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_nation"
                            nodes:
                              - type: NAME
                                text: "s_nation"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "p_category"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_category"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_category"
                            nodes:
                              - type: NAME
                                text: "p_category"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by d..p_category"
                nodes:
                  - type: OBJECT_SQL_ORDER
                    text: "d_year"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_ORDER
                    text: "s_nation"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_nation"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_nation"
                            nodes:
                              - type: NAME
                                text: "s_nation"
                  - type: OBJECT_SQL_ORDER
                    text: "p_category"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_category"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_category"
                            nodes:
                              - type: NAME
                                text: "p_category"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [78,79]
        - text: [127,128]
        - text: [156,157]
        - text: [183,184]
        - text: [210,211]
        - text: [239,240]
        - text: [264,265]
        - text: [289,290]
        - text: [326,327]
        - text: [349,350]
        - text: [371,372]
        - text: [409,410]
      comments: []
  - name: q43_sql
    input: |-
      select d_year, s_city, p_brand1, sum(lo_revenue - lo_supplycost) as profit
      from "date", customer, supplier, part, lineorder
      where lo_custkey = c_custkey
      and lo_suppkey = s_suppkey
      and lo_partkey = p_partkey
      and lo_orderdate = d_datekey
      and c_region = 'AMERICA'
      and s_nation = 'UNITED STATES'
      and (d_year = 1997 or d_year = 1998)
      and p_category = 'MFGR#14'
      group by d_year, s_city, p_brand1
      order by d_year, s_city, p_brand1
    expected:
      statements:
        - type: SELECT
          begin: 0
          count: 152
          node:
            type: OBJECT_SQL_SELECT
            text: "select d_y.., p_brand1"
            nodes:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "d_year, s_.. as profit"
                nodes:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "d_year"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "s_city"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_city"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_city"
                            nodes:
                              - type: NAME
                                text: "s_city"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "p_brand1"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_brand1"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_brand1"
                            nodes:
                              - type: NAME
                                text: "p_brand1"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(lo_rev.. as profit"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(lo_rev..upplycost)"
                        nodes:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            nodes:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "lo_revenue..supplycost"
                            nodes:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "lo_revenue..supplycost"
                                nodes:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "lo_revenue..supplycost"
                                    nodes:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: MINUS
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "lo_revenue..supplycost"
                                        nodes:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "lo_revenue"
                                            nodes:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "lo_revenue"
                                                nodes:
                                                  - type: NAME
                                                    text: "lo_revenue"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "lo_supplycost"
                                            nodes:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "lo_supplycost"
                                                nodes:
                                                  - type: NAME
                                                    text: "lo_supplycost"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "profit"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from \"date.. lineorder"
                nodes:
                  - type: OBJECT_SQL_TABLEREF
                    text: "\"date\""
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "\"date\""
                        nodes:
                          - type: NAME
                            text: "\"date\""
                  - type: OBJECT_SQL_TABLEREF
                    text: "customer"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "customer"
                        nodes:
                          - type: NAME
                            text: "customer"
                  - type: OBJECT_SQL_TABLEREF
                    text: "supplier"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "supplier"
                        nodes:
                          - type: NAME
                            text: "supplier"
                  - type: OBJECT_SQL_TABLEREF
                    text: "part"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "part"
                        nodes:
                          - type: NAME
                            text: "part"
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineorder"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineorder"
                        nodes:
                          - type: NAME
                            text: "lineorder"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "lo_custkey.. 'MFGR#14'"
                nodes:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "lo_custkey.. 'MFGR#14'"
                    nodes:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_custkey.. c_custkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_custkey.. c_custkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_custkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_custkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_custkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "c_custkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "c_custkey"
                                    nodes:
                                      - type: NAME
                                        text: "c_custkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_suppkey.. s_suppkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_suppkey.. s_suppkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_suppkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_suppkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_suppkey"
                                    nodes:
                                      - type: NAME
                                        text: "s_suppkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_partkey.. p_partkey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_partkey.. p_partkey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_partkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_partkey"
                                    nodes:
                                      - type: NAME
                                        text: "lo_partkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_partkey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_partkey"
                                    nodes:
                                      - type: NAME
                                        text: "p_partkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "lo_orderda.. d_datekey"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "lo_orderda.. d_datekey"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "lo_orderdate"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "lo_orderdate"
                                    nodes:
                                      - type: NAME
                                        text: "lo_orderdate"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "d_datekey"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "d_datekey"
                                    nodes:
                                      - type: NAME
                                        text: "d_datekey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "c_region =.. 'AMERICA'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "c_region =.. 'AMERICA'"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "c_region"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "c_region"
                                    nodes:
                                      - type: NAME
                                        text: "c_region"
                              - type: LITERAL_STRING
                                text: "'AMERICA'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "s_nation =..ED STATES'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "s_nation =..ED STATES'"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_nation"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_nation"
                                    nodes:
                                      - type: NAME
                                        text: "s_nation"
                              - type: LITERAL_STRING
                                text: "'UNITED STATES'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "d_year = 1..ear = 1998"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: OR
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "d_year = 1..ear = 1998"
                            nodes:
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "d_year = 1997"
                                nodes:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "d_year = 1997"
                                    nodes:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "d_year"
                                        nodes:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "d_year"
                                            nodes:
                                              - type: NAME
                                                text: "d_year"
                                      - type: LITERAL_INTEGER
                                        text: "1997"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "d_year = 1998"
                                nodes:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "d_year = 1998"
                                    nodes:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "d_year"
                                        nodes:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "d_year"
                                            nodes:
                                              - type: NAME
                                                text: "d_year"
                                      - type: LITERAL_INTEGER
                                        text: "1998"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "p_category.. 'MFGR#14'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "p_category.. 'MFGR#14'"
                            nodes:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_category"
                                nodes:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_category"
                                    nodes:
                                      - type: NAME
                                        text: "p_category"
                              - type: LITERAL_STRING
                                text: "'MFGR#14'"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by d.., p_brand1"
                nodes:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "d_year"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "s_city"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_city"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_city"
                            nodes:
                              - type: NAME
                                text: "s_city"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "p_brand1"
                    nodes:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_brand1"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_brand1"
                            nodes:
                              - type: NAME
                                text: "p_brand1"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by d.., p_brand1"
                nodes:
                  - type: OBJECT_SQL_ORDER
                    text: "d_year"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "d_year"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "d_year"
                            nodes:
                              - type: NAME
                                text: "d_year"
                  - type: OBJECT_SQL_ORDER
                    text: "s_city"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_city"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_city"
                            nodes:
                              - type: NAME
                                text: "s_city"
                  - type: OBJECT_SQL_ORDER
                    text: "p_brand1"
                    nodes:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_brand1"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_brand1"
                            nodes:
                              - type: NAME
                                text: "p_brand1"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [74,75]
        - text: [123,124]
        - text: [152,153]
        - text: [179,180]
        - text: [206,207]
        - text: [235,236]
        - text: [260,261]
        - text: [291,292]
        - text: [328,329]
        - text: [355,356]
        - text: [389,390]
      comments: []
