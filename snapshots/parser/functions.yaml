parser-snapshots:

  - name: func_regexp_extract
    input: |-
      select regexp_extract(a, '[0-9a-zA-Z]+\.[0-9a-zA-Z]+\.([0-9a-zA-Z]+)', 1) from foo
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 19
          node:
            type: OBJECT_SQL_SELECT
            text: "select reg..) from foo"
            nodes:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "regexp_ext..-Z]+)', 1)"
                nodes:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "regexp_ext..-Z]+)', 1)"
                    nodes:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "regexp_ext..-Z]+)', 1)"
                        nodes:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "regexp_extract"
                            nodes:
                              - type: NAME
                                text: "regexp_extract"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "a, '[0-9a-..A-Z]+)', 1"
                            nodes:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "a"
                                nodes:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "a"
                                    nodes:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "a"
                                        nodes:
                                          - type: NAME
                                            text: "a"
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "'[0-9a-zA-..a-zA-Z]+)'"
                                nodes:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: LITERAL_STRING
                                    text: "'[0-9a-zA-..a-zA-Z]+)'"
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "1"
                                nodes:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: LITERAL_INTEGER
                                    text: "1"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from foo"
                nodes:
                  - type: OBJECT_SQL_TABLEREF
                    text: "foo"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "foo"
                        nodes:
                          - type: NAME
                            text: "foo"
      scanner-errors: []
      parser-errors: []
      line-breaks: []
      comments: []

  - name: func_restrict_time
    input: |-
      select * from foo where event_timestamp > current_timestamp - interval '30 days'
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 21
          node:
            type: OBJECT_SQL_SELECT
            text: "select * f.. '30 days'"
            nodes:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "*"
                nodes:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "*"
                    nodes:
                      - key: SQL_RESULT_TARGET_STAR
                        type: BOOL
                        value: 1
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from foo"
                nodes:
                  - type: OBJECT_SQL_TABLEREF
                    text: "foo"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "foo"
                        nodes:
                          - type: NAME
                            text: "foo"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "event_time.. '30 days'"
                nodes:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: GREATER_THAN
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "event_time.. '30 days'"
                    nodes:
                      - type: OBJECT_SQL_COLUMN_REF
                        text: "event_timestamp"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "event_timestamp"
                            nodes:
                              - type: NAME
                                text: "event_timestamp"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "current_ti.. '30 days'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: MINUS
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "current_ti.. '30 days'"
                            nodes:
                              - type: OBJECT_SQL_FUNCTION_EXPRESSION
                                text: "current_timestamp"
                                nodes:
                                  - key: SQL_FUNCTION_NAME
                                    type: ENUM_SQL_KNOWN_FUNCTION
                                    value: CURRENT_TIMESTAMP
                              - type: OBJECT_SQL_CONST_INTERVAL_CAST
                                text: "interval '30 days'"
                                nodes:
                                  - key: SQL_CONST_CAST_VALUE
                                    type: LITERAL_STRING
                                    text: "'30 days'"
      scanner-errors: []
      parser-errors: []
      line-breaks: []
      comments: []

  - name: func_restrict_time_minus_interval
    input: |-
      select * from foo where event_timestamp > current_timestamp - interval '30 days'
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 21
          node:
            type: OBJECT_SQL_SELECT
            text: "select * f.. '30 days'"
            nodes:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "*"
                nodes:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "*"
                    nodes:
                      - key: SQL_RESULT_TARGET_STAR
                        type: BOOL
                        value: 1
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from foo"
                nodes:
                  - type: OBJECT_SQL_TABLEREF
                    text: "foo"
                    nodes:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "foo"
                        nodes:
                          - type: NAME
                            text: "foo"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "event_time.. '30 days'"
                nodes:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: GREATER_THAN
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "event_time.. '30 days'"
                    nodes:
                      - type: OBJECT_SQL_COLUMN_REF
                        text: "event_timestamp"
                        nodes:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "event_timestamp"
                            nodes:
                              - type: NAME
                                text: "event_timestamp"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "current_ti.. '30 days'"
                        nodes:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: MINUS
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "current_ti.. '30 days'"
                            nodes:
                              - type: OBJECT_SQL_FUNCTION_EXPRESSION
                                text: "current_timestamp"
                                nodes:
                                  - key: SQL_FUNCTION_NAME
                                    type: ENUM_SQL_KNOWN_FUNCTION
                                    value: CURRENT_TIMESTAMP
                              - type: OBJECT_SQL_CONST_INTERVAL_CAST
                                text: "interval '30 days'"
                                nodes:
                                  - key: SQL_CONST_CAST_VALUE
                                    type: LITERAL_STRING
                                    text: "'30 days'"
      scanner-errors: []
      parser-errors: []
      line-breaks: []
      comments: []
