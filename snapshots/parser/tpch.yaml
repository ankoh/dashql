parser-snapshots:

  - name: tpch_1
    input: |-
      select
          l_returnflag,
          l_linestatus,
          sum(l_quantity) as sum_qty,
          sum(l_extendedprice) as sum_base_price,
          sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
          sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
          avg(l_quantity) as avg_qty,
          avg(l_extendedprice) as avg_price,
          avg(l_discount) as avg_disc,
          count(*) as count_order
      from
          lineitem
      where
          l_shipdate <= date '1998-12-01' - interval '90' day
      group by
          l_returnflag,
          l_linestatus
      order by
          l_returnflag,
          l_linestatus
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 157
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   ..linestatus"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "l_returnfl..ount_order"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "l_returnflag"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "l_returnflag"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "l_returnflag"
                            children:
                              - type: NAME
                                text: "l_returnflag"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "l_linestatus"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "l_linestatus"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "l_linestatus"
                            children:
                              - type: NAME
                                text: "l_linestatus"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(l_quan..as sum_qty"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(l_quantity)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            children:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "l_quantity"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "l_quantity"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "l_quantity"
                                    children:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "l_quantity"
                                        children:
                                          - type: NAME
                                            text: "l_quantity"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "sum_qty"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(l_exte..base_price"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(l_exte..ndedprice)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            children:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "l_extendedprice"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "l_extendedprice"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "l_extendedprice"
                                    children:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "l_extendedprice"
                                        children:
                                          - type: NAME
                                            text: "l_extendedprice"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "sum_base_price"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(l_exte..disc_price"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(l_exte..discount))"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            children:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "l_extended.._discount)"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "l_extended.._discount)"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "l_extended.._discount)"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: MULTIPLY
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "l_extended.._discount)"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_extendedprice"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_extendedprice"
                                                children:
                                                  - type: NAME
                                                    text: "l_extendedprice"
                                          - type: OBJECT_SQL_NARY_EXPRESSION
                                            text: "1 - l_discount"
                                            children:
                                              - key: SQL_EXPRESSION_OPERATOR
                                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                                value: MINUS
                                              - key: SQL_EXPRESSION_ARGS
                                                type: ARRAY
                                                text: "1 - l_discount"
                                                children:
                                                  - type: LITERAL_INTEGER
                                                    text: "1"
                                                  - type: OBJECT_SQL_COLUMN_REF
                                                    text: "l_discount"
                                                    children:
                                                      - key: SQL_COLUMN_REF_PATH
                                                        type: ARRAY
                                                        text: "l_discount"
                                                        children:
                                                          - type: NAME
                                                            text: "l_discount"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "sum_disc_price"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(l_exte..sum_charge"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(l_exte.. + l_tax))"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            children:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "l_extended..1 + l_tax)"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "l_extended..1 + l_tax)"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "l_extended..1 + l_tax)"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: MULTIPLY
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "l_extended..1 + l_tax)"
                                        children:
                                          - type: OBJECT_SQL_NARY_EXPRESSION
                                            text: "l_extended.._discount)"
                                            children:
                                              - key: SQL_EXPRESSION_OPERATOR
                                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                                value: MULTIPLY
                                              - key: SQL_EXPRESSION_ARGS
                                                type: ARRAY
                                                text: "l_extended.._discount)"
                                                children:
                                                  - type: OBJECT_SQL_COLUMN_REF
                                                    text: "l_extendedprice"
                                                    children:
                                                      - key: SQL_COLUMN_REF_PATH
                                                        type: ARRAY
                                                        text: "l_extendedprice"
                                                        children:
                                                          - type: NAME
                                                            text: "l_extendedprice"
                                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                                    text: "1 - l_discount"
                                                    children:
                                                      - key: SQL_EXPRESSION_OPERATOR
                                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                                        value: MINUS
                                                      - key: SQL_EXPRESSION_ARGS
                                                        type: ARRAY
                                                        text: "1 - l_discount"
                                                        children:
                                                          - type: LITERAL_INTEGER
                                                            text: "1"
                                                          - type: OBJECT_SQL_COLUMN_REF
                                                            text: "l_discount"
                                                            children:
                                                              - key: SQL_COLUMN_REF_PATH
                                                                type: ARRAY
                                                                text: "l_discount"
                                                                children:
                                                                  - type: NAME
                                                                    text: "l_discount"
                                          - type: OBJECT_SQL_NARY_EXPRESSION
                                            text: "1 + l_tax"
                                            children:
                                              - key: SQL_EXPRESSION_OPERATOR
                                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                                value: PLUS
                                              - key: SQL_EXPRESSION_ARGS
                                                type: ARRAY
                                                text: "1 + l_tax"
                                                children:
                                                  - type: LITERAL_INTEGER
                                                    text: "1"
                                                  - type: OBJECT_SQL_COLUMN_REF
                                                    text: "l_tax"
                                                    children:
                                                      - key: SQL_COLUMN_REF_PATH
                                                        type: ARRAY
                                                        text: "l_tax"
                                                        children:
                                                          - type: NAME
                                                            text: "l_tax"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "sum_charge"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "avg(l_quan..as avg_qty"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "avg(l_quantity)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "avg"
                            children:
                              - type: NAME
                                text: "avg"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "l_quantity"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "l_quantity"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "l_quantity"
                                    children:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "l_quantity"
                                        children:
                                          - type: NAME
                                            text: "l_quantity"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "avg_qty"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "avg(l_exte.. avg_price"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "avg(l_exte..ndedprice)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "avg"
                            children:
                              - type: NAME
                                text: "avg"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "l_extendedprice"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "l_extendedprice"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "l_extendedprice"
                                    children:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "l_extendedprice"
                                        children:
                                          - type: NAME
                                            text: "l_extendedprice"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "avg_price"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "avg(l_disc..s avg_disc"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "avg(l_discount)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "avg"
                            children:
                              - type: NAME
                                text: "avg"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "l_discount"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "l_discount"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "l_discount"
                                    children:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "l_discount"
                                        children:
                                          - type: NAME
                                            text: "l_discount"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "avg_disc"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "count(*) a..ount_order"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "count(*)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "count"
                            children:
                              - type: NAME
                                text: "count"
                          - key: SQL_FUNCTION_ARGUMENTS_STAR
                            type: BOOL
                            value: 1
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "count_order"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n    lineitem"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineitem"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineitem"
                        children:
                          - type: NAME
                            text: "lineitem"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "l_shipdate..l '90' day"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: LESS_EQUAL
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "l_shipdate..l '90' day"
                    children:
                      - type: OBJECT_SQL_COLUMN_REF
                        text: "l_shipdate"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "l_shipdate"
                            children:
                              - type: NAME
                                text: "l_shipdate"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "date '1998..l '90' day"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: MINUS
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "date '1998..l '90' day"
                            children:
                              - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                text: "date '1998-12-01"
                                children:
                                  - key: SQL_CONST_CAST_FUNC_NAME
                                    type: ARRAY
                                    text: "date"
                                    children:
                                      - type: NAME
                                        text: "date"
                                  - key: SQL_CONST_CAST_VALUE
                                    type: LITERAL_STRING
                                    text: "'1998-12-01"
                              - type: OBJECT_SQL_CONST_INTERVAL_CAST
                                text: "interval '90' day"
                                children:
                                  - key: SQL_CONST_CAST_VALUE
                                    type: LITERAL_STRING
                                    text: "'90'"
                                  - key: SQL_CONST_CAST_INTERVAL
                                    type: OBJECT_SQL_INTERVAL_TYPE
                                    text: "day"
                                    children:
                                      - key: SQL_INTERVAL_TYPE
                                        type: ENUM_SQL_INTERVAL_TYPE
                                        value: DAY
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by\n ..linestatus"
                children:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "l_returnflag"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "l_returnflag"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "l_returnflag"
                            children:
                              - type: NAME
                                text: "l_returnflag"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "l_linestatus"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "l_linestatus"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "l_linestatus"
                            children:
                              - type: NAME
                                text: "l_linestatus"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by\n ..linestatus"
                children:
                  - type: OBJECT_SQL_ORDER
                    text: "l_returnflag"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "l_returnflag"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "l_returnflag"
                            children:
                              - type: NAME
                                text: "l_returnflag"
                  - type: OBJECT_SQL_ORDER
                    text: "l_linestatus"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "l_linestatus"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "l_linestatus"
                            children:
                              - type: NAME
                                text: "l_linestatus"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [24,25]
        - text: [42,43]
        - text: [74,75]
        - text: [118,119]
        - text: [181,182]
        - text: [254,255]
        - text: [286,287]
        - text: [325,326]
        - text: [358,359]
        - text: [386,387]
        - text: [391,392]
        - text: [404,405]
        - text: [410,411]
        - text: [466,467]
        - text: [475,476]
        - text: [493,494]
        - text: [510,511]
        - text: [519,520]
        - text: [537,538]
      comments: []

  - name: tpch_2
    input: |-
      select
              s_acctbal,
              s_name,
              n_name,
              p_partkey,
              p_mfgr,
              s_address,
              s_phone,
              s_comment
      from
              part,
              supplier,
              partsupp,
              nation,
              region
      where
              p_partkey = ps_partkey
              and s_suppkey = ps_suppkey
              and p_size = 15
              and p_type like '%BRASS'
              and s_nationkey = n_nationkey
              and n_regionkey = r_regionkey
              and r_name = 'EUROPE'
              and ps_supplycost = (
                      select
                              min(ps_supplycost)
                      from
                              partsupp,
                              supplier,
                              nation,
                              region
                      where
                              p_partkey = ps_partkey
                              and s_suppkey = ps_suppkey
                              and s_nationkey = n_nationkey
                              and n_regionkey = r_regionkey
                              and r_name = 'EUROPE'
              )
      order by
              s_acctbal desc,
              n_name,
              s_name,
              p_partkey
      limit
      	100
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 206
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   ..limit\n	100"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "s_acctbal,.. s_comment"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "s_acctbal"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_acctbal"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_acctbal"
                            children:
                              - type: NAME
                                text: "s_acctbal"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "s_name"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_name"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_name"
                            children:
                              - type: NAME
                                text: "s_name"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "n_name"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "n_name"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "n_name"
                            children:
                              - type: NAME
                                text: "n_name"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "p_partkey"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_partkey"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_partkey"
                            children:
                              - type: NAME
                                text: "p_partkey"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "p_mfgr"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_mfgr"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_mfgr"
                            children:
                              - type: NAME
                                text: "p_mfgr"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "s_address"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_address"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_address"
                            children:
                              - type: NAME
                                text: "s_address"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "s_phone"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_phone"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_phone"
                            children:
                              - type: NAME
                                text: "s_phone"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "s_comment"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_comment"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_comment"
                            children:
                              - type: NAME
                                text: "s_comment"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n     ..    region"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "part"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "part"
                        children:
                          - type: NAME
                            text: "part"
                  - type: OBJECT_SQL_TABLEREF
                    text: "supplier"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "supplier"
                        children:
                          - type: NAME
                            text: "supplier"
                  - type: OBJECT_SQL_TABLEREF
                    text: "partsupp"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "partsupp"
                        children:
                          - type: NAME
                            text: "partsupp"
                  - type: OBJECT_SQL_TABLEREF
                    text: "nation"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "nation"
                        children:
                          - type: NAME
                            text: "nation"
                  - type: OBJECT_SQL_TABLEREF
                    text: "region"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "region"
                        children:
                          - type: NAME
                            text: "region"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "p_partkey ..\n        )"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "p_partkey ..\n        )"
                    children:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "p_partkey ..ps_partkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "p_partkey ..ps_partkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_partkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_partkey"
                                    children:
                                      - type: NAME
                                        text: "p_partkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "ps_partkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "ps_partkey"
                                    children:
                                      - type: NAME
                                        text: "ps_partkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "s_suppkey ..ps_suppkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "s_suppkey ..ps_suppkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_suppkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_suppkey"
                                    children:
                                      - type: NAME
                                        text: "s_suppkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "ps_suppkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "ps_suppkey"
                                    children:
                                      - type: NAME
                                        text: "ps_suppkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "p_size = 15"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "p_size = 15"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_size"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_size"
                                    children:
                                      - type: NAME
                                        text: "p_size"
                              - type: LITERAL_INTEGER
                                text: "15"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "p_type lik..e '%BRASS'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: LIKE
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "p_type lik..e '%BRASS'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_type"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_type"
                                    children:
                                      - type: NAME
                                        text: "p_type"
                              - type: LITERAL_STRING
                                text: "'%BRASS'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "s_nationke.._nationkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "s_nationke.._nationkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_nationkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_nationkey"
                                    children:
                                      - type: NAME
                                        text: "s_nationkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "n_nationkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "n_nationkey"
                                    children:
                                      - type: NAME
                                        text: "n_nationkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "n_regionke.._regionkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "n_regionke.._regionkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "n_regionkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "n_regionkey"
                                    children:
                                      - type: NAME
                                        text: "n_regionkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "r_regionkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "r_regionkey"
                                    children:
                                      - type: NAME
                                        text: "r_regionkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "r_name = 'EUROPE'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "r_name = 'EUROPE'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "r_name"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "r_name"
                                    children:
                                      - type: NAME
                                        text: "r_name"
                              - type: LITERAL_STRING
                                text: "'EUROPE'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "ps_supplyc..\n        )"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "ps_supplyc..\n        )"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "ps_supplycost"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "ps_supplycost"
                                    children:
                                      - type: NAME
                                        text: "ps_supplycost"
                              - type: OBJECT_SQL_SELECT_EXPRESSION
                                text: "(\n        ..\n        )"
                                children:
                                  - key: SQL_SELECT_EXPRESSION_STATEMENT
                                    type: OBJECT_SQL_SELECT
                                    text: "(\n        ..\n        )"
                                    children:
                                      - key: SQL_SELECT_TARGETS
                                        type: ARRAY
                                        text: "min(ps_supplycost)"
                                        children:
                                          - type: OBJECT_SQL_RESULT_TARGET
                                            text: "min(ps_supplycost)"
                                            children:
                                              - key: SQL_RESULT_TARGET_VALUE
                                                type: OBJECT_SQL_FUNCTION_EXPRESSION
                                                text: "min(ps_supplycost)"
                                                children:
                                                  - key: SQL_FUNCTION_NAME
                                                    type: ARRAY
                                                    text: "min"
                                                    children:
                                                      - type: NAME
                                                        text: "min"
                                                  - key: SQL_FUNCTION_ARGUMENTS
                                                    type: ARRAY
                                                    text: "ps_supplycost"
                                                    children:
                                                      - type: OBJECT_SQL_FUNCTION_ARG
                                                        text: "ps_supplycost"
                                                        children:
                                                          - key: SQL_FUNCTION_ARG_VALUE
                                                            type: OBJECT_SQL_COLUMN_REF
                                                            text: "ps_supplycost"
                                                            children:
                                                              - key: SQL_COLUMN_REF_PATH
                                                                type: ARRAY
                                                                text: "ps_supplycost"
                                                                children:
                                                                  - type: NAME
                                                                    text: "ps_supplycost"
                                      - key: SQL_SELECT_FROM
                                        type: ARRAY
                                        text: "from\n     ..    region"
                                        children:
                                          - type: OBJECT_SQL_TABLEREF
                                            text: "partsupp"
                                            children:
                                              - key: SQL_TABLEREF_NAME
                                                type: ARRAY
                                                text: "partsupp"
                                                children:
                                                  - type: NAME
                                                    text: "partsupp"
                                          - type: OBJECT_SQL_TABLEREF
                                            text: "supplier"
                                            children:
                                              - key: SQL_TABLEREF_NAME
                                                type: ARRAY
                                                text: "supplier"
                                                children:
                                                  - type: NAME
                                                    text: "supplier"
                                          - type: OBJECT_SQL_TABLEREF
                                            text: "nation"
                                            children:
                                              - key: SQL_TABLEREF_NAME
                                                type: ARRAY
                                                text: "nation"
                                                children:
                                                  - type: NAME
                                                    text: "nation"
                                          - type: OBJECT_SQL_TABLEREF
                                            text: "region"
                                            children:
                                              - key: SQL_TABLEREF_NAME
                                                type: ARRAY
                                                text: "region"
                                                children:
                                                  - type: NAME
                                                    text: "region"
                                      - key: SQL_SELECT_WHERE
                                        type: OBJECT_SQL_NARY_EXPRESSION
                                        text: "p_partkey ..= 'EUROPE'"
                                        children:
                                          - key: SQL_EXPRESSION_OPERATOR
                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                            value: AND
                                          - key: SQL_EXPRESSION_ARGS
                                            type: ARRAY
                                            text: "p_partkey ..= 'EUROPE'"
                                            children:
                                              - type: OBJECT_SQL_NARY_EXPRESSION
                                                text: "p_partkey ..ps_partkey"
                                                children:
                                                  - key: SQL_EXPRESSION_OPERATOR
                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                    value: EQUAL
                                                  - key: SQL_EXPRESSION_ARGS
                                                    type: ARRAY
                                                    text: "p_partkey ..ps_partkey"
                                                    children:
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "p_partkey"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "p_partkey"
                                                            children:
                                                              - type: NAME
                                                                text: "p_partkey"
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "ps_partkey"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "ps_partkey"
                                                            children:
                                                              - type: NAME
                                                                text: "ps_partkey"
                                              - type: OBJECT_SQL_NARY_EXPRESSION
                                                text: "s_suppkey ..ps_suppkey"
                                                children:
                                                  - key: SQL_EXPRESSION_OPERATOR
                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                    value: EQUAL
                                                  - key: SQL_EXPRESSION_ARGS
                                                    type: ARRAY
                                                    text: "s_suppkey ..ps_suppkey"
                                                    children:
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "s_suppkey"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "s_suppkey"
                                                            children:
                                                              - type: NAME
                                                                text: "s_suppkey"
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "ps_suppkey"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "ps_suppkey"
                                                            children:
                                                              - type: NAME
                                                                text: "ps_suppkey"
                                              - type: OBJECT_SQL_NARY_EXPRESSION
                                                text: "s_nationke.._nationkey"
                                                children:
                                                  - key: SQL_EXPRESSION_OPERATOR
                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                    value: EQUAL
                                                  - key: SQL_EXPRESSION_ARGS
                                                    type: ARRAY
                                                    text: "s_nationke.._nationkey"
                                                    children:
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "s_nationkey"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "s_nationkey"
                                                            children:
                                                              - type: NAME
                                                                text: "s_nationkey"
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "n_nationkey"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "n_nationkey"
                                                            children:
                                                              - type: NAME
                                                                text: "n_nationkey"
                                              - type: OBJECT_SQL_NARY_EXPRESSION
                                                text: "n_regionke.._regionkey"
                                                children:
                                                  - key: SQL_EXPRESSION_OPERATOR
                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                    value: EQUAL
                                                  - key: SQL_EXPRESSION_ARGS
                                                    type: ARRAY
                                                    text: "n_regionke.._regionkey"
                                                    children:
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "n_regionkey"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "n_regionkey"
                                                            children:
                                                              - type: NAME
                                                                text: "n_regionkey"
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "r_regionkey"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "r_regionkey"
                                                            children:
                                                              - type: NAME
                                                                text: "r_regionkey"
                                              - type: OBJECT_SQL_NARY_EXPRESSION
                                                text: "r_name = 'EUROPE'"
                                                children:
                                                  - key: SQL_EXPRESSION_OPERATOR
                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                    value: EQUAL
                                                  - key: SQL_EXPRESSION_ARGS
                                                    type: ARRAY
                                                    text: "r_name = 'EUROPE'"
                                                    children:
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "r_name"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "r_name"
                                                            children:
                                                              - type: NAME
                                                                text: "r_name"
                                                      - type: LITERAL_STRING
                                                        text: "'EUROPE'"
              - key: SQL_SELECT_LIMIT
                type: LITERAL_INTEGER
                text: "100"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by\n .. p_partkey"
                children:
                  - type: OBJECT_SQL_ORDER
                    text: "s_acctbal desc"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_acctbal"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_acctbal"
                            children:
                              - type: NAME
                                text: "s_acctbal"
                      - key: SQL_ORDER_DIRECTION
                        type: ENUM_SQL_ORDER_DIRECTION
                        value: DESCENDING
                  - type: OBJECT_SQL_ORDER
                    text: "n_name"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "n_name"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "n_name"
                            children:
                              - type: NAME
                                text: "n_name"
                  - type: OBJECT_SQL_ORDER
                    text: "s_name"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_name"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_name"
                            children:
                              - type: NAME
                                text: "s_name"
                  - type: OBJECT_SQL_ORDER
                    text: "p_partkey"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_partkey"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_partkey"
                            children:
                              - type: NAME
                                text: "p_partkey"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [25,26]
        - text: [41,42]
        - text: [57,58]
        - text: [76,77]
        - text: [92,93]
        - text: [111,112]
        - text: [128,129]
        - text: [146,147]
        - text: [151,152]
        - text: [165,166]
        - text: [183,184]
        - text: [201,202]
        - text: [217,218]
        - text: [232,233]
        - text: [238,239]
        - text: [269,270]
        - text: [304,305]
        - text: [328,329]
        - text: [361,362]
        - text: [399,400]
        - text: [437,438]
        - text: [467,468]
        - text: [497,498]
        - text: [520,521]
        - text: [563,564]
        - text: [584,585]
        - text: [618,619]
        - text: [652,653]
        - text: [684,685]
        - text: [715,716]
        - text: [737,738]
        - text: [784,785]
        - text: [835,836]
        - text: [889,890]
        - text: [943,944]
        - text: [989,990]
        - text: [999,1000]
        - text: [1008,1009]
        - text: [1032,1033]
        - text: [1048,1049]
        - text: [1064,1065]
        - text: [1082,1083]
        - text: [1088,1089]
      comments: []

  - name: tpch_3
    input: |-
      select
              l_orderkey,
              sum(l_extendedprice * (1 - l_discount)) as revenue,
              o_orderdate,
              o_shippriority
      from
              customer,
              orders,
              lineitem
      where
              c_mktsegment = 'BUILDING'
              and c_custkey = o_custkey
              and l_orderkey = o_orderkey
              and o_orderdate < date '1995-03-15'
              and l_shipdate > date '1995-03-15'
      group by
              l_orderkey,
              o_orderdate,
              o_shippriority
      order by
              revenue desc,
              o_orderdate
      limit
      	10
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 119
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   ..\nlimit\n	10"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "l_orderkey..ippriority"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "l_orderkey"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "l_orderkey"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "l_orderkey"
                            children:
                              - type: NAME
                                text: "l_orderkey"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(l_exte..as revenue"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(l_exte..discount))"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            children:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "l_extended.._discount)"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "l_extended.._discount)"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "l_extended.._discount)"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: MULTIPLY
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "l_extended.._discount)"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_extendedprice"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_extendedprice"
                                                children:
                                                  - type: NAME
                                                    text: "l_extendedprice"
                                          - type: OBJECT_SQL_NARY_EXPRESSION
                                            text: "1 - l_discount"
                                            children:
                                              - key: SQL_EXPRESSION_OPERATOR
                                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                                value: MINUS
                                              - key: SQL_EXPRESSION_ARGS
                                                type: ARRAY
                                                text: "1 - l_discount"
                                                children:
                                                  - type: LITERAL_INTEGER
                                                    text: "1"
                                                  - type: OBJECT_SQL_COLUMN_REF
                                                    text: "l_discount"
                                                    children:
                                                      - key: SQL_COLUMN_REF_PATH
                                                        type: ARRAY
                                                        text: "l_discount"
                                                        children:
                                                          - type: NAME
                                                            text: "l_discount"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "revenue"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "o_orderdate"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_orderdate"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_orderdate"
                            children:
                              - type: NAME
                                text: "o_orderdate"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "o_shippriority"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_shippriority"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_shippriority"
                            children:
                              - type: NAME
                                text: "o_shippriority"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n     ..  lineitem"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "customer"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "customer"
                        children:
                          - type: NAME
                            text: "customer"
                  - type: OBJECT_SQL_TABLEREF
                    text: "orders"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "orders"
                        children:
                          - type: NAME
                            text: "orders"
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineitem"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineitem"
                        children:
                          - type: NAME
                            text: "lineitem"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "c_mktsegme..995-03-15'"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "c_mktsegme..995-03-15'"
                    children:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "c_mktsegme..'BUILDING'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "c_mktsegme..'BUILDING'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "c_mktsegment"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "c_mktsegment"
                                    children:
                                      - type: NAME
                                        text: "c_mktsegment"
                              - type: LITERAL_STRING
                                text: "'BUILDING'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "c_custkey .. o_custkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "c_custkey .. o_custkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "c_custkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "c_custkey"
                                    children:
                                      - type: NAME
                                        text: "c_custkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "o_custkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "o_custkey"
                                    children:
                                      - type: NAME
                                        text: "o_custkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l_orderkey..o_orderkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l_orderkey..o_orderkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_orderkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_orderkey"
                                    children:
                                      - type: NAME
                                        text: "l_orderkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "o_orderkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "o_orderkey"
                                    children:
                                      - type: NAME
                                        text: "o_orderkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "o_orderdat..995-03-15'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: LESS_THAN
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "o_orderdat..995-03-15'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "o_orderdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "o_orderdate"
                                    children:
                                      - type: NAME
                                        text: "o_orderdate"
                              - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                text: "date '1995-03-15'"
                                children:
                                  - key: SQL_CONST_CAST_FUNC_NAME
                                    type: ARRAY
                                    text: "date"
                                    children:
                                      - type: NAME
                                        text: "date"
                                  - key: SQL_CONST_CAST_VALUE
                                    type: LITERAL_STRING
                                    text: "'1995-03-15'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l_shipdate..995-03-15'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: GREATER_THAN
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l_shipdate..995-03-15'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_shipdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_shipdate"
                                    children:
                                      - type: NAME
                                        text: "l_shipdate"
                              - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                text: "date '1995-03-15'"
                                children:
                                  - key: SQL_CONST_CAST_FUNC_NAME
                                    type: ARRAY
                                    text: "date"
                                    children:
                                      - type: NAME
                                        text: "date"
                                  - key: SQL_CONST_CAST_VALUE
                                    type: LITERAL_STRING
                                    text: "'1995-03-15'"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by\n ..ippriority"
                children:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "l_orderkey"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "l_orderkey"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "l_orderkey"
                            children:
                              - type: NAME
                                text: "l_orderkey"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "o_orderdate"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_orderdate"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_orderdate"
                            children:
                              - type: NAME
                                text: "o_orderdate"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "o_shippriority"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_shippriority"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_shippriority"
                            children:
                              - type: NAME
                                text: "o_shippriority"
              - key: SQL_SELECT_LIMIT
                type: LITERAL_INTEGER
                text: "10"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by\n .._orderdate"
                children:
                  - type: OBJECT_SQL_ORDER
                    text: "revenue desc"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "revenue"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "revenue"
                            children:
                              - type: NAME
                                text: "revenue"
                      - key: SQL_ORDER_DIRECTION
                        type: ENUM_SQL_ORDER_DIRECTION
                        value: DESCENDING
                  - type: OBJECT_SQL_ORDER
                    text: "o_orderdate"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_orderdate"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_orderdate"
                            children:
                              - type: NAME
                                text: "o_orderdate"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [26,27]
        - text: [86,87]
        - text: [107,108]
        - text: [130,131]
        - text: [135,136]
        - text: [153,154]
        - text: [169,170]
        - text: [186,187]
        - text: [192,193]
        - text: [226,227]
        - text: [260,261]
        - text: [296,297]
        - text: [340,341]
        - text: [383,384]
        - text: [392,393]
        - text: [412,413]
        - text: [433,434]
        - text: [456,457]
        - text: [465,466]
        - text: [487,488]
        - text: [507,508]
        - text: [513,514]
      comments: []

  - name: tpch_4
    input: |-
      select
              o_orderpriority,
              count(*) as order_count
      from
              orders
      where
              o_orderdate >= date '1993-07-01'
              and o_orderdate < date '1993-10-01'
              and exists (
                      select
                              *
                      from
                              lineitem
                      where
                              l_orderkey = o_orderkey
                              and l_commitdate < l_receiptdate
              )
      group by
              o_orderpriority
      order by
              o_orderpriority
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 80
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   ..erpriority"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "o_orderpri..rder_count"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "o_orderpriority"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_orderpriority"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_orderpriority"
                            children:
                              - type: NAME
                                text: "o_orderpriority"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "count(*) a..rder_count"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "count(*)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "count"
                            children:
                              - type: NAME
                                text: "count"
                          - key: SQL_FUNCTION_ARGUMENTS_STAR
                            type: BOOL
                            value: 1
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "order_count"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n        orders"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "orders"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "orders"
                        children:
                          - type: NAME
                            text: "orders"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "o_orderdat..\n        )"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "o_orderdat..\n        )"
                    children:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "o_orderdat..993-07-01'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: GREATER_EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "o_orderdat..993-07-01'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "o_orderdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "o_orderdate"
                                    children:
                                      - type: NAME
                                        text: "o_orderdate"
                              - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                text: "date '1993-07-01'"
                                children:
                                  - key: SQL_CONST_CAST_FUNC_NAME
                                    type: ARRAY
                                    text: "date"
                                    children:
                                      - type: NAME
                                        text: "date"
                                  - key: SQL_CONST_CAST_VALUE
                                    type: LITERAL_STRING
                                    text: "'1993-07-01'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "o_orderdat..993-10-01'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: LESS_THAN
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "o_orderdat..993-10-01'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "o_orderdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "o_orderdate"
                                    children:
                                      - type: NAME
                                        text: "o_orderdate"
                              - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                text: "date '1993-10-01'"
                                children:
                                  - key: SQL_CONST_CAST_FUNC_NAME
                                    type: ARRAY
                                    text: "date"
                                    children:
                                      - type: NAME
                                        text: "date"
                                  - key: SQL_CONST_CAST_VALUE
                                    type: LITERAL_STRING
                                    text: "'1993-10-01'"
                      - type: OBJECT_SQL_EXISTS_EXPRESSION
                        text: "exists (\n ..\n        )"
                        children:
                          - key: SQL_EXISTS_EXPRESSION_STATEMENT
                            type: OBJECT_SQL_SELECT
                            text: "(\n        ..\n        )"
                            children:
                              - key: SQL_SELECT_TARGETS
                                type: ARRAY
                                text: "*"
                                children:
                                  - type: OBJECT_SQL_RESULT_TARGET
                                    text: "*"
                                    children:
                                      - key: SQL_RESULT_TARGET_STAR
                                        type: BOOL
                                        value: 1
                              - key: SQL_SELECT_FROM
                                type: ARRAY
                                text: "from\n     ..  lineitem"
                                children:
                                  - type: OBJECT_SQL_TABLEREF
                                    text: "lineitem"
                                    children:
                                      - key: SQL_TABLEREF_NAME
                                        type: ARRAY
                                        text: "lineitem"
                                        children:
                                          - type: NAME
                                            text: "lineitem"
                              - key: SQL_SELECT_WHERE
                                type: OBJECT_SQL_NARY_EXPRESSION
                                text: "l_orderkey..eceiptdate"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: AND
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "l_orderkey..eceiptdate"
                                    children:
                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                        text: "l_orderkey..o_orderkey"
                                        children:
                                          - key: SQL_EXPRESSION_OPERATOR
                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                            value: EQUAL
                                          - key: SQL_EXPRESSION_ARGS
                                            type: ARRAY
                                            text: "l_orderkey..o_orderkey"
                                            children:
                                              - type: OBJECT_SQL_COLUMN_REF
                                                text: "l_orderkey"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "l_orderkey"
                                                    children:
                                                      - type: NAME
                                                        text: "l_orderkey"
                                              - type: OBJECT_SQL_COLUMN_REF
                                                text: "o_orderkey"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "o_orderkey"
                                                    children:
                                                      - type: NAME
                                                        text: "o_orderkey"
                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                        text: "l_commitda..eceiptdate"
                                        children:
                                          - key: SQL_EXPRESSION_OPERATOR
                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                            value: LESS_THAN
                                          - key: SQL_EXPRESSION_ARGS
                                            type: ARRAY
                                            text: "l_commitda..eceiptdate"
                                            children:
                                              - type: OBJECT_SQL_COLUMN_REF
                                                text: "l_commitdate"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "l_commitdate"
                                                    children:
                                                      - type: NAME
                                                        text: "l_commitdate"
                                              - type: OBJECT_SQL_COLUMN_REF
                                                text: "l_receiptdate"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "l_receiptdate"
                                                    children:
                                                      - type: NAME
                                                        text: "l_receiptdate"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by\n ..erpriority"
                children:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "o_orderpriority"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_orderpriority"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_orderpriority"
                            children:
                              - type: NAME
                                text: "o_orderpriority"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by\n ..erpriority"
                children:
                  - type: OBJECT_SQL_ORDER
                    text: "o_orderpriority"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_orderpriority"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_orderpriority"
                            children:
                              - type: NAME
                                text: "o_orderpriority"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [31,32]
        - text: [63,64]
        - text: [68,69]
        - text: [83,84]
        - text: [89,90]
        - text: [130,131]
        - text: [174,175]
        - text: [195,196]
        - text: [218,219]
        - text: [244,245]
        - text: [265,266]
        - text: [298,299]
        - text: [320,321]
        - text: [368,369]
        - text: [425,426]
        - text: [435,436]
        - text: [444,445]
        - text: [468,469]
        - text: [477,478]
      comments: []

  - name: tpch_5
    input: |-
      select
              n_name,
              sum(l_extendedprice * (1 - l_discount)) as revenue
      from
              customer,
              orders,
              lineitem,
              supplier,
              nation,
              region
      where
              c_custkey = o_custkey
              and l_orderkey = o_orderkey
              and l_suppkey = s_suppkey
              and c_nationkey = s_nationkey
              and s_nationkey = n_nationkey
              and n_regionkey = r_regionkey
              and r_name = 'ASIA'
              and o_orderdate >= date '1994-01-01'
              and o_orderdate < date '1995-01-01'
      group by
              n_name
      order by
              revenue desc
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 141
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   ..venue desc"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "n_name,\n  ..as revenue"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "n_name"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "n_name"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "n_name"
                            children:
                              - type: NAME
                                text: "n_name"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(l_exte..as revenue"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(l_exte..discount))"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            children:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "l_extended.._discount)"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "l_extended.._discount)"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "l_extended.._discount)"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: MULTIPLY
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "l_extended.._discount)"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_extendedprice"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_extendedprice"
                                                children:
                                                  - type: NAME
                                                    text: "l_extendedprice"
                                          - type: OBJECT_SQL_NARY_EXPRESSION
                                            text: "1 - l_discount"
                                            children:
                                              - key: SQL_EXPRESSION_OPERATOR
                                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                                value: MINUS
                                              - key: SQL_EXPRESSION_ARGS
                                                type: ARRAY
                                                text: "1 - l_discount"
                                                children:
                                                  - type: LITERAL_INTEGER
                                                    text: "1"
                                                  - type: OBJECT_SQL_COLUMN_REF
                                                    text: "l_discount"
                                                    children:
                                                      - key: SQL_COLUMN_REF_PATH
                                                        type: ARRAY
                                                        text: "l_discount"
                                                        children:
                                                          - type: NAME
                                                            text: "l_discount"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "revenue"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n     ..    region"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "customer"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "customer"
                        children:
                          - type: NAME
                            text: "customer"
                  - type: OBJECT_SQL_TABLEREF
                    text: "orders"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "orders"
                        children:
                          - type: NAME
                            text: "orders"
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineitem"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineitem"
                        children:
                          - type: NAME
                            text: "lineitem"
                  - type: OBJECT_SQL_TABLEREF
                    text: "supplier"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "supplier"
                        children:
                          - type: NAME
                            text: "supplier"
                  - type: OBJECT_SQL_TABLEREF
                    text: "nation"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "nation"
                        children:
                          - type: NAME
                            text: "nation"
                  - type: OBJECT_SQL_TABLEREF
                    text: "region"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "region"
                        children:
                          - type: NAME
                            text: "region"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "c_custkey ..995-01-01'"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "c_custkey ..995-01-01'"
                    children:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "c_custkey .. o_custkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "c_custkey .. o_custkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "c_custkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "c_custkey"
                                    children:
                                      - type: NAME
                                        text: "c_custkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "o_custkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "o_custkey"
                                    children:
                                      - type: NAME
                                        text: "o_custkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l_orderkey..o_orderkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l_orderkey..o_orderkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_orderkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_orderkey"
                                    children:
                                      - type: NAME
                                        text: "l_orderkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "o_orderkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "o_orderkey"
                                    children:
                                      - type: NAME
                                        text: "o_orderkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l_suppkey .. s_suppkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l_suppkey .. s_suppkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_suppkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_suppkey"
                                    children:
                                      - type: NAME
                                        text: "l_suppkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_suppkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_suppkey"
                                    children:
                                      - type: NAME
                                        text: "s_suppkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "c_nationke.._nationkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "c_nationke.._nationkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "c_nationkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "c_nationkey"
                                    children:
                                      - type: NAME
                                        text: "c_nationkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_nationkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_nationkey"
                                    children:
                                      - type: NAME
                                        text: "s_nationkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "s_nationke.._nationkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "s_nationke.._nationkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_nationkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_nationkey"
                                    children:
                                      - type: NAME
                                        text: "s_nationkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "n_nationkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "n_nationkey"
                                    children:
                                      - type: NAME
                                        text: "n_nationkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "n_regionke.._regionkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "n_regionke.._regionkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "n_regionkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "n_regionkey"
                                    children:
                                      - type: NAME
                                        text: "n_regionkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "r_regionkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "r_regionkey"
                                    children:
                                      - type: NAME
                                        text: "r_regionkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "r_name = 'ASIA'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "r_name = 'ASIA'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "r_name"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "r_name"
                                    children:
                                      - type: NAME
                                        text: "r_name"
                              - type: LITERAL_STRING
                                text: "'ASIA'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "o_orderdat..994-01-01'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: GREATER_EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "o_orderdat..994-01-01'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "o_orderdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "o_orderdate"
                                    children:
                                      - type: NAME
                                        text: "o_orderdate"
                              - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                text: "date '1994-01-01'"
                                children:
                                  - key: SQL_CONST_CAST_FUNC_NAME
                                    type: ARRAY
                                    text: "date"
                                    children:
                                      - type: NAME
                                        text: "date"
                                  - key: SQL_CONST_CAST_VALUE
                                    type: LITERAL_STRING
                                    text: "'1994-01-01'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "o_orderdat..995-01-01'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: LESS_THAN
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "o_orderdat..995-01-01'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "o_orderdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "o_orderdate"
                                    children:
                                      - type: NAME
                                        text: "o_orderdate"
                              - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                text: "date '1995-01-01'"
                                children:
                                  - key: SQL_CONST_CAST_FUNC_NAME
                                    type: ARRAY
                                    text: "date"
                                    children:
                                      - type: NAME
                                        text: "date"
                                  - key: SQL_CONST_CAST_VALUE
                                    type: LITERAL_STRING
                                    text: "'1995-01-01'"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by\n ..    n_name"
                children:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "n_name"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "n_name"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "n_name"
                            children:
                              - type: NAME
                                text: "n_name"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by\n ..venue desc"
                children:
                  - type: OBJECT_SQL_ORDER
                    text: "revenue desc"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "revenue"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "revenue"
                            children:
                              - type: NAME
                                text: "revenue"
                      - key: SQL_ORDER_DIRECTION
                        type: ENUM_SQL_ORDER_DIRECTION
                        value: DESCENDING
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [22,23]
        - text: [81,82]
        - text: [86,87]
        - text: [104,105]
        - text: [120,121]
        - text: [138,139]
        - text: [156,157]
        - text: [172,173]
        - text: [187,188]
        - text: [193,194]
        - text: [223,224]
        - text: [259,260]
        - text: [293,294]
        - text: [331,332]
        - text: [369,370]
        - text: [407,408]
        - text: [435,436]
        - text: [480,481]
        - text: [524,525]
        - text: [533,534]
        - text: [548,549]
        - text: [557,558]
      comments: []

  - name: tpch_6
    input: |-
      select
              sum(l_extendedprice * l_discount) as revenue
      from
              lineitem
      where
              l_shipdate >= date '1994-01-01'
              and l_shipdate < date '1995-01-01'
              and l_discount between 0.06 - 0.01 and 0.06 + 0.01
              and l_quantity < 24
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 68
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   ..ntity < 24"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "sum(l_exte..as revenue"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(l_exte..as revenue"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(l_exte.._discount)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            children:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "l_extended..l_discount"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "l_extended..l_discount"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "l_extended..l_discount"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: MULTIPLY
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "l_extended..l_discount"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_extendedprice"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_extendedprice"
                                                children:
                                                  - type: NAME
                                                    text: "l_extendedprice"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_discount"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_discount"
                                                children:
                                                  - type: NAME
                                                    text: "l_discount"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "revenue"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n     ..  lineitem"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineitem"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineitem"
                        children:
                          - type: NAME
                            text: "lineitem"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "l_shipdate..ntity < 24"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "l_shipdate..ntity < 24"
                    children:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l_shipdate..994-01-01'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: GREATER_EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l_shipdate..994-01-01'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_shipdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_shipdate"
                                    children:
                                      - type: NAME
                                        text: "l_shipdate"
                              - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                text: "date '1994-01-01'"
                                children:
                                  - key: SQL_CONST_CAST_FUNC_NAME
                                    type: ARRAY
                                    text: "date"
                                    children:
                                      - type: NAME
                                        text: "date"
                                  - key: SQL_CONST_CAST_VALUE
                                    type: LITERAL_STRING
                                    text: "'1994-01-01'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l_shipdate..995-01-01'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: LESS_THAN
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l_shipdate..995-01-01'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_shipdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_shipdate"
                                    children:
                                      - type: NAME
                                        text: "l_shipdate"
                              - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                text: "date '1995-01-01'"
                                children:
                                  - key: SQL_CONST_CAST_FUNC_NAME
                                    type: ARRAY
                                    text: "date"
                                    children:
                                      - type: NAME
                                        text: "date"
                                  - key: SQL_CONST_CAST_VALUE
                                    type: LITERAL_STRING
                                    text: "'1995-01-01'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l_discount...06 + 0.01"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: BETWEEN_SYMMETRIC
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l_discount...06 + 0.01"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_discount"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_discount"
                                    children:
                                      - type: NAME
                                        text: "l_discount"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "0.06 - 0.01"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: MINUS
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "0.06 - 0.01"
                                    children:
                                      - type: LITERAL_FLOAT
                                        text: "0.06"
                                      - type: LITERAL_FLOAT
                                        text: "0.01"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "0.06 + 0.01"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: PLUS
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "0.06 + 0.01"
                                    children:
                                      - type: LITERAL_FLOAT
                                        text: "0.06"
                                      - type: LITERAL_FLOAT
                                        text: "0.01"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l_quantity < 24"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: LESS_THAN
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l_quantity < 24"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_quantity"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_quantity"
                                    children:
                                      - type: NAME
                                        text: "l_quantity"
                              - type: LITERAL_INTEGER
                                text: "24"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [59,60]
        - text: [64,65]
        - text: [81,82]
        - text: [87,88]
        - text: [127,128]
        - text: [170,171]
        - text: [229,230]
      comments: []

  - name: tpch_7
    input: |-
      select
              supp_nation,
              cust_nation,
              l_year,
              sum(volume) as revenue
      from
              (
                      select
                              n1.n_name as supp_nation,
                              n2.n_name as cust_nation,
                              extract(year from l_shipdate) as l_year,
                              l_extendedprice * (1 - l_discount) as volume
                      from
                              supplier,
                              lineitem,
                              orders,
                              customer,
                              nation n1,
                              nation n2
                      where
                              s_suppkey = l_suppkey
                              and o_orderkey = l_orderkey
                              and c_custkey = o_custkey
                              and s_nationkey = n1.n_nationkey
                              and c_nationkey = n2.n_nationkey
                              and (
                                      (n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY')
                                      or (n1.n_name = 'GERMANY' and n2.n_name = 'FRANCE')
                              )
                              and l_shipdate between date '1995-01-01' and date '1996-12-31'
              ) as shipping
      group by
              supp_nation,
              cust_nation,
              l_year
      order by
              supp_nation,
              cust_nation,
              l_year
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 220
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   ..    l_year"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "supp_natio..as revenue"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "supp_nation"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "supp_nation"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "supp_nation"
                            children:
                              - type: NAME
                                text: "supp_nation"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "cust_nation"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "cust_nation"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "cust_nation"
                            children:
                              - type: NAME
                                text: "cust_nation"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "l_year"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "l_year"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "l_year"
                            children:
                              - type: NAME
                                text: "l_year"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(volume..as revenue"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(volume)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            children:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "volume"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "volume"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "volume"
                                    children:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "volume"
                                        children:
                                          - type: NAME
                                            text: "volume"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "revenue"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n     ..s shipping"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "(\n        ..s shipping"
                    children:
                      - key: SQL_TABLEREF_ALIAS
                        type: NAME
                        text: "shipping"
                      - key: SQL_TABLEREF_TABLE
                        type: OBJECT_SQL_SELECT
                        text: "(\n        ..\n        )"
                        children:
                          - key: SQL_SELECT_TARGETS
                            type: ARRAY
                            text: "n1.n_name .. as volume"
                            children:
                              - type: OBJECT_SQL_RESULT_TARGET
                                text: "n1.n_name ..upp_nation"
                                children:
                                  - key: SQL_RESULT_TARGET_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "n1.n_name"
                                    children:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "n1.n_name"
                                        children:
                                          - type: NAME
                                            text: "n1"
                                          - type: NAME
                                            text: "n_name"
                                  - key: SQL_RESULT_TARGET_NAME
                                    type: NAME
                                    text: "supp_nation"
                              - type: OBJECT_SQL_RESULT_TARGET
                                text: "n2.n_name ..ust_nation"
                                children:
                                  - key: SQL_RESULT_TARGET_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "n2.n_name"
                                    children:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "n2.n_name"
                                        children:
                                          - type: NAME
                                            text: "n2"
                                          - type: NAME
                                            text: "n_name"
                                  - key: SQL_RESULT_TARGET_NAME
                                    type: NAME
                                    text: "cust_nation"
                              - type: OBJECT_SQL_RESULT_TARGET
                                text: "extract(ye.. as l_year"
                                children:
                                  - key: SQL_RESULT_TARGET_VALUE
                                    type: OBJECT_SQL_FUNCTION_EXPRESSION
                                    text: "extract(ye.._shipdate)"
                                    children:
                                      - key: SQL_FUNCTION_NAME
                                        type: ENUM_SQL_KNOWN_FUNCTION
                                        value: EXTRACT
                                      - key: SQL_FUNCTION_EXTRACT_ARGS
                                        type: OBJECT_SQL_FUNCTION_EXTRACT_ARGS
                                        text: "(year from.._shipdate)"
                                        children:
                                          - key: SQL_FUNCTION_EXTRACT_TARGET
                                            type: ENUM_SQL_EXTRACT_TARGET
                                            value: YEAR
                                          - key: SQL_FUNCTION_EXTRACT_INPUT
                                            type: OBJECT_SQL_COLUMN_REF
                                            text: "l_shipdate"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_shipdate"
                                                children:
                                                  - type: NAME
                                                    text: "l_shipdate"
                                  - key: SQL_RESULT_TARGET_NAME
                                    type: NAME
                                    text: "l_year"
                              - type: OBJECT_SQL_RESULT_TARGET
                                text: "l_extended.. as volume"
                                children:
                                  - key: SQL_RESULT_TARGET_VALUE
                                    type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "l_extended.._discount)"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: MULTIPLY
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "l_extended.._discount)"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_extendedprice"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_extendedprice"
                                                children:
                                                  - type: NAME
                                                    text: "l_extendedprice"
                                          - type: OBJECT_SQL_NARY_EXPRESSION
                                            text: "1 - l_discount"
                                            children:
                                              - key: SQL_EXPRESSION_OPERATOR
                                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                                value: MINUS
                                              - key: SQL_EXPRESSION_ARGS
                                                type: ARRAY
                                                text: "1 - l_discount"
                                                children:
                                                  - type: LITERAL_INTEGER
                                                    text: "1"
                                                  - type: OBJECT_SQL_COLUMN_REF
                                                    text: "l_discount"
                                                    children:
                                                      - key: SQL_COLUMN_REF_PATH
                                                        type: ARRAY
                                                        text: "l_discount"
                                                        children:
                                                          - type: NAME
                                                            text: "l_discount"
                                  - key: SQL_RESULT_TARGET_NAME
                                    type: NAME
                                    text: "volume"
                          - key: SQL_SELECT_FROM
                            type: ARRAY
                            text: "from\n     .. nation n2"
                            children:
                              - type: OBJECT_SQL_TABLEREF
                                text: "supplier"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "supplier"
                                    children:
                                      - type: NAME
                                        text: "supplier"
                              - type: OBJECT_SQL_TABLEREF
                                text: "lineitem"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "lineitem"
                                    children:
                                      - type: NAME
                                        text: "lineitem"
                              - type: OBJECT_SQL_TABLEREF
                                text: "orders"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "orders"
                                    children:
                                      - type: NAME
                                        text: "orders"
                              - type: OBJECT_SQL_TABLEREF
                                text: "customer"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "customer"
                                    children:
                                      - type: NAME
                                        text: "customer"
                              - type: OBJECT_SQL_TABLEREF
                                text: "nation n1"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "nation"
                                    children:
                                      - type: NAME
                                        text: "nation"
                                  - key: SQL_TABLEREF_ALIAS
                                    type: NAME
                                    text: "n1"
                              - type: OBJECT_SQL_TABLEREF
                                text: "nation n2"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "nation"
                                    children:
                                      - type: NAME
                                        text: "nation"
                                  - key: SQL_TABLEREF_ALIAS
                                    type: NAME
                                    text: "n2"
                          - key: SQL_SELECT_WHERE
                            type: OBJECT_SQL_NARY_EXPRESSION
                            text: "s_suppkey ..996-12-31'"
                            children:
                              - key: SQL_EXPRESSION_OPERATOR
                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                value: AND
                              - key: SQL_EXPRESSION_ARGS
                                type: ARRAY
                                text: "s_suppkey ..996-12-31'"
                                children:
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "s_suppkey .. l_suppkey"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "s_suppkey .. l_suppkey"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "s_suppkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "s_suppkey"
                                                children:
                                                  - type: NAME
                                                    text: "s_suppkey"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_suppkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_suppkey"
                                                children:
                                                  - type: NAME
                                                    text: "l_suppkey"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "o_orderkey..l_orderkey"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "o_orderkey..l_orderkey"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "o_orderkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "o_orderkey"
                                                children:
                                                  - type: NAME
                                                    text: "o_orderkey"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_orderkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_orderkey"
                                                children:
                                                  - type: NAME
                                                    text: "l_orderkey"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "c_custkey .. o_custkey"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "c_custkey .. o_custkey"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "c_custkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "c_custkey"
                                                children:
                                                  - type: NAME
                                                    text: "c_custkey"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "o_custkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "o_custkey"
                                                children:
                                                  - type: NAME
                                                    text: "o_custkey"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "s_nationke.._nationkey"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "s_nationke.._nationkey"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "s_nationkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "s_nationkey"
                                                children:
                                                  - type: NAME
                                                    text: "s_nationkey"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "n1.n_nationkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "n1.n_nationkey"
                                                children:
                                                  - type: NAME
                                                    text: "n1"
                                                  - type: NAME
                                                    text: "n_nationkey"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "c_nationke.._nationkey"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "c_nationke.._nationkey"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "c_nationkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "c_nationkey"
                                                children:
                                                  - type: NAME
                                                    text: "c_nationkey"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "n2.n_nationkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "n2.n_nationkey"
                                                children:
                                                  - type: NAME
                                                    text: "n2"
                                                  - type: NAME
                                                    text: "n_nationkey"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "(n1.n_name.. 'FRANCE')"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: OR
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "(n1.n_name.. 'FRANCE')"
                                        children:
                                          - type: OBJECT_SQL_NARY_EXPRESSION
                                            text: "n1.n_name .. 'GERMANY'"
                                            children:
                                              - key: SQL_EXPRESSION_OPERATOR
                                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                                value: AND
                                              - key: SQL_EXPRESSION_ARGS
                                                type: ARRAY
                                                text: "n1.n_name .. 'GERMANY'"
                                                children:
                                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                                    text: "n1.n_name ..= 'FRANCE'"
                                                    children:
                                                      - key: SQL_EXPRESSION_OPERATOR
                                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                                        value: EQUAL
                                                      - key: SQL_EXPRESSION_ARGS
                                                        type: ARRAY
                                                        text: "n1.n_name ..= 'FRANCE'"
                                                        children:
                                                          - type: OBJECT_SQL_COLUMN_REF
                                                            text: "n1.n_name"
                                                            children:
                                                              - key: SQL_COLUMN_REF_PATH
                                                                type: ARRAY
                                                                text: "n1.n_name"
                                                                children:
                                                                  - type: NAME
                                                                    text: "n1"
                                                                  - type: NAME
                                                                    text: "n_name"
                                                          - type: LITERAL_STRING
                                                            text: "'FRANCE'"
                                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                                    text: "n2.n_name .. 'GERMANY'"
                                                    children:
                                                      - key: SQL_EXPRESSION_OPERATOR
                                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                                        value: EQUAL
                                                      - key: SQL_EXPRESSION_ARGS
                                                        type: ARRAY
                                                        text: "n2.n_name .. 'GERMANY'"
                                                        children:
                                                          - type: OBJECT_SQL_COLUMN_REF
                                                            text: "n2.n_name"
                                                            children:
                                                              - key: SQL_COLUMN_REF_PATH
                                                                type: ARRAY
                                                                text: "n2.n_name"
                                                                children:
                                                                  - type: NAME
                                                                    text: "n2"
                                                                  - type: NAME
                                                                    text: "n_name"
                                                          - type: LITERAL_STRING
                                                            text: "'GERMANY'"
                                          - type: OBJECT_SQL_NARY_EXPRESSION
                                            text: "n1.n_name ..= 'FRANCE'"
                                            children:
                                              - key: SQL_EXPRESSION_OPERATOR
                                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                                value: AND
                                              - key: SQL_EXPRESSION_ARGS
                                                type: ARRAY
                                                text: "n1.n_name ..= 'FRANCE'"
                                                children:
                                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                                    text: "n1.n_name .. 'GERMANY'"
                                                    children:
                                                      - key: SQL_EXPRESSION_OPERATOR
                                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                                        value: EQUAL
                                                      - key: SQL_EXPRESSION_ARGS
                                                        type: ARRAY
                                                        text: "n1.n_name .. 'GERMANY'"
                                                        children:
                                                          - type: OBJECT_SQL_COLUMN_REF
                                                            text: "n1.n_name"
                                                            children:
                                                              - key: SQL_COLUMN_REF_PATH
                                                                type: ARRAY
                                                                text: "n1.n_name"
                                                                children:
                                                                  - type: NAME
                                                                    text: "n1"
                                                                  - type: NAME
                                                                    text: "n_name"
                                                          - type: LITERAL_STRING
                                                            text: "'GERMANY'"
                                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                                    text: "n2.n_name ..= 'FRANCE'"
                                                    children:
                                                      - key: SQL_EXPRESSION_OPERATOR
                                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                                        value: EQUAL
                                                      - key: SQL_EXPRESSION_ARGS
                                                        type: ARRAY
                                                        text: "n2.n_name ..= 'FRANCE'"
                                                        children:
                                                          - type: OBJECT_SQL_COLUMN_REF
                                                            text: "n2.n_name"
                                                            children:
                                                              - key: SQL_COLUMN_REF_PATH
                                                                type: ARRAY
                                                                text: "n2.n_name"
                                                                children:
                                                                  - type: NAME
                                                                    text: "n2"
                                                                  - type: NAME
                                                                    text: "n_name"
                                                          - type: LITERAL_STRING
                                                            text: "'FRANCE'"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "l_shipdate..996-12-31'"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: BETWEEN_SYMMETRIC
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "l_shipdate..996-12-31'"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_shipdate"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_shipdate"
                                                children:
                                                  - type: NAME
                                                    text: "l_shipdate"
                                          - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                            text: "date '1995-01-01'"
                                            children:
                                              - key: SQL_CONST_CAST_FUNC_NAME
                                                type: ARRAY
                                                text: "date"
                                                children:
                                                  - type: NAME
                                                    text: "date"
                                              - key: SQL_CONST_CAST_VALUE
                                                type: LITERAL_STRING
                                                text: "'1995-01-01'"
                                          - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                            text: "date '1996-12-31'"
                                            children:
                                              - key: SQL_CONST_CAST_FUNC_NAME
                                                type: ARRAY
                                                text: "date"
                                                children:
                                                  - type: NAME
                                                    text: "date"
                                              - key: SQL_CONST_CAST_VALUE
                                                type: LITERAL_STRING
                                                text: "'1996-12-31'"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by\n ..    l_year"
                children:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "supp_nation"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "supp_nation"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "supp_nation"
                            children:
                              - type: NAME
                                text: "supp_nation"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "cust_nation"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "cust_nation"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "cust_nation"
                            children:
                              - type: NAME
                                text: "cust_nation"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "l_year"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "l_year"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "l_year"
                            children:
                              - type: NAME
                                text: "l_year"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by\n ..    l_year"
                children:
                  - type: OBJECT_SQL_ORDER
                    text: "supp_nation"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "supp_nation"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "supp_nation"
                            children:
                              - type: NAME
                                text: "supp_nation"
                  - type: OBJECT_SQL_ORDER
                    text: "cust_nation"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "cust_nation"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "cust_nation"
                            children:
                              - type: NAME
                                text: "cust_nation"
                  - type: OBJECT_SQL_ORDER
                    text: "l_year"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "l_year"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "l_year"
                            children:
                              - type: NAME
                                text: "l_year"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [27,28]
        - text: [48,49]
        - text: [64,65]
        - text: [95,96]
        - text: [100,101]
        - text: [110,111]
        - text: [133,134]
        - text: [183,184]
        - text: [233,234]
        - text: [298,299]
        - text: [367,368]
        - text: [388,389]
        - text: [422,423]
        - text: [456,457]
        - text: [488,489]
        - text: [522,523]
        - text: [557,558]
        - text: [591,592]
        - text: [613,614]
        - text: [659,660]
        - text: [711,712]
        - text: [761,762]
        - text: [818,819]
        - text: [875,876]
        - text: [905,906]
        - text: [986,987]
        - text: [1070,1071]
        - text: [1096,1097]
        - text: [1183,1184]
        - text: [1205,1206]
        - text: [1214,1215]
        - text: [1235,1236]
        - text: [1256,1257]
        - text: [1271,1272]
        - text: [1280,1281]
        - text: [1301,1302]
        - text: [1322,1323]
      comments: []

  - name: tpch_8
    input: |-
      select
              o_year,
              sum(case
                      when nation = 'BRAZIL' then volume
                      else 0
              end) / sum(volume) as mkt_share
      from
              (
                      select
                              extract(year from o_orderdate) as o_year,
                              l_extendedprice * (1 - l_discount) as volume,
                              n2.n_name as nation
                      from
                              part,
                              supplier,
                              lineitem,
                              orders,
                              customer,
                              nation n1,
                              nation n2,
                              region
                      where
                              p_partkey = l_partkey
                              and s_suppkey = l_suppkey
                              and l_orderkey = o_orderkey
                              and o_custkey = c_custkey
                              and c_nationkey = n1.n_nationkey
                              and n1.n_regionkey = r_regionkey
                              and r_name = 'AMERICA'
                              and s_nationkey = n2.n_nationkey
                              and o_orderdate between date '1995-01-01' and date '1996-12-31'
                              and p_type = 'ECONOMY ANODIZED STEEL'
              ) as all_nations
      group by
              o_year
      order by
              o_year
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 208
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   ..    o_year"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "o_year,\n  .. mkt_share"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "o_year"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_year"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_year"
                            children:
                              - type: NAME
                                text: "o_year"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(case\n .. mkt_share"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_NARY_EXPRESSION
                        text: "sum(case\n ..um(volume)"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: DIVIDE
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "sum(case\n ..um(volume)"
                            children:
                              - type: OBJECT_SQL_FUNCTION_EXPRESSION
                                text: "sum(case\n ..      end)"
                                children:
                                  - key: SQL_FUNCTION_NAME
                                    type: ARRAY
                                    text: "sum"
                                    children:
                                      - type: NAME
                                        text: "sum"
                                  - key: SQL_FUNCTION_ARGUMENTS
                                    type: ARRAY
                                    text: "case\n     ..       end"
                                    children:
                                      - type: OBJECT_SQL_FUNCTION_ARG
                                        text: "case\n     ..       end"
                                        children:
                                          - key: SQL_FUNCTION_ARG_VALUE
                                            type: OBJECT_SQL_CASE
                                            text: "case\n     ..       end"
                                            children:
                                              - key: SQL_CASE_CLAUSES
                                                type: ARRAY
                                                text: "when natio..hen volume"
                                                children:
                                                  - type: OBJECT_SQL_CASE_CLAUSE
                                                    text: "when natio..hen volume"
                                                    children:
                                                      - key: SQL_CASE_CLAUSE_WHEN
                                                        type: OBJECT_SQL_NARY_EXPRESSION
                                                        text: "nation = 'BRAZIL'"
                                                        children:
                                                          - key: SQL_EXPRESSION_OPERATOR
                                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                                            value: EQUAL
                                                          - key: SQL_EXPRESSION_ARGS
                                                            type: ARRAY
                                                            text: "nation = 'BRAZIL'"
                                                            children:
                                                              - type: OBJECT_SQL_COLUMN_REF
                                                                text: "nation"
                                                                children:
                                                                  - key: SQL_COLUMN_REF_PATH
                                                                    type: ARRAY
                                                                    text: "nation"
                                                                    children:
                                                                      - type: NAME
                                                                        text: "nation"
                                                              - type: LITERAL_STRING
                                                                text: "'BRAZIL'"
                                                      - key: SQL_CASE_CLAUSE_THEN
                                                        type: OBJECT_SQL_COLUMN_REF
                                                        text: "volume"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "volume"
                                                            children:
                                                              - type: NAME
                                                                text: "volume"
                                              - key: SQL_CASE_DEFAULT
                                                type: LITERAL_INTEGER
                                                text: "0"
                              - type: OBJECT_SQL_FUNCTION_EXPRESSION
                                text: "sum(volume)"
                                children:
                                  - key: SQL_FUNCTION_NAME
                                    type: ARRAY
                                    text: "sum"
                                    children:
                                      - type: NAME
                                        text: "sum"
                                  - key: SQL_FUNCTION_ARGUMENTS
                                    type: ARRAY
                                    text: "volume"
                                    children:
                                      - type: OBJECT_SQL_FUNCTION_ARG
                                        text: "volume"
                                        children:
                                          - key: SQL_FUNCTION_ARG_VALUE
                                            type: OBJECT_SQL_COLUMN_REF
                                            text: "volume"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "volume"
                                                children:
                                                  - type: NAME
                                                    text: "volume"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "mkt_share"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n     ..ll_nations"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "(\n        ..ll_nations"
                    children:
                      - key: SQL_TABLEREF_ALIAS
                        type: NAME
                        text: "all_nations"
                      - key: SQL_TABLEREF_TABLE
                        type: OBJECT_SQL_SELECT
                        text: "(\n        ..\n        )"
                        children:
                          - key: SQL_SELECT_TARGETS
                            type: ARRAY
                            text: "extract(ye.. as nation"
                            children:
                              - type: OBJECT_SQL_RESULT_TARGET
                                text: "extract(ye.. as o_year"
                                children:
                                  - key: SQL_RESULT_TARGET_VALUE
                                    type: OBJECT_SQL_FUNCTION_EXPRESSION
                                    text: "extract(ye..orderdate)"
                                    children:
                                      - key: SQL_FUNCTION_NAME
                                        type: ENUM_SQL_KNOWN_FUNCTION
                                        value: EXTRACT
                                      - key: SQL_FUNCTION_EXTRACT_ARGS
                                        type: OBJECT_SQL_FUNCTION_EXTRACT_ARGS
                                        text: "(year from..orderdate)"
                                        children:
                                          - key: SQL_FUNCTION_EXTRACT_TARGET
                                            type: ENUM_SQL_EXTRACT_TARGET
                                            value: YEAR
                                          - key: SQL_FUNCTION_EXTRACT_INPUT
                                            type: OBJECT_SQL_COLUMN_REF
                                            text: "o_orderdate"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "o_orderdate"
                                                children:
                                                  - type: NAME
                                                    text: "o_orderdate"
                                  - key: SQL_RESULT_TARGET_NAME
                                    type: NAME
                                    text: "o_year"
                              - type: OBJECT_SQL_RESULT_TARGET
                                text: "l_extended.. as volume"
                                children:
                                  - key: SQL_RESULT_TARGET_VALUE
                                    type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "l_extended.._discount)"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: MULTIPLY
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "l_extended.._discount)"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_extendedprice"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_extendedprice"
                                                children:
                                                  - type: NAME
                                                    text: "l_extendedprice"
                                          - type: OBJECT_SQL_NARY_EXPRESSION
                                            text: "1 - l_discount"
                                            children:
                                              - key: SQL_EXPRESSION_OPERATOR
                                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                                value: MINUS
                                              - key: SQL_EXPRESSION_ARGS
                                                type: ARRAY
                                                text: "1 - l_discount"
                                                children:
                                                  - type: LITERAL_INTEGER
                                                    text: "1"
                                                  - type: OBJECT_SQL_COLUMN_REF
                                                    text: "l_discount"
                                                    children:
                                                      - key: SQL_COLUMN_REF_PATH
                                                        type: ARRAY
                                                        text: "l_discount"
                                                        children:
                                                          - type: NAME
                                                            text: "l_discount"
                                  - key: SQL_RESULT_TARGET_NAME
                                    type: NAME
                                    text: "volume"
                              - type: OBJECT_SQL_RESULT_TARGET
                                text: "n2.n_name as nation"
                                children:
                                  - key: SQL_RESULT_TARGET_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "n2.n_name"
                                    children:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "n2.n_name"
                                        children:
                                          - type: NAME
                                            text: "n2"
                                          - type: NAME
                                            text: "n_name"
                                  - key: SQL_RESULT_TARGET_NAME
                                    type: NAME
                                    text: "nation"
                          - key: SQL_SELECT_FROM
                            type: ARRAY
                            text: "from\n     ..    region"
                            children:
                              - type: OBJECT_SQL_TABLEREF
                                text: "part"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "part"
                                    children:
                                      - type: NAME
                                        text: "part"
                              - type: OBJECT_SQL_TABLEREF
                                text: "supplier"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "supplier"
                                    children:
                                      - type: NAME
                                        text: "supplier"
                              - type: OBJECT_SQL_TABLEREF
                                text: "lineitem"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "lineitem"
                                    children:
                                      - type: NAME
                                        text: "lineitem"
                              - type: OBJECT_SQL_TABLEREF
                                text: "orders"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "orders"
                                    children:
                                      - type: NAME
                                        text: "orders"
                              - type: OBJECT_SQL_TABLEREF
                                text: "customer"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "customer"
                                    children:
                                      - type: NAME
                                        text: "customer"
                              - type: OBJECT_SQL_TABLEREF
                                text: "nation n1"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "nation"
                                    children:
                                      - type: NAME
                                        text: "nation"
                                  - key: SQL_TABLEREF_ALIAS
                                    type: NAME
                                    text: "n1"
                              - type: OBJECT_SQL_TABLEREF
                                text: "nation n2"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "nation"
                                    children:
                                      - type: NAME
                                        text: "nation"
                                  - key: SQL_TABLEREF_ALIAS
                                    type: NAME
                                    text: "n2"
                              - type: OBJECT_SQL_TABLEREF
                                text: "region"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "region"
                                    children:
                                      - type: NAME
                                        text: "region"
                          - key: SQL_SELECT_WHERE
                            type: OBJECT_SQL_NARY_EXPRESSION
                            text: "p_partkey ..ZED STEEL'"
                            children:
                              - key: SQL_EXPRESSION_OPERATOR
                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                value: AND
                              - key: SQL_EXPRESSION_ARGS
                                type: ARRAY
                                text: "p_partkey ..ZED STEEL'"
                                children:
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "p_partkey .. l_partkey"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "p_partkey .. l_partkey"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "p_partkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "p_partkey"
                                                children:
                                                  - type: NAME
                                                    text: "p_partkey"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_partkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_partkey"
                                                children:
                                                  - type: NAME
                                                    text: "l_partkey"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "s_suppkey .. l_suppkey"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "s_suppkey .. l_suppkey"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "s_suppkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "s_suppkey"
                                                children:
                                                  - type: NAME
                                                    text: "s_suppkey"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_suppkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_suppkey"
                                                children:
                                                  - type: NAME
                                                    text: "l_suppkey"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "l_orderkey..o_orderkey"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "l_orderkey..o_orderkey"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_orderkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_orderkey"
                                                children:
                                                  - type: NAME
                                                    text: "l_orderkey"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "o_orderkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "o_orderkey"
                                                children:
                                                  - type: NAME
                                                    text: "o_orderkey"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "o_custkey .. c_custkey"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "o_custkey .. c_custkey"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "o_custkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "o_custkey"
                                                children:
                                                  - type: NAME
                                                    text: "o_custkey"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "c_custkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "c_custkey"
                                                children:
                                                  - type: NAME
                                                    text: "c_custkey"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "c_nationke.._nationkey"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "c_nationke.._nationkey"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "c_nationkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "c_nationkey"
                                                children:
                                                  - type: NAME
                                                    text: "c_nationkey"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "n1.n_nationkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "n1.n_nationkey"
                                                children:
                                                  - type: NAME
                                                    text: "n1"
                                                  - type: NAME
                                                    text: "n_nationkey"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "n1.n_regio.._regionkey"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "n1.n_regio.._regionkey"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "n1.n_regionkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "n1.n_regionkey"
                                                children:
                                                  - type: NAME
                                                    text: "n1"
                                                  - type: NAME
                                                    text: "n_regionkey"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "r_regionkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "r_regionkey"
                                                children:
                                                  - type: NAME
                                                    text: "r_regionkey"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "r_name = 'AMERICA'"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "r_name = 'AMERICA'"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "r_name"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "r_name"
                                                children:
                                                  - type: NAME
                                                    text: "r_name"
                                          - type: LITERAL_STRING
                                            text: "'AMERICA'"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "s_nationke.._nationkey"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "s_nationke.._nationkey"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "s_nationkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "s_nationkey"
                                                children:
                                                  - type: NAME
                                                    text: "s_nationkey"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "n2.n_nationkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "n2.n_nationkey"
                                                children:
                                                  - type: NAME
                                                    text: "n2"
                                                  - type: NAME
                                                    text: "n_nationkey"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "o_orderdat..996-12-31'"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: BETWEEN_SYMMETRIC
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "o_orderdat..996-12-31'"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "o_orderdate"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "o_orderdate"
                                                children:
                                                  - type: NAME
                                                    text: "o_orderdate"
                                          - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                            text: "date '1995-01-01'"
                                            children:
                                              - key: SQL_CONST_CAST_FUNC_NAME
                                                type: ARRAY
                                                text: "date"
                                                children:
                                                  - type: NAME
                                                    text: "date"
                                              - key: SQL_CONST_CAST_VALUE
                                                type: LITERAL_STRING
                                                text: "'1995-01-01'"
                                          - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                            text: "date '1996-12-31'"
                                            children:
                                              - key: SQL_CONST_CAST_FUNC_NAME
                                                type: ARRAY
                                                text: "date"
                                                children:
                                                  - type: NAME
                                                    text: "date"
                                              - key: SQL_CONST_CAST_VALUE
                                                type: LITERAL_STRING
                                                text: "'1996-12-31'"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "p_type = '..ZED STEEL'"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "p_type = '..ZED STEEL'"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "p_type"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "p_type"
                                                children:
                                                  - type: NAME
                                                    text: "p_type"
                                          - type: LITERAL_STRING
                                            text: "'ECONOMY A..ZED STEEL'"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by\n ..    o_year"
                children:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "o_year"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_year"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_year"
                            children:
                              - type: NAME
                                text: "o_year"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by\n ..    o_year"
                children:
                  - type: OBJECT_SQL_ORDER
                    text: "o_year"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_year"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_year"
                            children:
                              - type: NAME
                                text: "o_year"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [22,23]
        - text: [39,40]
        - text: [90,91]
        - text: [113,114]
        - text: [153,154]
        - text: [158,159]
        - text: [168,169]
        - text: [191,192]
        - text: [257,258]
        - text: [327,328]
        - text: [371,372]
        - text: [392,393]
        - text: [422,423]
        - text: [456,457]
        - text: [490,491]
        - text: [522,523]
        - text: [556,557]
        - text: [591,592]
        - text: [626,627]
        - text: [657,658]
        - text: [679,680]
        - text: [725,726]
        - text: [775,776]
        - text: [827,828]
        - text: [877,878]
        - text: [934,935]
        - text: [991,992]
        - text: [1038,1039]
        - text: [1095,1096]
        - text: [1183,1184]
        - text: [1245,1246]
        - text: [1270,1271]
        - text: [1279,1280]
        - text: [1294,1295]
        - text: [1303,1304]
      comments: []

  - name: tpch_9
    input: |-
      select
              nation,
              o_year,
              sum(amount) as sum_profit
      from
              (
                      select
                              n_name as nation,
                              extract(year from o_orderdate) as o_year,
                              l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
                      from
                              part,
                              supplier,
                              lineitem,
                              partsupp,
                              orders,
                              nation
                      where
                              s_suppkey = l_suppkey
                              and ps_suppkey = l_suppkey
                              and ps_partkey = l_partkey
                              and p_partkey = l_partkey
                              and o_orderkey = l_orderkey
                              and s_nationkey = n_nationkey
                              and p_name like '%green%'
              ) as profit
      group by
              nation,
              o_year
      order by
              nation,
              o_year desc
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 170
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   .._year desc"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "nation,\n  ..sum_profit"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "nation"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "nation"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "nation"
                            children:
                              - type: NAME
                                text: "nation"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "o_year"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_year"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_year"
                            children:
                              - type: NAME
                                text: "o_year"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(amount..sum_profit"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(amount)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            children:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "amount"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "amount"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "amount"
                                    children:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "amount"
                                        children:
                                          - type: NAME
                                            text: "amount"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "sum_profit"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n     .. as profit"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "(\n        .. as profit"
                    children:
                      - key: SQL_TABLEREF_ALIAS
                        type: NAME
                        text: "profit"
                      - key: SQL_TABLEREF_TABLE
                        type: OBJECT_SQL_SELECT
                        text: "(\n        ..\n        )"
                        children:
                          - key: SQL_SELECT_TARGETS
                            type: ARRAY
                            text: "n_name as .. as amount"
                            children:
                              - type: OBJECT_SQL_RESULT_TARGET
                                text: "n_name as nation"
                                children:
                                  - key: SQL_RESULT_TARGET_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "n_name"
                                    children:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "n_name"
                                        children:
                                          - type: NAME
                                            text: "n_name"
                                  - key: SQL_RESULT_TARGET_NAME
                                    type: NAME
                                    text: "nation"
                              - type: OBJECT_SQL_RESULT_TARGET
                                text: "extract(ye.. as o_year"
                                children:
                                  - key: SQL_RESULT_TARGET_VALUE
                                    type: OBJECT_SQL_FUNCTION_EXPRESSION
                                    text: "extract(ye..orderdate)"
                                    children:
                                      - key: SQL_FUNCTION_NAME
                                        type: ENUM_SQL_KNOWN_FUNCTION
                                        value: EXTRACT
                                      - key: SQL_FUNCTION_EXTRACT_ARGS
                                        type: OBJECT_SQL_FUNCTION_EXTRACT_ARGS
                                        text: "(year from..orderdate)"
                                        children:
                                          - key: SQL_FUNCTION_EXTRACT_TARGET
                                            type: ENUM_SQL_EXTRACT_TARGET
                                            value: YEAR
                                          - key: SQL_FUNCTION_EXTRACT_INPUT
                                            type: OBJECT_SQL_COLUMN_REF
                                            text: "o_orderdate"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "o_orderdate"
                                                children:
                                                  - type: NAME
                                                    text: "o_orderdate"
                                  - key: SQL_RESULT_TARGET_NAME
                                    type: NAME
                                    text: "o_year"
                              - type: OBJECT_SQL_RESULT_TARGET
                                text: "l_extended.. as amount"
                                children:
                                  - key: SQL_RESULT_TARGET_VALUE
                                    type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "l_extended..l_quantity"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: MINUS
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "l_extended..l_quantity"
                                        children:
                                          - type: OBJECT_SQL_NARY_EXPRESSION
                                            text: "l_extended.._discount)"
                                            children:
                                              - key: SQL_EXPRESSION_OPERATOR
                                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                                value: MULTIPLY
                                              - key: SQL_EXPRESSION_ARGS
                                                type: ARRAY
                                                text: "l_extended.._discount)"
                                                children:
                                                  - type: OBJECT_SQL_COLUMN_REF
                                                    text: "l_extendedprice"
                                                    children:
                                                      - key: SQL_COLUMN_REF_PATH
                                                        type: ARRAY
                                                        text: "l_extendedprice"
                                                        children:
                                                          - type: NAME
                                                            text: "l_extendedprice"
                                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                                    text: "1 - l_discount"
                                                    children:
                                                      - key: SQL_EXPRESSION_OPERATOR
                                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                                        value: MINUS
                                                      - key: SQL_EXPRESSION_ARGS
                                                        type: ARRAY
                                                        text: "1 - l_discount"
                                                        children:
                                                          - type: LITERAL_INTEGER
                                                            text: "1"
                                                          - type: OBJECT_SQL_COLUMN_REF
                                                            text: "l_discount"
                                                            children:
                                                              - key: SQL_COLUMN_REF_PATH
                                                                type: ARRAY
                                                                text: "l_discount"
                                                                children:
                                                                  - type: NAME
                                                                    text: "l_discount"
                                          - type: OBJECT_SQL_NARY_EXPRESSION
                                            text: "ps_supplyc..l_quantity"
                                            children:
                                              - key: SQL_EXPRESSION_OPERATOR
                                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                                value: MULTIPLY
                                              - key: SQL_EXPRESSION_ARGS
                                                type: ARRAY
                                                text: "ps_supplyc..l_quantity"
                                                children:
                                                  - type: OBJECT_SQL_COLUMN_REF
                                                    text: "ps_supplycost"
                                                    children:
                                                      - key: SQL_COLUMN_REF_PATH
                                                        type: ARRAY
                                                        text: "ps_supplycost"
                                                        children:
                                                          - type: NAME
                                                            text: "ps_supplycost"
                                                  - type: OBJECT_SQL_COLUMN_REF
                                                    text: "l_quantity"
                                                    children:
                                                      - key: SQL_COLUMN_REF_PATH
                                                        type: ARRAY
                                                        text: "l_quantity"
                                                        children:
                                                          - type: NAME
                                                            text: "l_quantity"
                                  - key: SQL_RESULT_TARGET_NAME
                                    type: NAME
                                    text: "amount"
                          - key: SQL_SELECT_FROM
                            type: ARRAY
                            text: "from\n     ..    nation"
                            children:
                              - type: OBJECT_SQL_TABLEREF
                                text: "part"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "part"
                                    children:
                                      - type: NAME
                                        text: "part"
                              - type: OBJECT_SQL_TABLEREF
                                text: "supplier"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "supplier"
                                    children:
                                      - type: NAME
                                        text: "supplier"
                              - type: OBJECT_SQL_TABLEREF
                                text: "lineitem"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "lineitem"
                                    children:
                                      - type: NAME
                                        text: "lineitem"
                              - type: OBJECT_SQL_TABLEREF
                                text: "partsupp"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "partsupp"
                                    children:
                                      - type: NAME
                                        text: "partsupp"
                              - type: OBJECT_SQL_TABLEREF
                                text: "orders"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "orders"
                                    children:
                                      - type: NAME
                                        text: "orders"
                              - type: OBJECT_SQL_TABLEREF
                                text: "nation"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "nation"
                                    children:
                                      - type: NAME
                                        text: "nation"
                          - key: SQL_SELECT_WHERE
                            type: OBJECT_SQL_NARY_EXPRESSION
                            text: "s_suppkey .. '%green%'"
                            children:
                              - key: SQL_EXPRESSION_OPERATOR
                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                value: AND
                              - key: SQL_EXPRESSION_ARGS
                                type: ARRAY
                                text: "s_suppkey .. '%green%'"
                                children:
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "s_suppkey .. l_suppkey"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "s_suppkey .. l_suppkey"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "s_suppkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "s_suppkey"
                                                children:
                                                  - type: NAME
                                                    text: "s_suppkey"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_suppkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_suppkey"
                                                children:
                                                  - type: NAME
                                                    text: "l_suppkey"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "ps_suppkey.. l_suppkey"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "ps_suppkey.. l_suppkey"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "ps_suppkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "ps_suppkey"
                                                children:
                                                  - type: NAME
                                                    text: "ps_suppkey"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_suppkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_suppkey"
                                                children:
                                                  - type: NAME
                                                    text: "l_suppkey"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "ps_partkey.. l_partkey"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "ps_partkey.. l_partkey"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "ps_partkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "ps_partkey"
                                                children:
                                                  - type: NAME
                                                    text: "ps_partkey"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_partkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_partkey"
                                                children:
                                                  - type: NAME
                                                    text: "l_partkey"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "p_partkey .. l_partkey"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "p_partkey .. l_partkey"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "p_partkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "p_partkey"
                                                children:
                                                  - type: NAME
                                                    text: "p_partkey"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_partkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_partkey"
                                                children:
                                                  - type: NAME
                                                    text: "l_partkey"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "o_orderkey..l_orderkey"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "o_orderkey..l_orderkey"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "o_orderkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "o_orderkey"
                                                children:
                                                  - type: NAME
                                                    text: "o_orderkey"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_orderkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_orderkey"
                                                children:
                                                  - type: NAME
                                                    text: "l_orderkey"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "s_nationke.._nationkey"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "s_nationke.._nationkey"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "s_nationkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "s_nationkey"
                                                children:
                                                  - type: NAME
                                                    text: "s_nationkey"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "n_nationkey"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "n_nationkey"
                                                children:
                                                  - type: NAME
                                                    text: "n_nationkey"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "p_name lik.. '%green%'"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: LIKE
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "p_name lik.. '%green%'"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "p_name"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "p_name"
                                                children:
                                                  - type: NAME
                                                    text: "p_name"
                                          - type: LITERAL_STRING
                                            text: "'%green%'"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by\n ..    o_year"
                children:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "nation"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "nation"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "nation"
                            children:
                              - type: NAME
                                text: "nation"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "o_year"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_year"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_year"
                            children:
                              - type: NAME
                                text: "o_year"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by\n .._year desc"
                children:
                  - type: OBJECT_SQL_ORDER
                    text: "nation"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "nation"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "nation"
                            children:
                              - type: NAME
                                text: "nation"
                  - type: OBJECT_SQL_ORDER
                    text: "o_year desc"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_year"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_year"
                            children:
                              - type: NAME
                                text: "o_year"
                      - key: SQL_ORDER_DIRECTION
                        type: ENUM_SQL_ORDER_DIRECTION
                        value: DESCENDING
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [22,23]
        - text: [38,39]
        - text: [72,73]
        - text: [77,78]
        - text: [87,88]
        - text: [110,111]
        - text: [152,153]
        - text: [218,219]
        - text: [316,317]
        - text: [337,338]
        - text: [367,368]
        - text: [401,402]
        - text: [435,436]
        - text: [469,470]
        - text: [501,502]
        - text: [532,533]
        - text: [554,555]
        - text: [600,601]
        - text: [651,652]
        - text: [702,703]
        - text: [752,753]
        - text: [804,805]
        - text: [858,859]
        - text: [908,909]
        - text: [928,929]
        - text: [937,938]
        - text: [953,954]
        - text: [968,969]
        - text: [977,978]
        - text: [993,994]
      comments: []

  - name: tpch_10
    input: |-
      select
              c_custkey,
              c_name,
              sum(l_extendedprice * (1 - l_discount)) as revenue,
              c_acctbal,
              n_name,
              c_address,
              c_phone,
              c_comment
      from
              customer,
              orders,
              lineitem,
              nation
      where
              c_custkey = o_custkey
              and l_orderkey = o_orderkey
              and o_orderdate >= date '1993-10-01'
              and o_orderdate < date '1994-01-01'
              and l_returnflag = 'R'
              and c_nationkey = n_nationkey
      group by
              c_custkey,
              c_name,
              c_acctbal,
              c_phone,
              n_name,
              c_address,
              c_comment
      order by
              revenue desc
      limit
      	20
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 163
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   ..\nlimit\n	20"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "c_custkey,.. c_comment"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "c_custkey"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_custkey"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_custkey"
                            children:
                              - type: NAME
                                text: "c_custkey"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "c_name"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_name"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_name"
                            children:
                              - type: NAME
                                text: "c_name"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(l_exte..as revenue"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(l_exte..discount))"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            children:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "l_extended.._discount)"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "l_extended.._discount)"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "l_extended.._discount)"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: MULTIPLY
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "l_extended.._discount)"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_extendedprice"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_extendedprice"
                                                children:
                                                  - type: NAME
                                                    text: "l_extendedprice"
                                          - type: OBJECT_SQL_NARY_EXPRESSION
                                            text: "1 - l_discount"
                                            children:
                                              - key: SQL_EXPRESSION_OPERATOR
                                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                                value: MINUS
                                              - key: SQL_EXPRESSION_ARGS
                                                type: ARRAY
                                                text: "1 - l_discount"
                                                children:
                                                  - type: LITERAL_INTEGER
                                                    text: "1"
                                                  - type: OBJECT_SQL_COLUMN_REF
                                                    text: "l_discount"
                                                    children:
                                                      - key: SQL_COLUMN_REF_PATH
                                                        type: ARRAY
                                                        text: "l_discount"
                                                        children:
                                                          - type: NAME
                                                            text: "l_discount"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "revenue"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "c_acctbal"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_acctbal"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_acctbal"
                            children:
                              - type: NAME
                                text: "c_acctbal"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "n_name"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "n_name"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "n_name"
                            children:
                              - type: NAME
                                text: "n_name"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "c_address"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_address"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_address"
                            children:
                              - type: NAME
                                text: "c_address"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "c_phone"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_phone"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_phone"
                            children:
                              - type: NAME
                                text: "c_phone"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "c_comment"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_comment"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_comment"
                            children:
                              - type: NAME
                                text: "c_comment"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n     ..    nation"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "customer"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "customer"
                        children:
                          - type: NAME
                            text: "customer"
                  - type: OBJECT_SQL_TABLEREF
                    text: "orders"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "orders"
                        children:
                          - type: NAME
                            text: "orders"
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineitem"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineitem"
                        children:
                          - type: NAME
                            text: "lineitem"
                  - type: OBJECT_SQL_TABLEREF
                    text: "nation"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "nation"
                        children:
                          - type: NAME
                            text: "nation"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "c_custkey .._nationkey"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "c_custkey .._nationkey"
                    children:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "c_custkey .. o_custkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "c_custkey .. o_custkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "c_custkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "c_custkey"
                                    children:
                                      - type: NAME
                                        text: "c_custkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "o_custkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "o_custkey"
                                    children:
                                      - type: NAME
                                        text: "o_custkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l_orderkey..o_orderkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l_orderkey..o_orderkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_orderkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_orderkey"
                                    children:
                                      - type: NAME
                                        text: "l_orderkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "o_orderkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "o_orderkey"
                                    children:
                                      - type: NAME
                                        text: "o_orderkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "o_orderdat..993-10-01'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: GREATER_EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "o_orderdat..993-10-01'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "o_orderdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "o_orderdate"
                                    children:
                                      - type: NAME
                                        text: "o_orderdate"
                              - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                text: "date '1993-10-01'"
                                children:
                                  - key: SQL_CONST_CAST_FUNC_NAME
                                    type: ARRAY
                                    text: "date"
                                    children:
                                      - type: NAME
                                        text: "date"
                                  - key: SQL_CONST_CAST_VALUE
                                    type: LITERAL_STRING
                                    text: "'1993-10-01'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "o_orderdat..994-01-01'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: LESS_THAN
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "o_orderdat..994-01-01'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "o_orderdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "o_orderdate"
                                    children:
                                      - type: NAME
                                        text: "o_orderdate"
                              - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                text: "date '1994-01-01'"
                                children:
                                  - key: SQL_CONST_CAST_FUNC_NAME
                                    type: ARRAY
                                    text: "date"
                                    children:
                                      - type: NAME
                                        text: "date"
                                  - key: SQL_CONST_CAST_VALUE
                                    type: LITERAL_STRING
                                    text: "'1994-01-01'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l_returnflag = 'R'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l_returnflag = 'R'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_returnflag"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_returnflag"
                                    children:
                                      - type: NAME
                                        text: "l_returnflag"
                              - type: LITERAL_STRING
                                text: "'R'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "c_nationke.._nationkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "c_nationke.._nationkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "c_nationkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "c_nationkey"
                                    children:
                                      - type: NAME
                                        text: "c_nationkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "n_nationkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "n_nationkey"
                                    children:
                                      - type: NAME
                                        text: "n_nationkey"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by\n .. c_comment"
                children:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "c_custkey"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_custkey"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_custkey"
                            children:
                              - type: NAME
                                text: "c_custkey"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "c_name"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_name"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_name"
                            children:
                              - type: NAME
                                text: "c_name"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "c_acctbal"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_acctbal"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_acctbal"
                            children:
                              - type: NAME
                                text: "c_acctbal"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "c_phone"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_phone"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_phone"
                            children:
                              - type: NAME
                                text: "c_phone"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "n_name"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "n_name"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "n_name"
                            children:
                              - type: NAME
                                text: "n_name"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "c_address"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_address"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_address"
                            children:
                              - type: NAME
                                text: "c_address"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "c_comment"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_comment"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_comment"
                            children:
                              - type: NAME
                                text: "c_comment"
              - key: SQL_SELECT_LIMIT
                type: LITERAL_INTEGER
                text: "20"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by\n ..venue desc"
                children:
                  - type: OBJECT_SQL_ORDER
                    text: "revenue desc"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "revenue"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "revenue"
                            children:
                              - type: NAME
                                text: "revenue"
                      - key: SQL_ORDER_DIRECTION
                        type: ENUM_SQL_ORDER_DIRECTION
                        value: DESCENDING
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [25,26]
        - text: [41,42]
        - text: [101,102]
        - text: [120,121]
        - text: [136,137]
        - text: [155,156]
        - text: [172,173]
        - text: [190,191]
        - text: [195,196]
        - text: [213,214]
        - text: [229,230]
        - text: [247,248]
        - text: [262,263]
        - text: [268,269]
        - text: [298,299]
        - text: [334,335]
        - text: [379,380]
        - text: [423,424]
        - text: [454,455]
        - text: [492,493]
        - text: [501,502]
        - text: [520,521]
        - text: [536,537]
        - text: [555,556]
        - text: [572,573]
        - text: [588,589]
        - text: [607,608]
        - text: [625,626]
        - text: [634,635]
        - text: [655,656]
        - text: [661,662]
      comments: []

  - name: tpch_11
    input: |-
      select
              ps_partkey,
              sum(ps_supplycost * ps_availqty) as "value"
      from
              partsupp,
              supplier,
              nation
      where
              ps_suppkey = s_suppkey
              and s_nationkey = n_nationkey
              and n_name = 'GERMANY'
      group by
              ps_partkey having
                      sum(ps_supplycost * ps_availqty) > (
                              select
                                      sum(ps_supplycost * ps_availqty) * 0.0001
                              from
                                      partsupp,
                                      supplier,
                                      nation
                              where
                                      ps_suppkey = s_suppkey
                                      and s_nationkey = n_nationkey
                                      and n_name = 'GERMANY'
                      )
      order by
              "value" desc
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 149
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   ..alue\" desc"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "ps_partkey..as \"value\""
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "ps_partkey"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "ps_partkey"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "ps_partkey"
                            children:
                              - type: NAME
                                text: "ps_partkey"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(ps_sup..as \"value\""
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(ps_sup.._availqty)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            children:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "ps_supplyc..s_availqty"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "ps_supplyc..s_availqty"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "ps_supplyc..s_availqty"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: MULTIPLY
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "ps_supplyc..s_availqty"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "ps_supplycost"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "ps_supplycost"
                                                children:
                                                  - type: NAME
                                                    text: "ps_supplycost"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "ps_availqty"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "ps_availqty"
                                                children:
                                                  - type: NAME
                                                    text: "ps_availqty"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "\"value\""
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n     ..    nation"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "partsupp"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "partsupp"
                        children:
                          - type: NAME
                            text: "partsupp"
                  - type: OBJECT_SQL_TABLEREF
                    text: "supplier"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "supplier"
                        children:
                          - type: NAME
                            text: "supplier"
                  - type: OBJECT_SQL_TABLEREF
                    text: "nation"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "nation"
                        children:
                          - type: NAME
                            text: "nation"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "ps_suppkey.. 'GERMANY'"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "ps_suppkey.. 'GERMANY'"
                    children:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "ps_suppkey.. s_suppkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "ps_suppkey.. s_suppkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "ps_suppkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "ps_suppkey"
                                    children:
                                      - type: NAME
                                        text: "ps_suppkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_suppkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_suppkey"
                                    children:
                                      - type: NAME
                                        text: "s_suppkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "s_nationke.._nationkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "s_nationke.._nationkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_nationkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_nationkey"
                                    children:
                                      - type: NAME
                                        text: "s_nationkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "n_nationkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "n_nationkey"
                                    children:
                                      - type: NAME
                                        text: "n_nationkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "n_name = 'GERMANY'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "n_name = 'GERMANY'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "n_name"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "n_name"
                                    children:
                                      - type: NAME
                                        text: "n_name"
                              - type: LITERAL_STRING
                                text: "'GERMANY'"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by\n ..ps_partkey"
                children:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "ps_partkey"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "ps_partkey"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "ps_partkey"
                            children:
                              - type: NAME
                                text: "ps_partkey"
              - key: SQL_SELECT_HAVING
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "sum(ps_sup..         )"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: GREATER_THAN
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "sum(ps_sup..         )"
                    children:
                      - type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(ps_sup.._availqty)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            children:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "ps_supplyc..s_availqty"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "ps_supplyc..s_availqty"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "ps_supplyc..s_availqty"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: MULTIPLY
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "ps_supplyc..s_availqty"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "ps_supplycost"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "ps_supplycost"
                                                children:
                                                  - type: NAME
                                                    text: "ps_supplycost"
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "ps_availqty"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "ps_availqty"
                                                children:
                                                  - type: NAME
                                                    text: "ps_availqty"
                      - type: OBJECT_SQL_SELECT_EXPRESSION
                        text: "(\n        ..         )"
                        children:
                          - key: SQL_SELECT_EXPRESSION_STATEMENT
                            type: OBJECT_SQL_SELECT
                            text: "(\n        ..         )"
                            children:
                              - key: SQL_SELECT_TARGETS
                                type: ARRAY
                                text: "sum(ps_sup..) * 0.0001"
                                children:
                                  - type: OBJECT_SQL_RESULT_TARGET
                                    text: "sum(ps_sup..) * 0.0001"
                                    children:
                                      - key: SQL_RESULT_TARGET_VALUE
                                        type: OBJECT_SQL_NARY_EXPRESSION
                                        text: "sum(ps_sup..) * 0.0001"
                                        children:
                                          - key: SQL_EXPRESSION_OPERATOR
                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                            value: MULTIPLY
                                          - key: SQL_EXPRESSION_ARGS
                                            type: ARRAY
                                            text: "sum(ps_sup..) * 0.0001"
                                            children:
                                              - type: OBJECT_SQL_FUNCTION_EXPRESSION
                                                text: "sum(ps_sup.._availqty)"
                                                children:
                                                  - key: SQL_FUNCTION_NAME
                                                    type: ARRAY
                                                    text: "sum"
                                                    children:
                                                      - type: NAME
                                                        text: "sum"
                                                  - key: SQL_FUNCTION_ARGUMENTS
                                                    type: ARRAY
                                                    text: "ps_supplyc..s_availqty"
                                                    children:
                                                      - type: OBJECT_SQL_FUNCTION_ARG
                                                        text: "ps_supplyc..s_availqty"
                                                        children:
                                                          - key: SQL_FUNCTION_ARG_VALUE
                                                            type: OBJECT_SQL_NARY_EXPRESSION
                                                            text: "ps_supplyc..s_availqty"
                                                            children:
                                                              - key: SQL_EXPRESSION_OPERATOR
                                                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                                                value: MULTIPLY
                                                              - key: SQL_EXPRESSION_ARGS
                                                                type: ARRAY
                                                                text: "ps_supplyc..s_availqty"
                                                                children:
                                                                  - type: OBJECT_SQL_COLUMN_REF
                                                                    text: "ps_supplycost"
                                                                    children:
                                                                      - key: SQL_COLUMN_REF_PATH
                                                                        type: ARRAY
                                                                        text: "ps_supplycost"
                                                                        children:
                                                                          - type: NAME
                                                                            text: "ps_supplycost"
                                                                  - type: OBJECT_SQL_COLUMN_REF
                                                                    text: "ps_availqty"
                                                                    children:
                                                                      - key: SQL_COLUMN_REF_PATH
                                                                        type: ARRAY
                                                                        text: "ps_availqty"
                                                                        children:
                                                                          - type: NAME
                                                                            text: "ps_availqty"
                                              - type: LITERAL_FLOAT
                                                text: "0.0001"
                              - key: SQL_SELECT_FROM
                                type: ARRAY
                                text: "from\n     ..    nation"
                                children:
                                  - type: OBJECT_SQL_TABLEREF
                                    text: "partsupp"
                                    children:
                                      - key: SQL_TABLEREF_NAME
                                        type: ARRAY
                                        text: "partsupp"
                                        children:
                                          - type: NAME
                                            text: "partsupp"
                                  - type: OBJECT_SQL_TABLEREF
                                    text: "supplier"
                                    children:
                                      - key: SQL_TABLEREF_NAME
                                        type: ARRAY
                                        text: "supplier"
                                        children:
                                          - type: NAME
                                            text: "supplier"
                                  - type: OBJECT_SQL_TABLEREF
                                    text: "nation"
                                    children:
                                      - key: SQL_TABLEREF_NAME
                                        type: ARRAY
                                        text: "nation"
                                        children:
                                          - type: NAME
                                            text: "nation"
                              - key: SQL_SELECT_WHERE
                                type: OBJECT_SQL_NARY_EXPRESSION
                                text: "ps_suppkey.. 'GERMANY'"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: AND
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "ps_suppkey.. 'GERMANY'"
                                    children:
                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                        text: "ps_suppkey.. s_suppkey"
                                        children:
                                          - key: SQL_EXPRESSION_OPERATOR
                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                            value: EQUAL
                                          - key: SQL_EXPRESSION_ARGS
                                            type: ARRAY
                                            text: "ps_suppkey.. s_suppkey"
                                            children:
                                              - type: OBJECT_SQL_COLUMN_REF
                                                text: "ps_suppkey"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "ps_suppkey"
                                                    children:
                                                      - type: NAME
                                                        text: "ps_suppkey"
                                              - type: OBJECT_SQL_COLUMN_REF
                                                text: "s_suppkey"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "s_suppkey"
                                                    children:
                                                      - type: NAME
                                                        text: "s_suppkey"
                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                        text: "s_nationke.._nationkey"
                                        children:
                                          - key: SQL_EXPRESSION_OPERATOR
                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                            value: EQUAL
                                          - key: SQL_EXPRESSION_ARGS
                                            type: ARRAY
                                            text: "s_nationke.._nationkey"
                                            children:
                                              - type: OBJECT_SQL_COLUMN_REF
                                                text: "s_nationkey"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "s_nationkey"
                                                    children:
                                                      - type: NAME
                                                        text: "s_nationkey"
                                              - type: OBJECT_SQL_COLUMN_REF
                                                text: "n_nationkey"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "n_nationkey"
                                                    children:
                                                      - type: NAME
                                                        text: "n_nationkey"
                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                        text: "n_name = 'GERMANY'"
                                        children:
                                          - key: SQL_EXPRESSION_OPERATOR
                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                            value: EQUAL
                                          - key: SQL_EXPRESSION_ARGS
                                            type: ARRAY
                                            text: "n_name = 'GERMANY'"
                                            children:
                                              - type: OBJECT_SQL_COLUMN_REF
                                                text: "n_name"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "n_name"
                                                    children:
                                                      - type: NAME
                                                        text: "n_name"
                                              - type: LITERAL_STRING
                                                text: "'GERMANY'"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by\n ..alue\" desc"
                children:
                  - type: OBJECT_SQL_ORDER
                    text: "\"value\" desc"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "\"value\""
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "\"value\""
                            children:
                              - type: NAME
                                text: "\"value\""
                      - key: SQL_ORDER_DIRECTION
                        type: ENUM_SQL_ORDER_DIRECTION
                        value: DESCENDING
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [26,27]
        - text: [78,79]
        - text: [83,84]
        - text: [101,102]
        - text: [119,120]
        - text: [134,135]
        - text: [140,141]
        - text: [171,172]
        - text: [209,210]
        - text: [240,241]
        - text: [249,250]
        - text: [275,276]
        - text: [328,329]
        - text: [359,360]
        - text: [433,434]
        - text: [462,463]
        - text: [504,505]
        - text: [546,547]
        - text: [585,586]
        - text: [615,616]
        - text: [670,671]
        - text: [732,733]
        - text: [787,788]
        - text: [805,806]
        - text: [814,815]
      comments: []

  - name: tpch_12
    input: |-
      select
              l_shipmode,
              sum(case
                      when o_orderpriority = '1-URGENT'
                              or o_orderpriority = '2-HIGH'
                              then 1
                      else 0
              end) as high_line_count,
              sum(case
                      when o_orderpriority <> '1-URGENT'
                              and o_orderpriority <> '2-HIGH'
                              then 1
                      else 0
              end) as low_line_count
      from
              orders,
              lineitem
      where
              o_orderkey = l_orderkey
              and l_shipmode in ('MAIL', 'SHIP')
              and l_commitdate < l_receiptdate
              and l_shipdate < l_commitdate
              and l_receiptdate >= date '1994-01-01'
              and l_receiptdate < date '1995-01-01'
      group by
              l_shipmode
      order by
              l_shipmode
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 141
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   ..l_shipmode"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "l_shipmode..line_count"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "l_shipmode"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "l_shipmode"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "l_shipmode"
                            children:
                              - type: NAME
                                text: "l_shipmode"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(case\n ..line_count"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(case\n ..      end)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            children:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "case\n     ..       end"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "case\n     ..       end"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_CASE
                                    text: "case\n     ..       end"
                                    children:
                                      - key: SQL_CASE_CLAUSES
                                        type: ARRAY
                                        text: "when o_ord..    then 1"
                                        children:
                                          - type: OBJECT_SQL_CASE_CLAUSE
                                            text: "when o_ord..    then 1"
                                            children:
                                              - key: SQL_CASE_CLAUSE_WHEN
                                                type: OBJECT_SQL_NARY_EXPRESSION
                                                text: "o_orderpri..= '2-HIGH'"
                                                children:
                                                  - key: SQL_EXPRESSION_OPERATOR
                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                    value: OR
                                                  - key: SQL_EXPRESSION_ARGS
                                                    type: ARRAY
                                                    text: "o_orderpri..= '2-HIGH'"
                                                    children:
                                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                                        text: "o_orderpri..'1-URGENT'"
                                                        children:
                                                          - key: SQL_EXPRESSION_OPERATOR
                                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                                            value: EQUAL
                                                          - key: SQL_EXPRESSION_ARGS
                                                            type: ARRAY
                                                            text: "o_orderpri..'1-URGENT'"
                                                            children:
                                                              - type: OBJECT_SQL_COLUMN_REF
                                                                text: "o_orderpriority"
                                                                children:
                                                                  - key: SQL_COLUMN_REF_PATH
                                                                    type: ARRAY
                                                                    text: "o_orderpriority"
                                                                    children:
                                                                      - type: NAME
                                                                        text: "o_orderpriority"
                                                              - type: LITERAL_STRING
                                                                text: "'1-URGENT'"
                                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                                        text: "o_orderpri..= '2-HIGH'"
                                                        children:
                                                          - key: SQL_EXPRESSION_OPERATOR
                                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                                            value: EQUAL
                                                          - key: SQL_EXPRESSION_ARGS
                                                            type: ARRAY
                                                            text: "o_orderpri..= '2-HIGH'"
                                                            children:
                                                              - type: OBJECT_SQL_COLUMN_REF
                                                                text: "o_orderpriority"
                                                                children:
                                                                  - key: SQL_COLUMN_REF_PATH
                                                                    type: ARRAY
                                                                    text: "o_orderpriority"
                                                                    children:
                                                                      - type: NAME
                                                                        text: "o_orderpriority"
                                                              - type: LITERAL_STRING
                                                                text: "'2-HIGH'"
                                              - key: SQL_CASE_CLAUSE_THEN
                                                type: LITERAL_INTEGER
                                                text: "1"
                                      - key: SQL_CASE_DEFAULT
                                        type: LITERAL_INTEGER
                                        text: "0"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "high_line_count"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(case\n ..line_count"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(case\n ..      end)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            children:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "case\n     ..       end"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "case\n     ..       end"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_CASE
                                    text: "case\n     ..       end"
                                    children:
                                      - key: SQL_CASE_CLAUSES
                                        type: ARRAY
                                        text: "when o_ord..    then 1"
                                        children:
                                          - type: OBJECT_SQL_CASE_CLAUSE
                                            text: "when o_ord..    then 1"
                                            children:
                                              - key: SQL_CASE_CLAUSE_WHEN
                                                type: OBJECT_SQL_NARY_EXPRESSION
                                                text: "o_orderpri..> '2-HIGH'"
                                                children:
                                                  - key: SQL_EXPRESSION_OPERATOR
                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                    value: AND
                                                  - key: SQL_EXPRESSION_ARGS
                                                    type: ARRAY
                                                    text: "o_orderpri..> '2-HIGH'"
                                                    children:
                                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                                        text: "o_orderpri..'1-URGENT'"
                                                        children:
                                                          - key: SQL_EXPRESSION_OPERATOR
                                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                                            value: NOT_EQUAL
                                                          - key: SQL_EXPRESSION_ARGS
                                                            type: ARRAY
                                                            text: "o_orderpri..'1-URGENT'"
                                                            children:
                                                              - type: OBJECT_SQL_COLUMN_REF
                                                                text: "o_orderpriority"
                                                                children:
                                                                  - key: SQL_COLUMN_REF_PATH
                                                                    type: ARRAY
                                                                    text: "o_orderpriority"
                                                                    children:
                                                                      - type: NAME
                                                                        text: "o_orderpriority"
                                                              - type: LITERAL_STRING
                                                                text: "'1-URGENT'"
                                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                                        text: "o_orderpri..> '2-HIGH'"
                                                        children:
                                                          - key: SQL_EXPRESSION_OPERATOR
                                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                                            value: NOT_EQUAL
                                                          - key: SQL_EXPRESSION_ARGS
                                                            type: ARRAY
                                                            text: "o_orderpri..> '2-HIGH'"
                                                            children:
                                                              - type: OBJECT_SQL_COLUMN_REF
                                                                text: "o_orderpriority"
                                                                children:
                                                                  - key: SQL_COLUMN_REF_PATH
                                                                    type: ARRAY
                                                                    text: "o_orderpriority"
                                                                    children:
                                                                      - type: NAME
                                                                        text: "o_orderpriority"
                                                              - type: LITERAL_STRING
                                                                text: "'2-HIGH'"
                                              - key: SQL_CASE_CLAUSE_THEN
                                                type: LITERAL_INTEGER
                                                text: "1"
                                      - key: SQL_CASE_DEFAULT
                                        type: LITERAL_INTEGER
                                        text: "0"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "low_line_count"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n     ..  lineitem"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "orders"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "orders"
                        children:
                          - type: NAME
                            text: "orders"
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineitem"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineitem"
                        children:
                          - type: NAME
                            text: "lineitem"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "o_orderkey..995-01-01'"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "o_orderkey..995-01-01'"
                    children:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "o_orderkey..l_orderkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "o_orderkey..l_orderkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "o_orderkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "o_orderkey"
                                    children:
                                      - type: NAME
                                        text: "o_orderkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_orderkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_orderkey"
                                    children:
                                      - type: NAME
                                        text: "l_orderkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l_shipmode..', 'SHIP')"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: IN
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l_shipmode..', 'SHIP')"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_shipmode"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_shipmode"
                                    children:
                                      - type: NAME
                                        text: "l_shipmode"
                              - type: ARRAY
                                text: "('MAIL', 'SHIP')"
                                children:
                                  - type: LITERAL_STRING
                                    text: "'MAIL'"
                                  - type: LITERAL_STRING
                                    text: "'SHIP'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l_commitda..eceiptdate"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: LESS_THAN
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l_commitda..eceiptdate"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_commitdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_commitdate"
                                    children:
                                      - type: NAME
                                        text: "l_commitdate"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_receiptdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_receiptdate"
                                    children:
                                      - type: NAME
                                        text: "l_receiptdate"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l_shipdate..commitdate"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: LESS_THAN
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l_shipdate..commitdate"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_shipdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_shipdate"
                                    children:
                                      - type: NAME
                                        text: "l_shipdate"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_commitdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_commitdate"
                                    children:
                                      - type: NAME
                                        text: "l_commitdate"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l_receiptd..994-01-01'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: GREATER_EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l_receiptd..994-01-01'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_receiptdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_receiptdate"
                                    children:
                                      - type: NAME
                                        text: "l_receiptdate"
                              - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                text: "date '1994-01-01'"
                                children:
                                  - key: SQL_CONST_CAST_FUNC_NAME
                                    type: ARRAY
                                    text: "date"
                                    children:
                                      - type: NAME
                                        text: "date"
                                  - key: SQL_CONST_CAST_VALUE
                                    type: LITERAL_STRING
                                    text: "'1994-01-01'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l_receiptd..995-01-01'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: LESS_THAN
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l_receiptd..995-01-01'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_receiptdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_receiptdate"
                                    children:
                                      - type: NAME
                                        text: "l_receiptdate"
                              - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                text: "date '1995-01-01'"
                                children:
                                  - key: SQL_CONST_CAST_FUNC_NAME
                                    type: ARRAY
                                    text: "date"
                                    children:
                                      - type: NAME
                                        text: "date"
                                  - key: SQL_CONST_CAST_VALUE
                                    type: LITERAL_STRING
                                    text: "'1995-01-01'"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by\n ..l_shipmode"
                children:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "l_shipmode"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "l_shipmode"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "l_shipmode"
                            children:
                              - type: NAME
                                text: "l_shipmode"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by\n ..l_shipmode"
                children:
                  - type: OBJECT_SQL_ORDER
                    text: "l_shipmode"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "l_shipmode"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "l_shipmode"
                            children:
                              - type: NAME
                                text: "l_shipmode"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [26,27]
        - text: [43,44]
        - text: [93,94]
        - text: [147,148]
        - text: [178,179]
        - text: [201,202]
        - text: [234,235]
        - text: [251,252]
        - text: [302,303]
        - text: [358,359]
        - text: [389,390]
        - text: [412,413]
        - text: [443,444]
        - text: [448,449]
        - text: [464,465]
        - text: [481,482]
        - text: [487,488]
        - text: [519,520]
        - text: [562,563]
        - text: [603,604]
        - text: [641,642]
        - text: [688,689]
        - text: [734,735]
        - text: [743,744]
        - text: [762,763]
        - text: [771,772]
      comments: []

  - name: tpch_13
    input: |-
      select
              c_count,
              count(*) as custdist
      from
              (
                      select
                              c_custkey,
                              count(o_orderkey) c_count
                      from
                              customer left outer join orders on
                                      c_custkey = o_custkey
                                      and o_comment not like '%special%requests%'
                      group by
                              c_custkey
              ) as c_orders
      group by
              c_count
      order by
              custdist desc,
              c_count desc
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 84
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   ..count desc"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "c_count,\n ..s custdist"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "c_count"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_count"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_count"
                            children:
                              - type: NAME
                                text: "c_count"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "count(*) a..s custdist"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "count(*)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "count"
                            children:
                              - type: NAME
                                text: "count"
                          - key: SQL_FUNCTION_ARGUMENTS_STAR
                            type: BOOL
                            value: 1
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "custdist"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n     ..s c_orders"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "(\n        ..s c_orders"
                    children:
                      - key: SQL_TABLEREF_ALIAS
                        type: NAME
                        text: "c_orders"
                      - key: SQL_TABLEREF_TABLE
                        type: OBJECT_SQL_SELECT
                        text: "(\n        ..\n        )"
                        children:
                          - key: SQL_SELECT_TARGETS
                            type: ARRAY
                            text: "c_custkey,..y) c_count"
                            children:
                              - type: OBJECT_SQL_RESULT_TARGET
                                text: "c_custkey"
                                children:
                                  - key: SQL_RESULT_TARGET_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "c_custkey"
                                    children:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "c_custkey"
                                        children:
                                          - type: NAME
                                            text: "c_custkey"
                              - type: OBJECT_SQL_RESULT_TARGET
                                text: "count(o_or..y) c_count"
                                children:
                                  - key: SQL_RESULT_TARGET_VALUE
                                    type: OBJECT_SQL_FUNCTION_EXPRESSION
                                    text: "count(o_orderkey)"
                                    children:
                                      - key: SQL_FUNCTION_NAME
                                        type: ARRAY
                                        text: "count"
                                        children:
                                          - type: NAME
                                            text: "count"
                                      - key: SQL_FUNCTION_ARGUMENTS
                                        type: ARRAY
                                        text: "o_orderkey"
                                        children:
                                          - type: OBJECT_SQL_FUNCTION_ARG
                                            text: "o_orderkey"
                                            children:
                                              - key: SQL_FUNCTION_ARG_VALUE
                                                type: OBJECT_SQL_COLUMN_REF
                                                text: "o_orderkey"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "o_orderkey"
                                                    children:
                                                      - type: NAME
                                                        text: "o_orderkey"
                                  - key: SQL_RESULT_TARGET_NAME
                                    type: NAME
                                    text: "c_count"
                          - key: SQL_SELECT_FROM
                            type: ARRAY
                            text: "from\n     ..requests%'"
                            children:
                              - type: OBJECT_SQL_TABLEREF
                                text: "customer l..requests%'"
                                children:
                                  - key: SQL_TABLEREF_TABLE
                                    type: OBJECT_SQL_JOINED_TABLE
                                    text: "customer l..requests%'"
                                    children:
                                      - key: SQL_JOIN_ON
                                        type: OBJECT_SQL_NARY_EXPRESSION
                                        text: "c_custkey ..requests%'"
                                        children:
                                          - key: SQL_EXPRESSION_OPERATOR
                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                            value: AND
                                          - key: SQL_EXPRESSION_ARGS
                                            type: ARRAY
                                            text: "c_custkey ..requests%'"
                                            children:
                                              - type: OBJECT_SQL_NARY_EXPRESSION
                                                text: "c_custkey .. o_custkey"
                                                children:
                                                  - key: SQL_EXPRESSION_OPERATOR
                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                    value: EQUAL
                                                  - key: SQL_EXPRESSION_ARGS
                                                    type: ARRAY
                                                    text: "c_custkey .. o_custkey"
                                                    children:
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "c_custkey"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "c_custkey"
                                                            children:
                                                              - type: NAME
                                                                text: "c_custkey"
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "o_custkey"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "o_custkey"
                                                            children:
                                                              - type: NAME
                                                                text: "o_custkey"
                                              - type: OBJECT_SQL_NARY_EXPRESSION
                                                text: "o_comment ..requests%'"
                                                children:
                                                  - key: SQL_EXPRESSION_OPERATOR
                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                    value: NOT_LIKE
                                                  - key: SQL_EXPRESSION_ARGS
                                                    type: ARRAY
                                                    text: "o_comment ..requests%'"
                                                    children:
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "o_comment"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "o_comment"
                                                            children:
                                                              - type: NAME
                                                                text: "o_comment"
                                                      - type: LITERAL_STRING
                                                        text: "'%special%..requests%'"
                                      - key: SQL_JOIN_TYPE
                                        type: ENUM_SQL_JOIN_TYPE
                                        value: OUTER_LEFT
                                      - key: SQL_JOIN_INPUT
                                        type: ARRAY
                                        text: "customer l..requests%'"
                                        children:
                                          - type: OBJECT_SQL_TABLEREF
                                            text: "customer"
                                            children:
                                              - key: SQL_TABLEREF_NAME
                                                type: ARRAY
                                                text: "customer"
                                                children:
                                                  - type: NAME
                                                    text: "customer"
                                          - type: OBJECT_SQL_TABLEREF
                                            text: "orders"
                                            children:
                                              - key: SQL_TABLEREF_NAME
                                                type: ARRAY
                                                text: "orders"
                                                children:
                                                  - type: NAME
                                                    text: "orders"
                          - key: SQL_SELECT_GROUPS
                            type: ARRAY
                            text: "group by\n .. c_custkey"
                            children:
                              - type: OBJECT_SQL_GROUP_BY_ITEM
                                text: "c_custkey"
                                children:
                                  - key: SQL_GROUP_BY_ITEM_TYPE
                                    type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                                    value: EXPRESSION
                                  - key: SQL_GROUP_BY_ITEM_ARG
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "c_custkey"
                                    children:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "c_custkey"
                                        children:
                                          - type: NAME
                                            text: "c_custkey"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by\n ..   c_count"
                children:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "c_count"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_count"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_count"
                            children:
                              - type: NAME
                                text: "c_count"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by\n ..count desc"
                children:
                  - type: OBJECT_SQL_ORDER
                    text: "custdist desc"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "custdist"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "custdist"
                            children:
                              - type: NAME
                                text: "custdist"
                      - key: SQL_ORDER_DIRECTION
                        type: ENUM_SQL_ORDER_DIRECTION
                        value: DESCENDING
                  - type: OBJECT_SQL_ORDER
                    text: "c_count desc"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_count"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_count"
                            children:
                              - type: NAME
                                text: "c_count"
                      - key: SQL_ORDER_DIRECTION
                        type: ENUM_SQL_ORDER_DIRECTION
                        value: DESCENDING
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [23,24]
        - text: [52,53]
        - text: [57,58]
        - text: [67,68]
        - text: [90,91]
        - text: [125,126]
        - text: [175,176]
        - text: [196,197]
        - text: [255,256]
        - text: [309,310]
        - text: [385,386]
        - text: [410,411]
        - text: [444,445]
        - text: [466,467]
        - text: [475,476]
        - text: [491,492]
        - text: [500,501]
        - text: [523,524]
      comments: []

  - name: tpch_14
    input: |-
      select
              100.00 * sum(case
                      when p_type like 'PROMO%'
                              then l_extendedprice * (1 - l_discount)
                      else 0
              end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
      from
              lineitem,
              part
      where
              l_partkey = p_partkey
              and l_shipdate >= date '1995-09-01'
              and l_shipdate < date '1995-10-01'
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 97
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   ..995-10-01'"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "100.00 * s..mo_revenue"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "100.00 * s..mo_revenue"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_NARY_EXPRESSION
                        text: "100.00 * s..discount))"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: DIVIDE
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "100.00 * s..discount))"
                            children:
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "100.00 * s..      end)"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: MULTIPLY
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "100.00 * s..      end)"
                                    children:
                                      - type: LITERAL_FLOAT
                                        text: "100.00"
                                      - type: OBJECT_SQL_FUNCTION_EXPRESSION
                                        text: "sum(case\n ..      end)"
                                        children:
                                          - key: SQL_FUNCTION_NAME
                                            type: ARRAY
                                            text: "sum"
                                            children:
                                              - type: NAME
                                                text: "sum"
                                          - key: SQL_FUNCTION_ARGUMENTS
                                            type: ARRAY
                                            text: "case\n     ..       end"
                                            children:
                                              - type: OBJECT_SQL_FUNCTION_ARG
                                                text: "case\n     ..       end"
                                                children:
                                                  - key: SQL_FUNCTION_ARG_VALUE
                                                    type: OBJECT_SQL_CASE
                                                    text: "case\n     ..       end"
                                                    children:
                                                      - key: SQL_CASE_CLAUSES
                                                        type: ARRAY
                                                        text: "when p_typ.._discount)"
                                                        children:
                                                          - type: OBJECT_SQL_CASE_CLAUSE
                                                            text: "when p_typ.._discount)"
                                                            children:
                                                              - key: SQL_CASE_CLAUSE_WHEN
                                                                type: OBJECT_SQL_NARY_EXPRESSION
                                                                text: "p_type lik..e 'PROMO%'"
                                                                children:
                                                                  - key: SQL_EXPRESSION_OPERATOR
                                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                                    value: LIKE
                                                                  - key: SQL_EXPRESSION_ARGS
                                                                    type: ARRAY
                                                                    text: "p_type lik..e 'PROMO%'"
                                                                    children:
                                                                      - type: OBJECT_SQL_COLUMN_REF
                                                                        text: "p_type"
                                                                        children:
                                                                          - key: SQL_COLUMN_REF_PATH
                                                                            type: ARRAY
                                                                            text: "p_type"
                                                                            children:
                                                                              - type: NAME
                                                                                text: "p_type"
                                                                      - type: LITERAL_STRING
                                                                        text: "'PROMO%'"
                                                              - key: SQL_CASE_CLAUSE_THEN
                                                                type: OBJECT_SQL_NARY_EXPRESSION
                                                                text: "l_extended.._discount)"
                                                                children:
                                                                  - key: SQL_EXPRESSION_OPERATOR
                                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                                    value: MULTIPLY
                                                                  - key: SQL_EXPRESSION_ARGS
                                                                    type: ARRAY
                                                                    text: "l_extended.._discount)"
                                                                    children:
                                                                      - type: OBJECT_SQL_COLUMN_REF
                                                                        text: "l_extendedprice"
                                                                        children:
                                                                          - key: SQL_COLUMN_REF_PATH
                                                                            type: ARRAY
                                                                            text: "l_extendedprice"
                                                                            children:
                                                                              - type: NAME
                                                                                text: "l_extendedprice"
                                                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                                                        text: "1 - l_discount"
                                                                        children:
                                                                          - key: SQL_EXPRESSION_OPERATOR
                                                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                                                            value: MINUS
                                                                          - key: SQL_EXPRESSION_ARGS
                                                                            type: ARRAY
                                                                            text: "1 - l_discount"
                                                                            children:
                                                                              - type: LITERAL_INTEGER
                                                                                text: "1"
                                                                              - type: OBJECT_SQL_COLUMN_REF
                                                                                text: "l_discount"
                                                                                children:
                                                                                  - key: SQL_COLUMN_REF_PATH
                                                                                    type: ARRAY
                                                                                    text: "l_discount"
                                                                                    children:
                                                                                      - type: NAME
                                                                                        text: "l_discount"
                                                      - key: SQL_CASE_DEFAULT
                                                        type: LITERAL_INTEGER
                                                        text: "0"
                              - type: OBJECT_SQL_FUNCTION_EXPRESSION
                                text: "sum(l_exte..discount))"
                                children:
                                  - key: SQL_FUNCTION_NAME
                                    type: ARRAY
                                    text: "sum"
                                    children:
                                      - type: NAME
                                        text: "sum"
                                  - key: SQL_FUNCTION_ARGUMENTS
                                    type: ARRAY
                                    text: "l_extended.._discount)"
                                    children:
                                      - type: OBJECT_SQL_FUNCTION_ARG
                                        text: "l_extended.._discount)"
                                        children:
                                          - key: SQL_FUNCTION_ARG_VALUE
                                            type: OBJECT_SQL_NARY_EXPRESSION
                                            text: "l_extended.._discount)"
                                            children:
                                              - key: SQL_EXPRESSION_OPERATOR
                                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                                value: MULTIPLY
                                              - key: SQL_EXPRESSION_ARGS
                                                type: ARRAY
                                                text: "l_extended.._discount)"
                                                children:
                                                  - type: OBJECT_SQL_COLUMN_REF
                                                    text: "l_extendedprice"
                                                    children:
                                                      - key: SQL_COLUMN_REF_PATH
                                                        type: ARRAY
                                                        text: "l_extendedprice"
                                                        children:
                                                          - type: NAME
                                                            text: "l_extendedprice"
                                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                                    text: "1 - l_discount"
                                                    children:
                                                      - key: SQL_EXPRESSION_OPERATOR
                                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                                        value: MINUS
                                                      - key: SQL_EXPRESSION_ARGS
                                                        type: ARRAY
                                                        text: "1 - l_discount"
                                                        children:
                                                          - type: LITERAL_INTEGER
                                                            text: "1"
                                                          - type: OBJECT_SQL_COLUMN_REF
                                                            text: "l_discount"
                                                            children:
                                                              - key: SQL_COLUMN_REF_PATH
                                                                type: ARRAY
                                                                text: "l_discount"
                                                                children:
                                                                  - type: NAME
                                                                    text: "l_discount"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "promo_revenue"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n     ..      part"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineitem"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineitem"
                        children:
                          - type: NAME
                            text: "lineitem"
                  - type: OBJECT_SQL_TABLEREF
                    text: "part"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "part"
                        children:
                          - type: NAME
                            text: "part"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "l_partkey ..995-10-01'"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "l_partkey ..995-10-01'"
                    children:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l_partkey .. p_partkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l_partkey .. p_partkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_partkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_partkey"
                                    children:
                                      - type: NAME
                                        text: "l_partkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_partkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_partkey"
                                    children:
                                      - type: NAME
                                        text: "p_partkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l_shipdate..995-09-01'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: GREATER_EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l_shipdate..995-09-01'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_shipdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_shipdate"
                                    children:
                                      - type: NAME
                                        text: "l_shipdate"
                              - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                text: "date '1995-09-01'"
                                children:
                                  - key: SQL_CONST_CAST_FUNC_NAME
                                    type: ARRAY
                                    text: "date"
                                    children:
                                      - type: NAME
                                        text: "date"
                                  - key: SQL_CONST_CAST_VALUE
                                    type: LITERAL_STRING
                                    text: "'1995-09-01'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l_shipdate..995-10-01'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: LESS_THAN
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l_shipdate..995-10-01'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_shipdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_shipdate"
                                    children:
                                      - type: NAME
                                        text: "l_shipdate"
                              - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                text: "date '1995-10-01'"
                                children:
                                  - key: SQL_CONST_CAST_FUNC_NAME
                                    type: ARRAY
                                    text: "date"
                                    children:
                                      - type: NAME
                                        text: "date"
                                  - key: SQL_CONST_CAST_VALUE
                                    type: LITERAL_STRING
                                    text: "'1995-10-01'"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [32,33]
        - text: [74,75]
        - text: [138,139]
        - text: [161,162]
        - text: [233,234]
        - text: [238,239]
        - text: [256,257]
        - text: [269,270]
        - text: [275,276]
        - text: [305,306]
        - text: [349,350]
      comments: []

  - name: tpch_15
    input: |-
      with revenue as (
      	select
      		l_suppkey as supplier_no,
      		sum(l_extendedprice * (1 - l_discount)) as total_revenue
      	from
      		lineitem
      	where
      		l_shipdate >= date '1996-01-01'
      		and l_shipdate < date '1996-04-01'
      	group by
      		l_suppkey)
      select
      	s_suppkey,
      	s_name,
      	s_address,
      	s_phone,
      	total_revenue
      from
      	supplier,
      	revenue
      where
      	s_suppkey = supplier_no
      	and total_revenue = (
      		select
      			max(total_revenue)
      		from
      			revenue
      	)
      order by
      	s_suppkey
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 131
          ast:
            type: OBJECT_SQL_SELECT
            text: "with reven..	s_suppkey"
            children:
              - key: SQL_SELECT_WITH_CTES
                type: ARRAY
                text: "revenue as..l_suppkey)"
                children:
                  - type: OBJECT_SQL_CTE
                    text: "revenue as..l_suppkey)"
                    children:
                      - key: SQL_CTE_NAME
                        type: NAME
                        text: "revenue"
                      - key: SQL_CTE_STATEMENT
                        type: OBJECT_SQL_SELECT
                        text: "select\n		l..	l_suppkey"
                        children:
                          - key: SQL_SELECT_TARGETS
                            type: ARRAY
                            text: "l_suppkey ..al_revenue"
                            children:
                              - type: OBJECT_SQL_RESULT_TARGET
                                text: "l_suppkey ..upplier_no"
                                children:
                                  - key: SQL_RESULT_TARGET_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "l_suppkey"
                                    children:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "l_suppkey"
                                        children:
                                          - type: NAME
                                            text: "l_suppkey"
                                  - key: SQL_RESULT_TARGET_NAME
                                    type: NAME
                                    text: "supplier_no"
                              - type: OBJECT_SQL_RESULT_TARGET
                                text: "sum(l_exte..al_revenue"
                                children:
                                  - key: SQL_RESULT_TARGET_VALUE
                                    type: OBJECT_SQL_FUNCTION_EXPRESSION
                                    text: "sum(l_exte..discount))"
                                    children:
                                      - key: SQL_FUNCTION_NAME
                                        type: ARRAY
                                        text: "sum"
                                        children:
                                          - type: NAME
                                            text: "sum"
                                      - key: SQL_FUNCTION_ARGUMENTS
                                        type: ARRAY
                                        text: "l_extended.._discount)"
                                        children:
                                          - type: OBJECT_SQL_FUNCTION_ARG
                                            text: "l_extended.._discount)"
                                            children:
                                              - key: SQL_FUNCTION_ARG_VALUE
                                                type: OBJECT_SQL_NARY_EXPRESSION
                                                text: "l_extended.._discount)"
                                                children:
                                                  - key: SQL_EXPRESSION_OPERATOR
                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                    value: MULTIPLY
                                                  - key: SQL_EXPRESSION_ARGS
                                                    type: ARRAY
                                                    text: "l_extended.._discount)"
                                                    children:
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "l_extendedprice"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "l_extendedprice"
                                                            children:
                                                              - type: NAME
                                                                text: "l_extendedprice"
                                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                                        text: "1 - l_discount"
                                                        children:
                                                          - key: SQL_EXPRESSION_OPERATOR
                                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                                            value: MINUS
                                                          - key: SQL_EXPRESSION_ARGS
                                                            type: ARRAY
                                                            text: "1 - l_discount"
                                                            children:
                                                              - type: LITERAL_INTEGER
                                                                text: "1"
                                                              - type: OBJECT_SQL_COLUMN_REF
                                                                text: "l_discount"
                                                                children:
                                                                  - key: SQL_COLUMN_REF_PATH
                                                                    type: ARRAY
                                                                    text: "l_discount"
                                                                    children:
                                                                      - type: NAME
                                                                        text: "l_discount"
                                  - key: SQL_RESULT_TARGET_NAME
                                    type: NAME
                                    text: "total_revenue"
                          - key: SQL_SELECT_FROM
                            type: ARRAY
                            text: "from\n		lineitem"
                            children:
                              - type: OBJECT_SQL_TABLEREF
                                text: "lineitem"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "lineitem"
                                    children:
                                      - type: NAME
                                        text: "lineitem"
                          - key: SQL_SELECT_WHERE
                            type: OBJECT_SQL_NARY_EXPRESSION
                            text: "l_shipdate..6-04-01'\n	"
                            children:
                              - key: SQL_EXPRESSION_OPERATOR
                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                value: AND
                              - key: SQL_EXPRESSION_ARGS
                                type: ARRAY
                                text: "l_shipdate..6-04-01'\n	"
                                children:
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "l_shipdate..-01-01'\n		"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: GREATER_EQUAL
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "l_shipdate..-01-01'\n		"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_shipdate"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_shipdate"
                                                children:
                                                  - type: NAME
                                                    text: "l_shipdate"
                                          - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                            text: "date '1996..-01-01'\n		"
                                            children:
                                              - key: SQL_CONST_CAST_FUNC_NAME
                                                type: ARRAY
                                                text: "date"
                                                children:
                                                  - type: NAME
                                                    text: "date"
                                              - key: SQL_CONST_CAST_VALUE
                                                type: LITERAL_STRING
                                                text: "'1996-01-01'\n		"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "l_shipdate..6-04-01'\n	"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: LESS_THAN
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "l_shipdate..6-04-01'\n	"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_shipdate"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_shipdate"
                                                children:
                                                  - type: NAME
                                                    text: "l_shipdate"
                                          - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                            text: "date '1996-04-01'\n	"
                                            children:
                                              - key: SQL_CONST_CAST_FUNC_NAME
                                                type: ARRAY
                                                text: "date"
                                                children:
                                                  - type: NAME
                                                    text: "date"
                                              - key: SQL_CONST_CAST_VALUE
                                                type: LITERAL_STRING
                                                text: "'1996-04-01'\n	"
                          - key: SQL_SELECT_GROUPS
                            type: ARRAY
                            text: "group by\n	..	l_suppkey"
                            children:
                              - type: OBJECT_SQL_GROUP_BY_ITEM
                                text: "l_suppkey"
                                children:
                                  - key: SQL_GROUP_BY_ITEM_TYPE
                                    type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                                    value: EXPRESSION
                                  - key: SQL_GROUP_BY_ITEM_ARG
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "l_suppkey"
                                    children:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "l_suppkey"
                                        children:
                                          - type: NAME
                                            text: "l_suppkey"
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "s_suppkey,..al_revenue"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "s_suppkey"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_suppkey"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_suppkey"
                            children:
                              - type: NAME
                                text: "s_suppkey"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "s_name"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_name"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_name"
                            children:
                              - type: NAME
                                text: "s_name"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "s_address"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_address"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_address"
                            children:
                              - type: NAME
                                text: "s_address"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "s_phone"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_phone"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_phone"
                            children:
                              - type: NAME
                                text: "s_phone"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "total_revenue"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "total_revenue"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "total_revenue"
                            children:
                              - type: NAME
                                text: "total_revenue"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n	supp..,\n	revenue"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "supplier"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "supplier"
                        children:
                          - type: NAME
                            text: "supplier"
                  - type: OBJECT_SQL_TABLEREF
                    text: "revenue"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "revenue"
                        children:
                          - type: NAME
                            text: "revenue"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "s_suppkey ..revenue\n	)"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "s_suppkey ..revenue\n	)"
                    children:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "s_suppkey ..upplier_no"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "s_suppkey ..upplier_no"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_suppkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_suppkey"
                                    children:
                                      - type: NAME
                                        text: "s_suppkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "supplier_no"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "supplier_no"
                                    children:
                                      - type: NAME
                                        text: "supplier_no"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "total_reve..revenue\n	)"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "total_reve..revenue\n	)"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "total_revenue"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "total_revenue"
                                    children:
                                      - type: NAME
                                        text: "total_revenue"
                              - type: OBJECT_SQL_SELECT_EXPRESSION
                                text: "(\n		select..revenue\n	)"
                                children:
                                  - key: SQL_SELECT_EXPRESSION_STATEMENT
                                    type: OBJECT_SQL_SELECT
                                    text: "(\n		select..revenue\n	)"
                                    children:
                                      - key: SQL_SELECT_TARGETS
                                        type: ARRAY
                                        text: "max(total_revenue)"
                                        children:
                                          - type: OBJECT_SQL_RESULT_TARGET
                                            text: "max(total_revenue)"
                                            children:
                                              - key: SQL_RESULT_TARGET_VALUE
                                                type: OBJECT_SQL_FUNCTION_EXPRESSION
                                                text: "max(total_revenue)"
                                                children:
                                                  - key: SQL_FUNCTION_NAME
                                                    type: ARRAY
                                                    text: "max"
                                                    children:
                                                      - type: NAME
                                                        text: "max"
                                                  - key: SQL_FUNCTION_ARGUMENTS
                                                    type: ARRAY
                                                    text: "total_revenue"
                                                    children:
                                                      - type: OBJECT_SQL_FUNCTION_ARG
                                                        text: "total_revenue"
                                                        children:
                                                          - key: SQL_FUNCTION_ARG_VALUE
                                                            type: OBJECT_SQL_COLUMN_REF
                                                            text: "total_revenue"
                                                            children:
                                                              - key: SQL_COLUMN_REF_PATH
                                                                type: ARRAY
                                                                text: "total_revenue"
                                                                children:
                                                                  - type: NAME
                                                                    text: "total_revenue"
                                      - key: SQL_SELECT_FROM
                                        type: ARRAY
                                        text: "from\n			revenue"
                                        children:
                                          - type: OBJECT_SQL_TABLEREF
                                            text: "revenue"
                                            children:
                                              - key: SQL_TABLEREF_NAME
                                                type: ARRAY
                                                text: "revenue"
                                                children:
                                                  - type: NAME
                                                    text: "revenue"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by\n	s_suppkey"
                children:
                  - type: OBJECT_SQL_ORDER
                    text: "s_suppkey"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_suppkey"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_suppkey"
                            children:
                              - type: NAME
                                text: "s_suppkey"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [17,18]
        - text: [25,26]
        - text: [53,54]
        - text: [112,113]
        - text: [118,119]
        - text: [129,130]
        - text: [136,137]
        - text: [170,171]
        - text: [207,208]
        - text: [217,218]
        - text: [230,231]
        - text: [237,238]
        - text: [249,250]
        - text: [258,259]
        - text: [270,271]
        - text: [280,281]
        - text: [295,296]
        - text: [300,301]
        - text: [311,312]
        - text: [320,321]
        - text: [326,327]
        - text: [351,352]
        - text: [374,375]
        - text: [383,384]
        - text: [405,406]
        - text: [412,413]
        - text: [423,424]
        - text: [426,427]
        - text: [435,436]
      comments: []

  - name: tpch_16
    input: |-
      select
              p_brand,
              p_type,
              p_size,
              count(distinct ps_suppkey) as supplier_cnt
      from
              partsupp,
              part
      where
              p_partkey = ps_partkey
              and p_brand <> 'Brand#45'
              and p_type not like 'MEDIUM POLISHED%'
              and p_size in (49, 14, 23, 45, 19, 3, 36, 9)
              and ps_suppkey not in (
                      select
                              s_suppkey
                      from
                              supplier
                      where
                              s_comment like '%Customer%Complaints%'
              )
      group by
              p_brand,
              p_type,
              p_size
      order by
              supplier_cnt desc,
              p_brand,
              p_type,
              p_size
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 131
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   ..    p_size"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "p_brand,\n ..pplier_cnt"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "p_brand"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_brand"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_brand"
                            children:
                              - type: NAME
                                text: "p_brand"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "p_type"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_type"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_type"
                            children:
                              - type: NAME
                                text: "p_type"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "p_size"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_size"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_size"
                            children:
                              - type: NAME
                                text: "p_size"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "count(dist..pplier_cnt"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "count(dist..s_suppkey)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "count"
                            children:
                              - type: NAME
                                text: "count"
                          - key: SQL_FUNCTION_DISTINCT
                            type: BOOL
                            value: 1
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "ps_suppkey"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "ps_suppkey"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "ps_suppkey"
                                    children:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "ps_suppkey"
                                        children:
                                          - type: NAME
                                            text: "ps_suppkey"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "supplier_cnt"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n     ..      part"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "partsupp"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "partsupp"
                        children:
                          - type: NAME
                            text: "partsupp"
                  - type: OBJECT_SQL_TABLEREF
                    text: "part"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "part"
                        children:
                          - type: NAME
                            text: "part"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "p_partkey ..\n        )"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "p_partkey ..\n        )"
                    children:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "p_partkey ..ps_partkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "p_partkey ..ps_partkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_partkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_partkey"
                                    children:
                                      - type: NAME
                                        text: "p_partkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "ps_partkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "ps_partkey"
                                    children:
                                      - type: NAME
                                        text: "ps_partkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "p_brand <>..'Brand#45'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: NOT_EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "p_brand <>..'Brand#45'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_brand"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_brand"
                                    children:
                                      - type: NAME
                                        text: "p_brand"
                              - type: LITERAL_STRING
                                text: "'Brand#45'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "p_type not..POLISHED%'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: NOT_LIKE
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "p_type not..POLISHED%'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_type"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_type"
                                    children:
                                      - type: NAME
                                        text: "p_type"
                              - type: LITERAL_STRING
                                text: "'MEDIUM POLISHED%'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "p_size in .. 3, 36, 9)"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: IN
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "p_size in .. 3, 36, 9)"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_size"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_size"
                                    children:
                                      - type: NAME
                                        text: "p_size"
                              - type: ARRAY
                                text: "(49, 14, 2.. 3, 36, 9)"
                                children:
                                  - type: LITERAL_INTEGER
                                    text: "49"
                                  - type: LITERAL_INTEGER
                                    text: "14"
                                  - type: LITERAL_INTEGER
                                    text: "23"
                                  - type: LITERAL_INTEGER
                                    text: "45"
                                  - type: LITERAL_INTEGER
                                    text: "19"
                                  - type: LITERAL_INTEGER
                                    text: "3"
                                  - type: LITERAL_INTEGER
                                    text: "36"
                                  - type: LITERAL_INTEGER
                                    text: "9"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "ps_suppkey..\n        )"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: NOT_IN
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "ps_suppkey..\n        )"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "ps_suppkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "ps_suppkey"
                                    children:
                                      - type: NAME
                                        text: "ps_suppkey"
                              - type: OBJECT_SQL_SELECT_EXPRESSION
                                text: "(\n        ..\n        )"
                                children:
                                  - key: SQL_SELECT_EXPRESSION_STATEMENT
                                    type: OBJECT_SQL_SELECT
                                    text: "(\n        ..\n        )"
                                    children:
                                      - key: SQL_SELECT_TARGETS
                                        type: ARRAY
                                        text: "s_suppkey"
                                        children:
                                          - type: OBJECT_SQL_RESULT_TARGET
                                            text: "s_suppkey"
                                            children:
                                              - key: SQL_RESULT_TARGET_VALUE
                                                type: OBJECT_SQL_COLUMN_REF
                                                text: "s_suppkey"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "s_suppkey"
                                                    children:
                                                      - type: NAME
                                                        text: "s_suppkey"
                                      - key: SQL_SELECT_FROM
                                        type: ARRAY
                                        text: "from\n     ..  supplier"
                                        children:
                                          - type: OBJECT_SQL_TABLEREF
                                            text: "supplier"
                                            children:
                                              - key: SQL_TABLEREF_NAME
                                                type: ARRAY
                                                text: "supplier"
                                                children:
                                                  - type: NAME
                                                    text: "supplier"
                                      - key: SQL_SELECT_WHERE
                                        type: OBJECT_SQL_NARY_EXPRESSION
                                        text: "s_comment ..mplaints%'"
                                        children:
                                          - key: SQL_EXPRESSION_OPERATOR
                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                            value: LIKE
                                          - key: SQL_EXPRESSION_ARGS
                                            type: ARRAY
                                            text: "s_comment ..mplaints%'"
                                            children:
                                              - type: OBJECT_SQL_COLUMN_REF
                                                text: "s_comment"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "s_comment"
                                                    children:
                                                      - type: NAME
                                                        text: "s_comment"
                                              - type: LITERAL_STRING
                                                text: "'%Customer..mplaints%'"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by\n ..    p_size"
                children:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "p_brand"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_brand"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_brand"
                            children:
                              - type: NAME
                                text: "p_brand"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "p_type"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_type"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_type"
                            children:
                              - type: NAME
                                text: "p_type"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "p_size"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_size"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_size"
                            children:
                              - type: NAME
                                text: "p_size"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by\n ..    p_size"
                children:
                  - type: OBJECT_SQL_ORDER
                    text: "supplier_cnt desc"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "supplier_cnt"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "supplier_cnt"
                            children:
                              - type: NAME
                                text: "supplier_cnt"
                      - key: SQL_ORDER_DIRECTION
                        type: ENUM_SQL_ORDER_DIRECTION
                        value: DESCENDING
                  - type: OBJECT_SQL_ORDER
                    text: "p_brand"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_brand"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_brand"
                            children:
                              - type: NAME
                                text: "p_brand"
                  - type: OBJECT_SQL_ORDER
                    text: "p_type"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_type"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_type"
                            children:
                              - type: NAME
                                text: "p_type"
                  - type: OBJECT_SQL_ORDER
                    text: "p_size"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "p_size"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "p_size"
                            children:
                              - type: NAME
                                text: "p_size"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [23,24]
        - text: [39,40]
        - text: [55,56]
        - text: [106,107]
        - text: [111,112]
        - text: [129,130]
        - text: [142,143]
        - text: [148,149]
        - text: [179,180]
        - text: [213,214]
        - text: [260,261]
        - text: [313,314]
        - text: [345,346]
        - text: [368,369]
        - text: [402,403]
        - text: [423,424]
        - text: [456,457]
        - text: [478,479]
        - text: [541,542]
        - text: [551,552]
        - text: [560,561]
        - text: [577,578]
        - text: [593,594]
        - text: [608,609]
        - text: [617,618]
        - text: [644,645]
        - text: [661,662]
        - text: [677,678]
      comments: []

  - name: tpch_17
    input: |-
      select
              sum(l_extendedprice) / 7.0 as avg_yearly
      from
              lineitem,
              part
      where
              p_partkey = l_partkey
              and p_brand = 'Brand#23'
              and p_container = 'MED BOX'
              and l_quantity < (
                      select
                              0.2 * avg(l_quantity)
                      from
                              lineitem
                      where
                              l_partkey = p_partkey
              )
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 84
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   ..\n        )"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "sum(l_exte..avg_yearly"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(l_exte..avg_yearly"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_NARY_EXPRESSION
                        text: "sum(l_exte..ice) / 7.0"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: DIVIDE
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "sum(l_exte..ice) / 7.0"
                            children:
                              - type: OBJECT_SQL_FUNCTION_EXPRESSION
                                text: "sum(l_exte..ndedprice)"
                                children:
                                  - key: SQL_FUNCTION_NAME
                                    type: ARRAY
                                    text: "sum"
                                    children:
                                      - type: NAME
                                        text: "sum"
                                  - key: SQL_FUNCTION_ARGUMENTS
                                    type: ARRAY
                                    text: "l_extendedprice"
                                    children:
                                      - type: OBJECT_SQL_FUNCTION_ARG
                                        text: "l_extendedprice"
                                        children:
                                          - key: SQL_FUNCTION_ARG_VALUE
                                            type: OBJECT_SQL_COLUMN_REF
                                            text: "l_extendedprice"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_extendedprice"
                                                children:
                                                  - type: NAME
                                                    text: "l_extendedprice"
                              - type: LITERAL_FLOAT
                                text: "7.0"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "avg_yearly"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n     ..      part"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineitem"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineitem"
                        children:
                          - type: NAME
                            text: "lineitem"
                  - type: OBJECT_SQL_TABLEREF
                    text: "part"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "part"
                        children:
                          - type: NAME
                            text: "part"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "p_partkey ..\n        )"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "p_partkey ..\n        )"
                    children:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "p_partkey .. l_partkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "p_partkey .. l_partkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_partkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_partkey"
                                    children:
                                      - type: NAME
                                        text: "p_partkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_partkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_partkey"
                                    children:
                                      - type: NAME
                                        text: "l_partkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "p_brand = ..'Brand#23'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "p_brand = ..'Brand#23'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_brand"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_brand"
                                    children:
                                      - type: NAME
                                        text: "p_brand"
                              - type: LITERAL_STRING
                                text: "'Brand#23'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "p_containe.. 'MED BOX'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "p_containe.. 'MED BOX'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "p_container"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "p_container"
                                    children:
                                      - type: NAME
                                        text: "p_container"
                              - type: LITERAL_STRING
                                text: "'MED BOX'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l_quantity..\n        )"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: LESS_THAN
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l_quantity..\n        )"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_quantity"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_quantity"
                                    children:
                                      - type: NAME
                                        text: "l_quantity"
                              - type: OBJECT_SQL_SELECT_EXPRESSION
                                text: "(\n        ..\n        )"
                                children:
                                  - key: SQL_SELECT_EXPRESSION_STATEMENT
                                    type: OBJECT_SQL_SELECT
                                    text: "(\n        ..\n        )"
                                    children:
                                      - key: SQL_SELECT_TARGETS
                                        type: ARRAY
                                        text: "0.2 * avg(.._quantity)"
                                        children:
                                          - type: OBJECT_SQL_RESULT_TARGET
                                            text: "0.2 * avg(.._quantity)"
                                            children:
                                              - key: SQL_RESULT_TARGET_VALUE
                                                type: OBJECT_SQL_NARY_EXPRESSION
                                                text: "0.2 * avg(.._quantity)"
                                                children:
                                                  - key: SQL_EXPRESSION_OPERATOR
                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                    value: MULTIPLY
                                                  - key: SQL_EXPRESSION_ARGS
                                                    type: ARRAY
                                                    text: "0.2 * avg(.._quantity)"
                                                    children:
                                                      - type: LITERAL_FLOAT
                                                        text: "0.2"
                                                      - type: OBJECT_SQL_FUNCTION_EXPRESSION
                                                        text: "avg(l_quantity)"
                                                        children:
                                                          - key: SQL_FUNCTION_NAME
                                                            type: ARRAY
                                                            text: "avg"
                                                            children:
                                                              - type: NAME
                                                                text: "avg"
                                                          - key: SQL_FUNCTION_ARGUMENTS
                                                            type: ARRAY
                                                            text: "l_quantity"
                                                            children:
                                                              - type: OBJECT_SQL_FUNCTION_ARG
                                                                text: "l_quantity"
                                                                children:
                                                                  - key: SQL_FUNCTION_ARG_VALUE
                                                                    type: OBJECT_SQL_COLUMN_REF
                                                                    text: "l_quantity"
                                                                    children:
                                                                      - key: SQL_COLUMN_REF_PATH
                                                                        type: ARRAY
                                                                        text: "l_quantity"
                                                                        children:
                                                                          - type: NAME
                                                                            text: "l_quantity"
                                      - key: SQL_SELECT_FROM
                                        type: ARRAY
                                        text: "from\n     ..  lineitem"
                                        children:
                                          - type: OBJECT_SQL_TABLEREF
                                            text: "lineitem"
                                            children:
                                              - key: SQL_TABLEREF_NAME
                                                type: ARRAY
                                                text: "lineitem"
                                                children:
                                                  - type: NAME
                                                    text: "lineitem"
                                      - key: SQL_SELECT_WHERE
                                        type: OBJECT_SQL_NARY_EXPRESSION
                                        text: "l_partkey .. p_partkey"
                                        children:
                                          - key: SQL_EXPRESSION_OPERATOR
                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                            value: EQUAL
                                          - key: SQL_EXPRESSION_ARGS
                                            type: ARRAY
                                            text: "l_partkey .. p_partkey"
                                            children:
                                              - type: OBJECT_SQL_COLUMN_REF
                                                text: "l_partkey"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "l_partkey"
                                                    children:
                                                      - type: NAME
                                                        text: "l_partkey"
                                              - type: OBJECT_SQL_COLUMN_REF
                                                text: "p_partkey"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "p_partkey"
                                                    children:
                                                      - type: NAME
                                                        text: "p_partkey"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [55,56]
        - text: [60,61]
        - text: [78,79]
        - text: [91,92]
        - text: [97,98]
        - text: [127,128]
        - text: [160,161]
        - text: [196,197]
        - text: [223,224]
        - text: [246,247]
        - text: [292,293]
        - text: [313,314]
        - text: [346,347]
        - text: [368,369]
        - text: [414,415]
      comments: []

  - name: tpch_18
    input: |-
      select
              c_name,
              c_custkey,
              o_orderkey,
              o_orderdate,
              o_totalprice,
              sum(l_quantity)
      from
              customer,
              orders,
              lineitem
      where
              o_orderkey in (
                      select
                              l_orderkey
                      from
                              lineitem
                      group by
                              l_orderkey having
                                      sum(l_quantity) > 300
              )
              and c_custkey = o_custkey
              and o_orderkey = l_orderkey
      group by
              c_name,
              c_custkey,
              o_orderkey,
              o_orderdate,
              o_totalprice
      order by
              o_totalprice desc,
              o_orderdate
      limit
      	100
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 134
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   ..limit\n	100"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "c_name,\n  .._quantity)"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "c_name"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_name"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_name"
                            children:
                              - type: NAME
                                text: "c_name"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "c_custkey"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_custkey"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_custkey"
                            children:
                              - type: NAME
                                text: "c_custkey"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "o_orderkey"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_orderkey"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_orderkey"
                            children:
                              - type: NAME
                                text: "o_orderkey"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "o_orderdate"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_orderdate"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_orderdate"
                            children:
                              - type: NAME
                                text: "o_orderdate"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "o_totalprice"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_totalprice"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_totalprice"
                            children:
                              - type: NAME
                                text: "o_totalprice"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(l_quantity)"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(l_quantity)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            children:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "l_quantity"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "l_quantity"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "l_quantity"
                                    children:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "l_quantity"
                                        children:
                                          - type: NAME
                                            text: "l_quantity"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n     ..  lineitem"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "customer"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "customer"
                        children:
                          - type: NAME
                            text: "customer"
                  - type: OBJECT_SQL_TABLEREF
                    text: "orders"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "orders"
                        children:
                          - type: NAME
                            text: "orders"
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineitem"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineitem"
                        children:
                          - type: NAME
                            text: "lineitem"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "o_orderkey..l_orderkey"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "o_orderkey..l_orderkey"
                    children:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "o_orderkey..\n        )"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: IN
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "o_orderkey..\n        )"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "o_orderkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "o_orderkey"
                                    children:
                                      - type: NAME
                                        text: "o_orderkey"
                              - type: OBJECT_SQL_SELECT_EXPRESSION
                                text: "(\n        ..\n        )"
                                children:
                                  - key: SQL_SELECT_EXPRESSION_STATEMENT
                                    type: OBJECT_SQL_SELECT
                                    text: "(\n        ..\n        )"
                                    children:
                                      - key: SQL_SELECT_TARGETS
                                        type: ARRAY
                                        text: "l_orderkey"
                                        children:
                                          - type: OBJECT_SQL_RESULT_TARGET
                                            text: "l_orderkey"
                                            children:
                                              - key: SQL_RESULT_TARGET_VALUE
                                                type: OBJECT_SQL_COLUMN_REF
                                                text: "l_orderkey"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "l_orderkey"
                                                    children:
                                                      - type: NAME
                                                        text: "l_orderkey"
                                      - key: SQL_SELECT_FROM
                                        type: ARRAY
                                        text: "from\n     ..  lineitem"
                                        children:
                                          - type: OBJECT_SQL_TABLEREF
                                            text: "lineitem"
                                            children:
                                              - key: SQL_TABLEREF_NAME
                                                type: ARRAY
                                                text: "lineitem"
                                                children:
                                                  - type: NAME
                                                    text: "lineitem"
                                      - key: SQL_SELECT_GROUPS
                                        type: ARRAY
                                        text: "group by\n ..l_orderkey"
                                        children:
                                          - type: OBJECT_SQL_GROUP_BY_ITEM
                                            text: "l_orderkey"
                                            children:
                                              - key: SQL_GROUP_BY_ITEM_TYPE
                                                type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                                                value: EXPRESSION
                                              - key: SQL_GROUP_BY_ITEM_ARG
                                                type: OBJECT_SQL_COLUMN_REF
                                                text: "l_orderkey"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "l_orderkey"
                                                    children:
                                                      - type: NAME
                                                        text: "l_orderkey"
                                      - key: SQL_SELECT_HAVING
                                        type: OBJECT_SQL_NARY_EXPRESSION
                                        text: "sum(l_quan..ity) > 300"
                                        children:
                                          - key: SQL_EXPRESSION_OPERATOR
                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                            value: GREATER_THAN
                                          - key: SQL_EXPRESSION_ARGS
                                            type: ARRAY
                                            text: "sum(l_quan..ity) > 300"
                                            children:
                                              - type: OBJECT_SQL_FUNCTION_EXPRESSION
                                                text: "sum(l_quantity)"
                                                children:
                                                  - key: SQL_FUNCTION_NAME
                                                    type: ARRAY
                                                    text: "sum"
                                                    children:
                                                      - type: NAME
                                                        text: "sum"
                                                  - key: SQL_FUNCTION_ARGUMENTS
                                                    type: ARRAY
                                                    text: "l_quantity"
                                                    children:
                                                      - type: OBJECT_SQL_FUNCTION_ARG
                                                        text: "l_quantity"
                                                        children:
                                                          - key: SQL_FUNCTION_ARG_VALUE
                                                            type: OBJECT_SQL_COLUMN_REF
                                                            text: "l_quantity"
                                                            children:
                                                              - key: SQL_COLUMN_REF_PATH
                                                                type: ARRAY
                                                                text: "l_quantity"
                                                                children:
                                                                  - type: NAME
                                                                    text: "l_quantity"
                                              - type: LITERAL_INTEGER
                                                text: "300"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "c_custkey .. o_custkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "c_custkey .. o_custkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "c_custkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "c_custkey"
                                    children:
                                      - type: NAME
                                        text: "c_custkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "o_custkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "o_custkey"
                                    children:
                                      - type: NAME
                                        text: "o_custkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "o_orderkey..l_orderkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "o_orderkey..l_orderkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "o_orderkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "o_orderkey"
                                    children:
                                      - type: NAME
                                        text: "o_orderkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l_orderkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l_orderkey"
                                    children:
                                      - type: NAME
                                        text: "l_orderkey"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by\n ..totalprice"
                children:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "c_name"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_name"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_name"
                            children:
                              - type: NAME
                                text: "c_name"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "c_custkey"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "c_custkey"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c_custkey"
                            children:
                              - type: NAME
                                text: "c_custkey"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "o_orderkey"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_orderkey"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_orderkey"
                            children:
                              - type: NAME
                                text: "o_orderkey"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "o_orderdate"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_orderdate"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_orderdate"
                            children:
                              - type: NAME
                                text: "o_orderdate"
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "o_totalprice"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_totalprice"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_totalprice"
                            children:
                              - type: NAME
                                text: "o_totalprice"
              - key: SQL_SELECT_LIMIT
                type: LITERAL_INTEGER
                text: "100"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by\n .._orderdate"
                children:
                  - type: OBJECT_SQL_ORDER
                    text: "o_totalprice desc"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_totalprice"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_totalprice"
                            children:
                              - type: NAME
                                text: "o_totalprice"
                      - key: SQL_ORDER_DIRECTION
                        type: ENUM_SQL_ORDER_DIRECTION
                        value: DESCENDING
                  - type: OBJECT_SQL_ORDER
                    text: "o_orderdate"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "o_orderdate"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "o_orderdate"
                            children:
                              - type: NAME
                                text: "o_orderdate"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [22,23]
        - text: [41,42]
        - text: [61,62]
        - text: [82,83]
        - text: [104,105]
        - text: [128,129]
        - text: [133,134]
        - text: [151,152]
        - text: [167,168]
        - text: [184,185]
        - text: [190,191]
        - text: [214,215]
        - text: [237,238]
        - text: [272,273]
        - text: [293,294]
        - text: [326,327]
        - text: [351,352]
        - text: [393,394]
        - text: [447,448]
        - text: [457,458]
        - text: [491,492]
        - text: [527,528]
        - text: [536,537]
        - text: [552,553]
        - text: [571,572]
        - text: [591,592]
        - text: [612,613]
        - text: [633,634]
        - text: [642,643]
        - text: [669,670]
        - text: [689,690]
        - text: [695,696]
      comments: []

  - name: tpch_19
    input: |-
      select
              sum(l_extendedprice* (1 - l_discount)) as revenue
      from
              lineitem,
              part
      where
              (
                      p_partkey = l_partkey
                      and p_brand = 'Brand#12'
                      and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
                      and l_quantity >= 1 and l_quantity <= 1 + 10
                      and p_size between 1 and 5
                      and l_shipmode in ('AIR', 'AIR REG')
                      and l_shipinstruct = 'DELIVER IN PERSON'
              )
              or
              (
                      p_partkey = l_partkey
                      and p_brand = 'Brand#23'
                      and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
                      and l_quantity >= 10 and l_quantity <= 10 + 10
                      and p_size between 1 and 10
                      and l_shipmode in ('AIR', 'AIR REG')
                      and l_shipinstruct = 'DELIVER IN PERSON'
              )
              or
              (
                      p_partkey = l_partkey
                      and p_brand = 'Brand#34'
                      and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
                      and l_quantity >= 20 and l_quantity <= 20 + 10
                      and p_size between 1 and 15
                      and l_shipmode in ('AIR', 'AIR REG')
                      and l_shipinstruct = 'DELIVER IN PERSON'
              )
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 248
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   ..\n        )"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "sum(l_exte..as revenue"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(l_exte..as revenue"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(l_exte..discount))"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            children:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "l_extended.._discount)"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "l_extended.._discount)"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "l_extended.._discount)"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: MULTIPLY
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "l_extended.._discount)"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "l_extendedprice"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "l_extendedprice"
                                                children:
                                                  - type: NAME
                                                    text: "l_extendedprice"
                                          - type: OBJECT_SQL_NARY_EXPRESSION
                                            text: "1 - l_discount"
                                            children:
                                              - key: SQL_EXPRESSION_OPERATOR
                                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                                value: MINUS
                                              - key: SQL_EXPRESSION_ARGS
                                                type: ARRAY
                                                text: "1 - l_discount"
                                                children:
                                                  - type: LITERAL_INTEGER
                                                    text: "1"
                                                  - type: OBJECT_SQL_COLUMN_REF
                                                    text: "l_discount"
                                                    children:
                                                      - key: SQL_COLUMN_REF_PATH
                                                        type: ARRAY
                                                        text: "l_discount"
                                                        children:
                                                          - type: NAME
                                                            text: "l_discount"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "revenue"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n     ..      part"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineitem"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineitem"
                        children:
                          - type: NAME
                            text: "lineitem"
                  - type: OBJECT_SQL_TABLEREF
                    text: "part"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "part"
                        children:
                          - type: NAME
                            text: "part"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "(\n        ..\n        )"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: OR
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "(\n        ..\n        )"
                    children:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "p_partkey ..IN PERSON'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: AND
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "p_partkey ..IN PERSON'"
                            children:
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "p_partkey .. l_partkey"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "p_partkey .. l_partkey"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "p_partkey"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "p_partkey"
                                            children:
                                              - type: NAME
                                                text: "p_partkey"
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "l_partkey"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "l_partkey"
                                            children:
                                              - type: NAME
                                                text: "l_partkey"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "p_brand = ..'Brand#12'"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "p_brand = ..'Brand#12'"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "p_brand"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "p_brand"
                                            children:
                                              - type: NAME
                                                text: "p_brand"
                                      - type: LITERAL_STRING
                                        text: "'Brand#12'"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "p_containe.. 'SM PKG')"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: IN
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "p_containe.. 'SM PKG')"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "p_container"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "p_container"
                                            children:
                                              - type: NAME
                                                text: "p_container"
                                      - type: ARRAY
                                        text: "('SM CASE'.. 'SM PKG')"
                                        children:
                                          - type: LITERAL_STRING
                                            text: "'SM CASE'"
                                          - type: LITERAL_STRING
                                            text: "'SM BOX'"
                                          - type: LITERAL_STRING
                                            text: "'SM PACK'"
                                          - type: LITERAL_STRING
                                            text: "'SM PKG'"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "l_quantity >= 1"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: GREATER_EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "l_quantity >= 1"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "l_quantity"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "l_quantity"
                                            children:
                                              - type: NAME
                                                text: "l_quantity"
                                      - type: LITERAL_INTEGER
                                        text: "1"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "l_quantity.. <= 1 + 10"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: LESS_EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "l_quantity.. <= 1 + 10"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "l_quantity"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "l_quantity"
                                            children:
                                              - type: NAME
                                                text: "l_quantity"
                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                        text: "1 + 10"
                                        children:
                                          - key: SQL_EXPRESSION_OPERATOR
                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                            value: PLUS
                                          - key: SQL_EXPRESSION_ARGS
                                            type: ARRAY
                                            text: "1 + 10"
                                            children:
                                              - type: LITERAL_INTEGER
                                                text: "1"
                                              - type: LITERAL_INTEGER
                                                text: "10"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "p_size bet..en 1 and 5"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: BETWEEN_SYMMETRIC
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "p_size bet..en 1 and 5"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "p_size"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "p_size"
                                            children:
                                              - type: NAME
                                                text: "p_size"
                                      - type: LITERAL_INTEGER
                                        text: "1"
                                      - type: LITERAL_INTEGER
                                        text: "5"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "l_shipmode..'AIR REG')"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: IN
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "l_shipmode..'AIR REG')"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "l_shipmode"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "l_shipmode"
                                            children:
                                              - type: NAME
                                                text: "l_shipmode"
                                      - type: ARRAY
                                        text: "('AIR', 'AIR REG')"
                                        children:
                                          - type: LITERAL_STRING
                                            text: "'AIR'"
                                          - type: LITERAL_STRING
                                            text: "'AIR REG'"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "l_shipinst..IN PERSON'"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "l_shipinst..IN PERSON'"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "l_shipinstruct"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "l_shipinstruct"
                                            children:
                                              - type: NAME
                                                text: "l_shipinstruct"
                                      - type: LITERAL_STRING
                                        text: "'DELIVER IN PERSON'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "p_partkey ..IN PERSON'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: AND
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "p_partkey ..IN PERSON'"
                            children:
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "p_partkey .. l_partkey"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "p_partkey .. l_partkey"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "p_partkey"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "p_partkey"
                                            children:
                                              - type: NAME
                                                text: "p_partkey"
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "l_partkey"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "l_partkey"
                                            children:
                                              - type: NAME
                                                text: "l_partkey"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "p_brand = ..'Brand#23'"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "p_brand = ..'Brand#23'"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "p_brand"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "p_brand"
                                            children:
                                              - type: NAME
                                                text: "p_brand"
                                      - type: LITERAL_STRING
                                        text: "'Brand#23'"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "p_containe..MED PACK')"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: IN
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "p_containe..MED PACK')"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "p_container"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "p_container"
                                            children:
                                              - type: NAME
                                                text: "p_container"
                                      - type: ARRAY
                                        text: "('MED BAG'..MED PACK')"
                                        children:
                                          - type: LITERAL_STRING
                                            text: "'MED BAG'"
                                          - type: LITERAL_STRING
                                            text: "'MED BOX'"
                                          - type: LITERAL_STRING
                                            text: "'MED PKG'"
                                          - type: LITERAL_STRING
                                            text: "'MED PACK'"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "l_quantity >= 10"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: GREATER_EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "l_quantity >= 10"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "l_quantity"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "l_quantity"
                                            children:
                                              - type: NAME
                                                text: "l_quantity"
                                      - type: LITERAL_INTEGER
                                        text: "10"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "l_quantity..<= 10 + 10"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: LESS_EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "l_quantity..<= 10 + 10"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "l_quantity"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "l_quantity"
                                            children:
                                              - type: NAME
                                                text: "l_quantity"
                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                        text: "10 + 10"
                                        children:
                                          - key: SQL_EXPRESSION_OPERATOR
                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                            value: PLUS
                                          - key: SQL_EXPRESSION_ARGS
                                            type: ARRAY
                                            text: "10 + 10"
                                            children:
                                              - type: LITERAL_INTEGER
                                                text: "10"
                                              - type: LITERAL_INTEGER
                                                text: "10"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "p_size bet..n 1 and 10"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: BETWEEN_SYMMETRIC
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "p_size bet..n 1 and 10"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "p_size"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "p_size"
                                            children:
                                              - type: NAME
                                                text: "p_size"
                                      - type: LITERAL_INTEGER
                                        text: "1"
                                      - type: LITERAL_INTEGER
                                        text: "10"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "l_shipmode..'AIR REG')"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: IN
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "l_shipmode..'AIR REG')"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "l_shipmode"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "l_shipmode"
                                            children:
                                              - type: NAME
                                                text: "l_shipmode"
                                      - type: ARRAY
                                        text: "('AIR', 'AIR REG')"
                                        children:
                                          - type: LITERAL_STRING
                                            text: "'AIR'"
                                          - type: LITERAL_STRING
                                            text: "'AIR REG'"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "l_shipinst..IN PERSON'"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "l_shipinst..IN PERSON'"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "l_shipinstruct"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "l_shipinstruct"
                                            children:
                                              - type: NAME
                                                text: "l_shipinstruct"
                                      - type: LITERAL_STRING
                                        text: "'DELIVER IN PERSON'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "p_partkey ..IN PERSON'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: AND
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "p_partkey ..IN PERSON'"
                            children:
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "p_partkey .. l_partkey"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "p_partkey .. l_partkey"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "p_partkey"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "p_partkey"
                                            children:
                                              - type: NAME
                                                text: "p_partkey"
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "l_partkey"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "l_partkey"
                                            children:
                                              - type: NAME
                                                text: "l_partkey"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "p_brand = ..'Brand#34'"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "p_brand = ..'Brand#34'"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "p_brand"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "p_brand"
                                            children:
                                              - type: NAME
                                                text: "p_brand"
                                      - type: LITERAL_STRING
                                        text: "'Brand#34'"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "p_containe.. 'LG PKG')"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: IN
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "p_containe.. 'LG PKG')"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "p_container"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "p_container"
                                            children:
                                              - type: NAME
                                                text: "p_container"
                                      - type: ARRAY
                                        text: "('LG CASE'.. 'LG PKG')"
                                        children:
                                          - type: LITERAL_STRING
                                            text: "'LG CASE'"
                                          - type: LITERAL_STRING
                                            text: "'LG BOX'"
                                          - type: LITERAL_STRING
                                            text: "'LG PACK'"
                                          - type: LITERAL_STRING
                                            text: "'LG PKG'"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "l_quantity >= 20"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: GREATER_EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "l_quantity >= 20"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "l_quantity"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "l_quantity"
                                            children:
                                              - type: NAME
                                                text: "l_quantity"
                                      - type: LITERAL_INTEGER
                                        text: "20"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "l_quantity..<= 20 + 10"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: LESS_EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "l_quantity..<= 20 + 10"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "l_quantity"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "l_quantity"
                                            children:
                                              - type: NAME
                                                text: "l_quantity"
                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                        text: "20 + 10"
                                        children:
                                          - key: SQL_EXPRESSION_OPERATOR
                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                            value: PLUS
                                          - key: SQL_EXPRESSION_ARGS
                                            type: ARRAY
                                            text: "20 + 10"
                                            children:
                                              - type: LITERAL_INTEGER
                                                text: "20"
                                              - type: LITERAL_INTEGER
                                                text: "10"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "p_size bet..n 1 and 15"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: BETWEEN_SYMMETRIC
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "p_size bet..n 1 and 15"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "p_size"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "p_size"
                                            children:
                                              - type: NAME
                                                text: "p_size"
                                      - type: LITERAL_INTEGER
                                        text: "1"
                                      - type: LITERAL_INTEGER
                                        text: "15"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "l_shipmode..'AIR REG')"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: IN
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "l_shipmode..'AIR REG')"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "l_shipmode"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "l_shipmode"
                                            children:
                                              - type: NAME
                                                text: "l_shipmode"
                                      - type: ARRAY
                                        text: "('AIR', 'AIR REG')"
                                        children:
                                          - type: LITERAL_STRING
                                            text: "'AIR'"
                                          - type: LITERAL_STRING
                                            text: "'AIR REG'"
                              - type: OBJECT_SQL_NARY_EXPRESSION
                                text: "l_shipinst..IN PERSON'"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: EQUAL
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "l_shipinst..IN PERSON'"
                                    children:
                                      - type: OBJECT_SQL_COLUMN_REF
                                        text: "l_shipinstruct"
                                        children:
                                          - key: SQL_COLUMN_REF_PATH
                                            type: ARRAY
                                            text: "l_shipinstruct"
                                            children:
                                              - type: NAME
                                                text: "l_shipinstruct"
                                      - type: LITERAL_STRING
                                        text: "'DELIVER IN PERSON'"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [64,65]
        - text: [69,70]
        - text: [87,88]
        - text: [100,101]
        - text: [106,107]
        - text: [116,117]
        - text: [154,155]
        - text: [195,196]
        - text: [273,274]
        - text: [334,335]
        - text: [377,378]
        - text: [430,431]
        - text: [487,488]
        - text: [497,498]
        - text: [508,509]
        - text: [518,519]
        - text: [556,557]
        - text: [597,598]
        - text: [678,679]
        - text: [741,742]
        - text: [785,786]
        - text: [838,839]
        - text: [895,896]
        - text: [905,906]
        - text: [916,917]
        - text: [926,927]
        - text: [964,965]
        - text: [1005,1006]
        - text: [1083,1084]
        - text: [1146,1147]
        - text: [1190,1191]
        - text: [1243,1244]
        - text: [1300,1301]
      comments: []

  - name: tpch_20
    input: |-
      select
              s_name,
              s_address
      from
              supplier,
              nation
      where
              s_suppkey in (
                      select
                              ps_suppkey
                      from
                              partsupp
                      where
                              ps_partkey in (
                                      select
                                              p_partkey
                                      from
                                              part
                                      where
                                              p_name like 'forest%'
                              )
                              and ps_availqty > (
                                      select
                                              0.5 * sum(l_quantity)
                                      from
                                              lineitem
                                      where
                                              l_partkey = ps_partkey
                                              and l_suppkey = ps_suppkey
                                              and l_shipdate >= date '1994-01-01'
                                              and l_shipdate < date '1995-01-01'
                              )
              )
              and s_nationkey = n_nationkey
              and n_name = 'CANADA'
      order by
              s_name
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 152
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   ..    s_name"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "s_name,\n  .. s_address"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "s_name"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_name"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_name"
                            children:
                              - type: NAME
                                text: "s_name"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "s_address"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_address"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_address"
                            children:
                              - type: NAME
                                text: "s_address"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n     ..    nation"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "supplier"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "supplier"
                        children:
                          - type: NAME
                            text: "supplier"
                  - type: OBJECT_SQL_TABLEREF
                    text: "nation"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "nation"
                        children:
                          - type: NAME
                            text: "nation"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "s_suppkey ..= 'CANADA'"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "s_suppkey ..= 'CANADA'"
                    children:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "s_suppkey ..\n        )"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: IN
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "s_suppkey ..\n        )"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_suppkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_suppkey"
                                    children:
                                      - type: NAME
                                        text: "s_suppkey"
                              - type: OBJECT_SQL_SELECT_EXPRESSION
                                text: "(\n        ..\n        )"
                                children:
                                  - key: SQL_SELECT_EXPRESSION_STATEMENT
                                    type: OBJECT_SQL_SELECT
                                    text: "(\n        ..\n        )"
                                    children:
                                      - key: SQL_SELECT_TARGETS
                                        type: ARRAY
                                        text: "ps_suppkey"
                                        children:
                                          - type: OBJECT_SQL_RESULT_TARGET
                                            text: "ps_suppkey"
                                            children:
                                              - key: SQL_RESULT_TARGET_VALUE
                                                type: OBJECT_SQL_COLUMN_REF
                                                text: "ps_suppkey"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "ps_suppkey"
                                                    children:
                                                      - type: NAME
                                                        text: "ps_suppkey"
                                      - key: SQL_SELECT_FROM
                                        type: ARRAY
                                        text: "from\n     ..  partsupp"
                                        children:
                                          - type: OBJECT_SQL_TABLEREF
                                            text: "partsupp"
                                            children:
                                              - key: SQL_TABLEREF_NAME
                                                type: ARRAY
                                                text: "partsupp"
                                                children:
                                                  - type: NAME
                                                    text: "partsupp"
                                      - key: SQL_SELECT_WHERE
                                        type: OBJECT_SQL_NARY_EXPRESSION
                                        text: "ps_partkey..         )"
                                        children:
                                          - key: SQL_EXPRESSION_OPERATOR
                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                            value: AND
                                          - key: SQL_EXPRESSION_ARGS
                                            type: ARRAY
                                            text: "ps_partkey..         )"
                                            children:
                                              - type: OBJECT_SQL_NARY_EXPRESSION
                                                text: "ps_partkey..         )"
                                                children:
                                                  - key: SQL_EXPRESSION_OPERATOR
                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                    value: IN
                                                  - key: SQL_EXPRESSION_ARGS
                                                    type: ARRAY
                                                    text: "ps_partkey..         )"
                                                    children:
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "ps_partkey"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "ps_partkey"
                                                            children:
                                                              - type: NAME
                                                                text: "ps_partkey"
                                                      - type: OBJECT_SQL_SELECT_EXPRESSION
                                                        text: "(\n        ..         )"
                                                        children:
                                                          - key: SQL_SELECT_EXPRESSION_STATEMENT
                                                            type: OBJECT_SQL_SELECT
                                                            text: "(\n        ..         )"
                                                            children:
                                                              - key: SQL_SELECT_TARGETS
                                                                type: ARRAY
                                                                text: "p_partkey"
                                                                children:
                                                                  - type: OBJECT_SQL_RESULT_TARGET
                                                                    text: "p_partkey"
                                                                    children:
                                                                      - key: SQL_RESULT_TARGET_VALUE
                                                                        type: OBJECT_SQL_COLUMN_REF
                                                                        text: "p_partkey"
                                                                        children:
                                                                          - key: SQL_COLUMN_REF_PATH
                                                                            type: ARRAY
                                                                            text: "p_partkey"
                                                                            children:
                                                                              - type: NAME
                                                                                text: "p_partkey"
                                                              - key: SQL_SELECT_FROM
                                                                type: ARRAY
                                                                text: "from\n     ..      part"
                                                                children:
                                                                  - type: OBJECT_SQL_TABLEREF
                                                                    text: "part"
                                                                    children:
                                                                      - key: SQL_TABLEREF_NAME
                                                                        type: ARRAY
                                                                        text: "part"
                                                                        children:
                                                                          - type: NAME
                                                                            text: "part"
                                                              - key: SQL_SELECT_WHERE
                                                                type: OBJECT_SQL_NARY_EXPRESSION
                                                                text: "p_name lik.. 'forest%'"
                                                                children:
                                                                  - key: SQL_EXPRESSION_OPERATOR
                                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                                    value: LIKE
                                                                  - key: SQL_EXPRESSION_ARGS
                                                                    type: ARRAY
                                                                    text: "p_name lik.. 'forest%'"
                                                                    children:
                                                                      - type: OBJECT_SQL_COLUMN_REF
                                                                        text: "p_name"
                                                                        children:
                                                                          - key: SQL_COLUMN_REF_PATH
                                                                            type: ARRAY
                                                                            text: "p_name"
                                                                            children:
                                                                              - type: NAME
                                                                                text: "p_name"
                                                                      - type: LITERAL_STRING
                                                                        text: "'forest%'"
                                              - type: OBJECT_SQL_NARY_EXPRESSION
                                                text: "ps_availqt..         )"
                                                children:
                                                  - key: SQL_EXPRESSION_OPERATOR
                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                    value: GREATER_THAN
                                                  - key: SQL_EXPRESSION_ARGS
                                                    type: ARRAY
                                                    text: "ps_availqt..         )"
                                                    children:
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "ps_availqty"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "ps_availqty"
                                                            children:
                                                              - type: NAME
                                                                text: "ps_availqty"
                                                      - type: OBJECT_SQL_SELECT_EXPRESSION
                                                        text: "(\n        ..         )"
                                                        children:
                                                          - key: SQL_SELECT_EXPRESSION_STATEMENT
                                                            type: OBJECT_SQL_SELECT
                                                            text: "(\n        ..         )"
                                                            children:
                                                              - key: SQL_SELECT_TARGETS
                                                                type: ARRAY
                                                                text: "0.5 * sum(.._quantity)"
                                                                children:
                                                                  - type: OBJECT_SQL_RESULT_TARGET
                                                                    text: "0.5 * sum(.._quantity)"
                                                                    children:
                                                                      - key: SQL_RESULT_TARGET_VALUE
                                                                        type: OBJECT_SQL_NARY_EXPRESSION
                                                                        text: "0.5 * sum(.._quantity)"
                                                                        children:
                                                                          - key: SQL_EXPRESSION_OPERATOR
                                                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                                                            value: MULTIPLY
                                                                          - key: SQL_EXPRESSION_ARGS
                                                                            type: ARRAY
                                                                            text: "0.5 * sum(.._quantity)"
                                                                            children:
                                                                              - type: LITERAL_FLOAT
                                                                                text: "0.5"
                                                                              - type: OBJECT_SQL_FUNCTION_EXPRESSION
                                                                                text: "sum(l_quantity)"
                                                                                children:
                                                                                  - key: SQL_FUNCTION_NAME
                                                                                    type: ARRAY
                                                                                    text: "sum"
                                                                                    children:
                                                                                      - type: NAME
                                                                                        text: "sum"
                                                                                  - key: SQL_FUNCTION_ARGUMENTS
                                                                                    type: ARRAY
                                                                                    text: "l_quantity"
                                                                                    children:
                                                                                      - type: OBJECT_SQL_FUNCTION_ARG
                                                                                        text: "l_quantity"
                                                                                        children:
                                                                                          - key: SQL_FUNCTION_ARG_VALUE
                                                                                            type: OBJECT_SQL_COLUMN_REF
                                                                                            text: "l_quantity"
                                                                                            children:
                                                                                              - key: SQL_COLUMN_REF_PATH
                                                                                                type: ARRAY
                                                                                                text: "l_quantity"
                                                                                                children:
                                                                                                  - type: NAME
                                                                                                    text: "l_quantity"
                                                              - key: SQL_SELECT_FROM
                                                                type: ARRAY
                                                                text: "from\n     ..  lineitem"
                                                                children:
                                                                  - type: OBJECT_SQL_TABLEREF
                                                                    text: "lineitem"
                                                                    children:
                                                                      - key: SQL_TABLEREF_NAME
                                                                        type: ARRAY
                                                                        text: "lineitem"
                                                                        children:
                                                                          - type: NAME
                                                                            text: "lineitem"
                                                              - key: SQL_SELECT_WHERE
                                                                type: OBJECT_SQL_NARY_EXPRESSION
                                                                text: "l_partkey ..995-01-01'"
                                                                children:
                                                                  - key: SQL_EXPRESSION_OPERATOR
                                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                                    value: AND
                                                                  - key: SQL_EXPRESSION_ARGS
                                                                    type: ARRAY
                                                                    text: "l_partkey ..995-01-01'"
                                                                    children:
                                                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                                                        text: "l_partkey ..ps_partkey"
                                                                        children:
                                                                          - key: SQL_EXPRESSION_OPERATOR
                                                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                                                            value: EQUAL
                                                                          - key: SQL_EXPRESSION_ARGS
                                                                            type: ARRAY
                                                                            text: "l_partkey ..ps_partkey"
                                                                            children:
                                                                              - type: OBJECT_SQL_COLUMN_REF
                                                                                text: "l_partkey"
                                                                                children:
                                                                                  - key: SQL_COLUMN_REF_PATH
                                                                                    type: ARRAY
                                                                                    text: "l_partkey"
                                                                                    children:
                                                                                      - type: NAME
                                                                                        text: "l_partkey"
                                                                              - type: OBJECT_SQL_COLUMN_REF
                                                                                text: "ps_partkey"
                                                                                children:
                                                                                  - key: SQL_COLUMN_REF_PATH
                                                                                    type: ARRAY
                                                                                    text: "ps_partkey"
                                                                                    children:
                                                                                      - type: NAME
                                                                                        text: "ps_partkey"
                                                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                                                        text: "l_suppkey ..ps_suppkey"
                                                                        children:
                                                                          - key: SQL_EXPRESSION_OPERATOR
                                                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                                                            value: EQUAL
                                                                          - key: SQL_EXPRESSION_ARGS
                                                                            type: ARRAY
                                                                            text: "l_suppkey ..ps_suppkey"
                                                                            children:
                                                                              - type: OBJECT_SQL_COLUMN_REF
                                                                                text: "l_suppkey"
                                                                                children:
                                                                                  - key: SQL_COLUMN_REF_PATH
                                                                                    type: ARRAY
                                                                                    text: "l_suppkey"
                                                                                    children:
                                                                                      - type: NAME
                                                                                        text: "l_suppkey"
                                                                              - type: OBJECT_SQL_COLUMN_REF
                                                                                text: "ps_suppkey"
                                                                                children:
                                                                                  - key: SQL_COLUMN_REF_PATH
                                                                                    type: ARRAY
                                                                                    text: "ps_suppkey"
                                                                                    children:
                                                                                      - type: NAME
                                                                                        text: "ps_suppkey"
                                                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                                                        text: "l_shipdate..994-01-01'"
                                                                        children:
                                                                          - key: SQL_EXPRESSION_OPERATOR
                                                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                                                            value: GREATER_EQUAL
                                                                          - key: SQL_EXPRESSION_ARGS
                                                                            type: ARRAY
                                                                            text: "l_shipdate..994-01-01'"
                                                                            children:
                                                                              - type: OBJECT_SQL_COLUMN_REF
                                                                                text: "l_shipdate"
                                                                                children:
                                                                                  - key: SQL_COLUMN_REF_PATH
                                                                                    type: ARRAY
                                                                                    text: "l_shipdate"
                                                                                    children:
                                                                                      - type: NAME
                                                                                        text: "l_shipdate"
                                                                              - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                                                                text: "date '1994-01-01'"
                                                                                children:
                                                                                  - key: SQL_CONST_CAST_FUNC_NAME
                                                                                    type: ARRAY
                                                                                    text: "date"
                                                                                    children:
                                                                                      - type: NAME
                                                                                        text: "date"
                                                                                  - key: SQL_CONST_CAST_VALUE
                                                                                    type: LITERAL_STRING
                                                                                    text: "'1994-01-01'"
                                                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                                                        text: "l_shipdate..995-01-01'"
                                                                        children:
                                                                          - key: SQL_EXPRESSION_OPERATOR
                                                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                                                            value: LESS_THAN
                                                                          - key: SQL_EXPRESSION_ARGS
                                                                            type: ARRAY
                                                                            text: "l_shipdate..995-01-01'"
                                                                            children:
                                                                              - type: OBJECT_SQL_COLUMN_REF
                                                                                text: "l_shipdate"
                                                                                children:
                                                                                  - key: SQL_COLUMN_REF_PATH
                                                                                    type: ARRAY
                                                                                    text: "l_shipdate"
                                                                                    children:
                                                                                      - type: NAME
                                                                                        text: "l_shipdate"
                                                                              - type: OBJECT_SQL_CONST_FUNCTION_CAST
                                                                                text: "date '1995-01-01'"
                                                                                children:
                                                                                  - key: SQL_CONST_CAST_FUNC_NAME
                                                                                    type: ARRAY
                                                                                    text: "date"
                                                                                    children:
                                                                                      - type: NAME
                                                                                        text: "date"
                                                                                  - key: SQL_CONST_CAST_VALUE
                                                                                    type: LITERAL_STRING
                                                                                    text: "'1995-01-01'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "s_nationke.._nationkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "s_nationke.._nationkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_nationkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_nationkey"
                                    children:
                                      - type: NAME
                                        text: "s_nationkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "n_nationkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "n_nationkey"
                                    children:
                                      - type: NAME
                                        text: "n_nationkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "n_name = 'CANADA'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "n_name = 'CANADA'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "n_name"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "n_name"
                                    children:
                                      - type: NAME
                                        text: "n_name"
                              - type: LITERAL_STRING
                                text: "'CANADA'"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by\n ..    s_name"
                children:
                  - type: OBJECT_SQL_ORDER
                    text: "s_name"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_name"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_name"
                            children:
                              - type: NAME
                                text: "s_name"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [22,23]
        - text: [40,41]
        - text: [45,46]
        - text: [63,64]
        - text: [78,79]
        - text: [84,85]
        - text: [107,108]
        - text: [130,131]
        - text: [165,166]
        - text: [186,187]
        - text: [219,220]
        - text: [241,242]
        - text: [281,282]
        - text: [320,321]
        - text: [370,371]
        - text: [407,408]
        - text: [452,453]
        - text: [490,491]
        - text: [552,553]
        - text: [578,579]
        - text: [622,623]
        - text: [661,662]
        - text: [723,724]
        - text: [760,761]
        - text: [809,810]
        - text: [847,848]
        - text: [910,911]
        - text: [977,978]
        - text: [1053,1054]
        - text: [1128,1129]
        - text: [1154,1155]
        - text: [1164,1165]
        - text: [1202,1203]
        - text: [1232,1233]
        - text: [1241,1242]
      comments: []

  - name: tpch_21
    input: |-
      select
              s_name,
              count(*) as numwait
      from
              supplier,
              lineitem l1,
              orders,
              nation
      where
              s_suppkey = l1.l_suppkey
              and o_orderkey = l1.l_orderkey
              and o_orderstatus = 'F'
              and l1.l_receiptdate > l1.l_commitdate
              and exists (
                      select
                              *
                      from
                              lineitem l2
                      where
                              l2.l_orderkey = l1.l_orderkey
                              and l2.l_suppkey <> l1.l_suppkey
              )
              and not exists (
                      select
                              *
                      from
                              lineitem l3
                      where
                              l3.l_orderkey = l1.l_orderkey
                              and l3.l_suppkey <> l1.l_suppkey
                              and l3.l_receiptdate > l3.l_commitdate
              )
              and s_nationkey = n_nationkey
              and n_name = 'SAUDI ARABIA'
      group by
              s_name
      order by
              numwait desc,
              s_name
      limit
      	100
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 184
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   ..limit\n	100"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "s_name,\n  ..as numwait"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "s_name"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_name"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_name"
                            children:
                              - type: NAME
                                text: "s_name"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "count(*) as numwait"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "count(*)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "count"
                            children:
                              - type: NAME
                                text: "count"
                          - key: SQL_FUNCTION_ARGUMENTS_STAR
                            type: BOOL
                            value: 1
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "numwait"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n     ..    nation"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "supplier"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "supplier"
                        children:
                          - type: NAME
                            text: "supplier"
                  - type: OBJECT_SQL_TABLEREF
                    text: "lineitem l1"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "lineitem"
                        children:
                          - type: NAME
                            text: "lineitem"
                      - key: SQL_TABLEREF_ALIAS
                        type: NAME
                        text: "l1"
                  - type: OBJECT_SQL_TABLEREF
                    text: "orders"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "orders"
                        children:
                          - type: NAME
                            text: "orders"
                  - type: OBJECT_SQL_TABLEREF
                    text: "nation"
                    children:
                      - key: SQL_TABLEREF_NAME
                        type: ARRAY
                        text: "nation"
                        children:
                          - type: NAME
                            text: "nation"
              - key: SQL_SELECT_WHERE
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "s_suppkey ..DI ARABIA'"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: AND
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "s_suppkey ..DI ARABIA'"
                    children:
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "s_suppkey ...l_suppkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "s_suppkey ...l_suppkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_suppkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_suppkey"
                                    children:
                                      - type: NAME
                                        text: "s_suppkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l1.l_suppkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l1.l_suppkey"
                                    children:
                                      - type: NAME
                                        text: "l1"
                                      - type: NAME
                                        text: "l_suppkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "o_orderkey..l_orderkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "o_orderkey..l_orderkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "o_orderkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "o_orderkey"
                                    children:
                                      - type: NAME
                                        text: "o_orderkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l1.l_orderkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l1.l_orderkey"
                                    children:
                                      - type: NAME
                                        text: "l1"
                                      - type: NAME
                                        text: "l_orderkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "o_orderstatus = 'F'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "o_orderstatus = 'F'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "o_orderstatus"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "o_orderstatus"
                                    children:
                                      - type: NAME
                                        text: "o_orderstatus"
                              - type: LITERAL_STRING
                                text: "'F'"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "l1.l_recei..commitdate"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: GREATER_THAN
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "l1.l_recei..commitdate"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l1.l_receiptdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l1.l_receiptdate"
                                    children:
                                      - type: NAME
                                        text: "l1"
                                      - type: NAME
                                        text: "l_receiptdate"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "l1.l_commitdate"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "l1.l_commitdate"
                                    children:
                                      - type: NAME
                                        text: "l1"
                                      - type: NAME
                                        text: "l_commitdate"
                      - type: OBJECT_SQL_EXISTS_EXPRESSION
                        text: "exists (\n ..\n        )"
                        children:
                          - key: SQL_EXISTS_EXPRESSION_STATEMENT
                            type: OBJECT_SQL_SELECT
                            text: "(\n        ..\n        )"
                            children:
                              - key: SQL_SELECT_TARGETS
                                type: ARRAY
                                text: "*"
                                children:
                                  - type: OBJECT_SQL_RESULT_TARGET
                                    text: "*"
                                    children:
                                      - key: SQL_RESULT_TARGET_STAR
                                        type: BOOL
                                        value: 1
                              - key: SQL_SELECT_FROM
                                type: ARRAY
                                text: "from\n     ..ineitem l2"
                                children:
                                  - type: OBJECT_SQL_TABLEREF
                                    text: "lineitem l2"
                                    children:
                                      - key: SQL_TABLEREF_NAME
                                        type: ARRAY
                                        text: "lineitem"
                                        children:
                                          - type: NAME
                                            text: "lineitem"
                                      - key: SQL_TABLEREF_ALIAS
                                        type: NAME
                                        text: "l2"
                              - key: SQL_SELECT_WHERE
                                type: OBJECT_SQL_NARY_EXPRESSION
                                text: "l2.l_order...l_suppkey"
                                children:
                                  - key: SQL_EXPRESSION_OPERATOR
                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                    value: AND
                                  - key: SQL_EXPRESSION_ARGS
                                    type: ARRAY
                                    text: "l2.l_order...l_suppkey"
                                    children:
                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                        text: "l2.l_order..l_orderkey"
                                        children:
                                          - key: SQL_EXPRESSION_OPERATOR
                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                            value: EQUAL
                                          - key: SQL_EXPRESSION_ARGS
                                            type: ARRAY
                                            text: "l2.l_order..l_orderkey"
                                            children:
                                              - type: OBJECT_SQL_COLUMN_REF
                                                text: "l2.l_orderkey"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "l2.l_orderkey"
                                                    children:
                                                      - type: NAME
                                                        text: "l2"
                                                      - type: NAME
                                                        text: "l_orderkey"
                                              - type: OBJECT_SQL_COLUMN_REF
                                                text: "l1.l_orderkey"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "l1.l_orderkey"
                                                    children:
                                                      - type: NAME
                                                        text: "l1"
                                                      - type: NAME
                                                        text: "l_orderkey"
                                      - type: OBJECT_SQL_NARY_EXPRESSION
                                        text: "l2.l_suppk...l_suppkey"
                                        children:
                                          - key: SQL_EXPRESSION_OPERATOR
                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                            value: NOT_EQUAL
                                          - key: SQL_EXPRESSION_ARGS
                                            type: ARRAY
                                            text: "l2.l_suppk...l_suppkey"
                                            children:
                                              - type: OBJECT_SQL_COLUMN_REF
                                                text: "l2.l_suppkey"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "l2.l_suppkey"
                                                    children:
                                                      - type: NAME
                                                        text: "l2"
                                                      - type: NAME
                                                        text: "l_suppkey"
                                              - type: OBJECT_SQL_COLUMN_REF
                                                text: "l1.l_suppkey"
                                                children:
                                                  - key: SQL_COLUMN_REF_PATH
                                                    type: ARRAY
                                                    text: "l1.l_suppkey"
                                                    children:
                                                      - type: NAME
                                                        text: "l1"
                                                      - type: NAME
                                                        text: "l_suppkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "not exists..\n        )"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: NOT
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "not exists..\n        )"
                            children:
                              - type: OBJECT_SQL_EXISTS_EXPRESSION
                                text: "exists (\n ..\n        )"
                                children:
                                  - key: SQL_EXISTS_EXPRESSION_STATEMENT
                                    type: OBJECT_SQL_SELECT
                                    text: "(\n        ..\n        )"
                                    children:
                                      - key: SQL_SELECT_TARGETS
                                        type: ARRAY
                                        text: "*"
                                        children:
                                          - type: OBJECT_SQL_RESULT_TARGET
                                            text: "*"
                                            children:
                                              - key: SQL_RESULT_TARGET_STAR
                                                type: BOOL
                                                value: 1
                                      - key: SQL_SELECT_FROM
                                        type: ARRAY
                                        text: "from\n     ..ineitem l3"
                                        children:
                                          - type: OBJECT_SQL_TABLEREF
                                            text: "lineitem l3"
                                            children:
                                              - key: SQL_TABLEREF_NAME
                                                type: ARRAY
                                                text: "lineitem"
                                                children:
                                                  - type: NAME
                                                    text: "lineitem"
                                              - key: SQL_TABLEREF_ALIAS
                                                type: NAME
                                                text: "l3"
                                      - key: SQL_SELECT_WHERE
                                        type: OBJECT_SQL_NARY_EXPRESSION
                                        text: "l3.l_order..commitdate"
                                        children:
                                          - key: SQL_EXPRESSION_OPERATOR
                                            type: ENUM_SQL_EXPRESSION_OPERATOR
                                            value: AND
                                          - key: SQL_EXPRESSION_ARGS
                                            type: ARRAY
                                            text: "l3.l_order..commitdate"
                                            children:
                                              - type: OBJECT_SQL_NARY_EXPRESSION
                                                text: "l3.l_order..l_orderkey"
                                                children:
                                                  - key: SQL_EXPRESSION_OPERATOR
                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                    value: EQUAL
                                                  - key: SQL_EXPRESSION_ARGS
                                                    type: ARRAY
                                                    text: "l3.l_order..l_orderkey"
                                                    children:
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "l3.l_orderkey"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "l3.l_orderkey"
                                                            children:
                                                              - type: NAME
                                                                text: "l3"
                                                              - type: NAME
                                                                text: "l_orderkey"
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "l1.l_orderkey"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "l1.l_orderkey"
                                                            children:
                                                              - type: NAME
                                                                text: "l1"
                                                              - type: NAME
                                                                text: "l_orderkey"
                                              - type: OBJECT_SQL_NARY_EXPRESSION
                                                text: "l3.l_suppk...l_suppkey"
                                                children:
                                                  - key: SQL_EXPRESSION_OPERATOR
                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                    value: NOT_EQUAL
                                                  - key: SQL_EXPRESSION_ARGS
                                                    type: ARRAY
                                                    text: "l3.l_suppk...l_suppkey"
                                                    children:
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "l3.l_suppkey"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "l3.l_suppkey"
                                                            children:
                                                              - type: NAME
                                                                text: "l3"
                                                              - type: NAME
                                                                text: "l_suppkey"
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "l1.l_suppkey"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "l1.l_suppkey"
                                                            children:
                                                              - type: NAME
                                                                text: "l1"
                                                              - type: NAME
                                                                text: "l_suppkey"
                                              - type: OBJECT_SQL_NARY_EXPRESSION
                                                text: "l3.l_recei..commitdate"
                                                children:
                                                  - key: SQL_EXPRESSION_OPERATOR
                                                    type: ENUM_SQL_EXPRESSION_OPERATOR
                                                    value: GREATER_THAN
                                                  - key: SQL_EXPRESSION_ARGS
                                                    type: ARRAY
                                                    text: "l3.l_recei..commitdate"
                                                    children:
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "l3.l_receiptdate"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "l3.l_receiptdate"
                                                            children:
                                                              - type: NAME
                                                                text: "l3"
                                                              - type: NAME
                                                                text: "l_receiptdate"
                                                      - type: OBJECT_SQL_COLUMN_REF
                                                        text: "l3.l_commitdate"
                                                        children:
                                                          - key: SQL_COLUMN_REF_PATH
                                                            type: ARRAY
                                                            text: "l3.l_commitdate"
                                                            children:
                                                              - type: NAME
                                                                text: "l3"
                                                              - type: NAME
                                                                text: "l_commitdate"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "s_nationke.._nationkey"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "s_nationke.._nationkey"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "s_nationkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "s_nationkey"
                                    children:
                                      - type: NAME
                                        text: "s_nationkey"
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "n_nationkey"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "n_nationkey"
                                    children:
                                      - type: NAME
                                        text: "n_nationkey"
                      - type: OBJECT_SQL_NARY_EXPRESSION
                        text: "n_name = '..DI ARABIA'"
                        children:
                          - key: SQL_EXPRESSION_OPERATOR
                            type: ENUM_SQL_EXPRESSION_OPERATOR
                            value: EQUAL
                          - key: SQL_EXPRESSION_ARGS
                            type: ARRAY
                            text: "n_name = '..DI ARABIA'"
                            children:
                              - type: OBJECT_SQL_COLUMN_REF
                                text: "n_name"
                                children:
                                  - key: SQL_COLUMN_REF_PATH
                                    type: ARRAY
                                    text: "n_name"
                                    children:
                                      - type: NAME
                                        text: "n_name"
                              - type: LITERAL_STRING
                                text: "'SAUDI ARABIA'"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by\n ..    s_name"
                children:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "s_name"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_name"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_name"
                            children:
                              - type: NAME
                                text: "s_name"
              - key: SQL_SELECT_LIMIT
                type: LITERAL_INTEGER
                text: "100"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by\n ..    s_name"
                children:
                  - type: OBJECT_SQL_ORDER
                    text: "numwait desc"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "numwait"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "numwait"
                            children:
                              - type: NAME
                                text: "numwait"
                      - key: SQL_ORDER_DIRECTION
                        type: ENUM_SQL_ORDER_DIRECTION
                        value: DESCENDING
                  - type: OBJECT_SQL_ORDER
                    text: "s_name"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "s_name"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "s_name"
                            children:
                              - type: NAME
                                text: "s_name"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [22,23]
        - text: [50,51]
        - text: [55,56]
        - text: [73,74]
        - text: [94,95]
        - text: [110,111]
        - text: [125,126]
        - text: [131,132]
        - text: [164,165]
        - text: [203,204]
        - text: [235,236]
        - text: [282,283]
        - text: [303,304]
        - text: [326,327]
        - text: [352,353]
        - text: [373,374]
        - text: [409,410]
        - text: [431,432]
        - text: [485,486]
        - text: [542,543]
        - text: [552,553]
        - text: [577,578]
        - text: [600,601]
        - text: [626,627]
        - text: [647,648]
        - text: [683,684]
        - text: [705,706]
        - text: [759,760]
        - text: [816,817]
        - text: [879,880]
        - text: [889,890]
        - text: [927,928]
        - text: [963,964]
        - text: [972,973]
        - text: [987,988]
        - text: [996,997]
        - text: [1018,1019]
        - text: [1033,1034]
        - text: [1039,1040]
      comments: []

  - name: tpch_22
    input: |-
      select
              cntrycode,
              count(*) as numcust,
              sum(c_acctbal) as totacctbal
      from
              (
                      select
                              substring(c_phone from 1 for 2) as cntrycode,
                              c_acctbal
                      from
                              customer
                      where
                              substring(c_phone from 1 for 2) in
                                      ('13', '31', '23', '29', '30', '18', '17')
                              and c_acctbal > (
                                      select
                                              avg(c_acctbal)
                                      from
                                              customer
                                      where
                                              c_acctbal > 0.00
                                              and substring(c_phone from 1 for 2) in
                                                      ('13', '31', '23', '29', '30', '18', '17')
                              )
                              and not exists (
                                      select
                                              *
                                      from
                                              orders
                                      where
                                              o_custkey = c_custkey
                              )
              ) as custsale
      group by
              cntrycode
      order by
              cntrycode
    expected:
      statements:
        - type: SELECT
          ast-begin: 0
          ast-size: 150
          ast:
            type: OBJECT_SQL_SELECT
            text: "select\n   .. cntrycode"
            children:
              - key: SQL_SELECT_TARGETS
                type: ARRAY
                text: "cntrycode,..totacctbal"
                children:
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "cntrycode"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "cntrycode"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "cntrycode"
                            children:
                              - type: NAME
                                text: "cntrycode"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "count(*) as numcust"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "count(*)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "count"
                            children:
                              - type: NAME
                                text: "count"
                          - key: SQL_FUNCTION_ARGUMENTS_STAR
                            type: BOOL
                            value: 1
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "numcust"
                  - type: OBJECT_SQL_RESULT_TARGET
                    text: "sum(c_acct..totacctbal"
                    children:
                      - key: SQL_RESULT_TARGET_VALUE
                        type: OBJECT_SQL_FUNCTION_EXPRESSION
                        text: "sum(c_acctbal)"
                        children:
                          - key: SQL_FUNCTION_NAME
                            type: ARRAY
                            text: "sum"
                            children:
                              - type: NAME
                                text: "sum"
                          - key: SQL_FUNCTION_ARGUMENTS
                            type: ARRAY
                            text: "c_acctbal"
                            children:
                              - type: OBJECT_SQL_FUNCTION_ARG
                                text: "c_acctbal"
                                children:
                                  - key: SQL_FUNCTION_ARG_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "c_acctbal"
                                    children:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "c_acctbal"
                                        children:
                                          - type: NAME
                                            text: "c_acctbal"
                      - key: SQL_RESULT_TARGET_NAME
                        type: NAME
                        text: "totacctbal"
              - key: SQL_SELECT_FROM
                type: ARRAY
                text: "from\n     ..s custsale"
                children:
                  - type: OBJECT_SQL_TABLEREF
                    text: "(\n        ..s custsale"
                    children:
                      - key: SQL_TABLEREF_ALIAS
                        type: NAME
                        text: "custsale"
                      - key: SQL_TABLEREF_TABLE
                        type: OBJECT_SQL_SELECT
                        text: "(\n        ..\n        )"
                        children:
                          - key: SQL_SELECT_TARGETS
                            type: ARRAY
                            text: "substring(.. c_acctbal"
                            children:
                              - type: OBJECT_SQL_RESULT_TARGET
                                text: "substring(.. cntrycode"
                                children:
                                  - key: SQL_RESULT_TARGET_VALUE
                                    type: OBJECT_SQL_FUNCTION_EXPRESSION
                                    text: "substring(..m 1 for 2)"
                                    children:
                                      - key: SQL_FUNCTION_SUBSTRING_ARGS
                                        type: OBJECT_SQL_FUNCTION_SUBSTRING_ARGS
                                        text: "c_phone fr..om 1 for 2"
                                        children:
                                          - key: SQL_FUNCTION_SUBSTRING_INPUT
                                            type: OBJECT_SQL_COLUMN_REF
                                            text: "c_phone"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "c_phone"
                                                children:
                                                  - type: NAME
                                                    text: "c_phone"
                                          - key: SQL_FUNCTION_SUBSTRING_FROM
                                            type: LITERAL_INTEGER
                                            text: "1"
                                          - key: SQL_FUNCTION_SUBSTRING_FOR
                                            type: LITERAL_INTEGER
                                            text: "2"
                                      - key: SQL_FUNCTION_NAME
                                        type: ENUM_SQL_KNOWN_FUNCTION
                                        value: SUBSTRING
                                  - key: SQL_RESULT_TARGET_NAME
                                    type: NAME
                                    text: "cntrycode"
                              - type: OBJECT_SQL_RESULT_TARGET
                                text: "c_acctbal"
                                children:
                                  - key: SQL_RESULT_TARGET_VALUE
                                    type: OBJECT_SQL_COLUMN_REF
                                    text: "c_acctbal"
                                    children:
                                      - key: SQL_COLUMN_REF_PATH
                                        type: ARRAY
                                        text: "c_acctbal"
                                        children:
                                          - type: NAME
                                            text: "c_acctbal"
                          - key: SQL_SELECT_FROM
                            type: ARRAY
                            text: "from\n     ..  customer"
                            children:
                              - type: OBJECT_SQL_TABLEREF
                                text: "customer"
                                children:
                                  - key: SQL_TABLEREF_NAME
                                    type: ARRAY
                                    text: "customer"
                                    children:
                                      - type: NAME
                                        text: "customer"
                          - key: SQL_SELECT_WHERE
                            type: OBJECT_SQL_NARY_EXPRESSION
                            text: "substring(..         )"
                            children:
                              - key: SQL_EXPRESSION_OPERATOR
                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                value: AND
                              - key: SQL_EXPRESSION_ARGS
                                type: ARRAY
                                text: "substring(..         )"
                                children:
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "substring(..18', '17')"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: IN
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "substring(..18', '17')"
                                        children:
                                          - type: OBJECT_SQL_FUNCTION_EXPRESSION
                                            text: "substring(..m 1 for 2)"
                                            children:
                                              - key: SQL_FUNCTION_SUBSTRING_ARGS
                                                type: OBJECT_SQL_FUNCTION_SUBSTRING_ARGS
                                                text: "c_phone fr..om 1 for 2"
                                                children:
                                                  - key: SQL_FUNCTION_SUBSTRING_INPUT
                                                    type: OBJECT_SQL_COLUMN_REF
                                                    text: "c_phone"
                                                    children:
                                                      - key: SQL_COLUMN_REF_PATH
                                                        type: ARRAY
                                                        text: "c_phone"
                                                        children:
                                                          - type: NAME
                                                            text: "c_phone"
                                                  - key: SQL_FUNCTION_SUBSTRING_FROM
                                                    type: LITERAL_INTEGER
                                                    text: "1"
                                                  - key: SQL_FUNCTION_SUBSTRING_FOR
                                                    type: LITERAL_INTEGER
                                                    text: "2"
                                              - key: SQL_FUNCTION_NAME
                                                type: ENUM_SQL_KNOWN_FUNCTION
                                                value: SUBSTRING
                                          - type: ARRAY
                                            text: "('13', '31..18', '17')"
                                            children:
                                              - type: LITERAL_STRING
                                                text: "'13'"
                                              - type: LITERAL_STRING
                                                text: "'31'"
                                              - type: LITERAL_STRING
                                                text: "'23'"
                                              - type: LITERAL_STRING
                                                text: "'29'"
                                              - type: LITERAL_STRING
                                                text: "'30'"
                                              - type: LITERAL_STRING
                                                text: "'18'"
                                              - type: LITERAL_STRING
                                                text: "'17'"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "c_acctbal ..         )"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: GREATER_THAN
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "c_acctbal ..         )"
                                        children:
                                          - type: OBJECT_SQL_COLUMN_REF
                                            text: "c_acctbal"
                                            children:
                                              - key: SQL_COLUMN_REF_PATH
                                                type: ARRAY
                                                text: "c_acctbal"
                                                children:
                                                  - type: NAME
                                                    text: "c_acctbal"
                                          - type: OBJECT_SQL_SELECT_EXPRESSION
                                            text: "(\n        ..         )"
                                            children:
                                              - key: SQL_SELECT_EXPRESSION_STATEMENT
                                                type: OBJECT_SQL_SELECT
                                                text: "(\n        ..         )"
                                                children:
                                                  - key: SQL_SELECT_TARGETS
                                                    type: ARRAY
                                                    text: "avg(c_acctbal)"
                                                    children:
                                                      - type: OBJECT_SQL_RESULT_TARGET
                                                        text: "avg(c_acctbal)"
                                                        children:
                                                          - key: SQL_RESULT_TARGET_VALUE
                                                            type: OBJECT_SQL_FUNCTION_EXPRESSION
                                                            text: "avg(c_acctbal)"
                                                            children:
                                                              - key: SQL_FUNCTION_NAME
                                                                type: ARRAY
                                                                text: "avg"
                                                                children:
                                                                  - type: NAME
                                                                    text: "avg"
                                                              - key: SQL_FUNCTION_ARGUMENTS
                                                                type: ARRAY
                                                                text: "c_acctbal"
                                                                children:
                                                                  - type: OBJECT_SQL_FUNCTION_ARG
                                                                    text: "c_acctbal"
                                                                    children:
                                                                      - key: SQL_FUNCTION_ARG_VALUE
                                                                        type: OBJECT_SQL_COLUMN_REF
                                                                        text: "c_acctbal"
                                                                        children:
                                                                          - key: SQL_COLUMN_REF_PATH
                                                                            type: ARRAY
                                                                            text: "c_acctbal"
                                                                            children:
                                                                              - type: NAME
                                                                                text: "c_acctbal"
                                                  - key: SQL_SELECT_FROM
                                                    type: ARRAY
                                                    text: "from\n     ..  customer"
                                                    children:
                                                      - type: OBJECT_SQL_TABLEREF
                                                        text: "customer"
                                                        children:
                                                          - key: SQL_TABLEREF_NAME
                                                            type: ARRAY
                                                            text: "customer"
                                                            children:
                                                              - type: NAME
                                                                text: "customer"
                                                  - key: SQL_SELECT_WHERE
                                                    type: OBJECT_SQL_NARY_EXPRESSION
                                                    text: "c_acctbal ..18', '17')"
                                                    children:
                                                      - key: SQL_EXPRESSION_OPERATOR
                                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                                        value: AND
                                                      - key: SQL_EXPRESSION_ARGS
                                                        type: ARRAY
                                                        text: "c_acctbal ..18', '17')"
                                                        children:
                                                          - type: OBJECT_SQL_NARY_EXPRESSION
                                                            text: "c_acctbal > 0.00"
                                                            children:
                                                              - key: SQL_EXPRESSION_OPERATOR
                                                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                                                value: GREATER_THAN
                                                              - key: SQL_EXPRESSION_ARGS
                                                                type: ARRAY
                                                                text: "c_acctbal > 0.00"
                                                                children:
                                                                  - type: OBJECT_SQL_COLUMN_REF
                                                                    text: "c_acctbal"
                                                                    children:
                                                                      - key: SQL_COLUMN_REF_PATH
                                                                        type: ARRAY
                                                                        text: "c_acctbal"
                                                                        children:
                                                                          - type: NAME
                                                                            text: "c_acctbal"
                                                                  - type: LITERAL_FLOAT
                                                                    text: "0.00"
                                                          - type: OBJECT_SQL_NARY_EXPRESSION
                                                            text: "substring(..18', '17')"
                                                            children:
                                                              - key: SQL_EXPRESSION_OPERATOR
                                                                type: ENUM_SQL_EXPRESSION_OPERATOR
                                                                value: IN
                                                              - key: SQL_EXPRESSION_ARGS
                                                                type: ARRAY
                                                                text: "substring(..18', '17')"
                                                                children:
                                                                  - type: OBJECT_SQL_FUNCTION_EXPRESSION
                                                                    text: "substring(..m 1 for 2)"
                                                                    children:
                                                                      - key: SQL_FUNCTION_SUBSTRING_ARGS
                                                                        type: OBJECT_SQL_FUNCTION_SUBSTRING_ARGS
                                                                        text: "c_phone fr..om 1 for 2"
                                                                        children:
                                                                          - key: SQL_FUNCTION_SUBSTRING_INPUT
                                                                            type: OBJECT_SQL_COLUMN_REF
                                                                            text: "c_phone"
                                                                            children:
                                                                              - key: SQL_COLUMN_REF_PATH
                                                                                type: ARRAY
                                                                                text: "c_phone"
                                                                                children:
                                                                                  - type: NAME
                                                                                    text: "c_phone"
                                                                          - key: SQL_FUNCTION_SUBSTRING_FROM
                                                                            type: LITERAL_INTEGER
                                                                            text: "1"
                                                                          - key: SQL_FUNCTION_SUBSTRING_FOR
                                                                            type: LITERAL_INTEGER
                                                                            text: "2"
                                                                      - key: SQL_FUNCTION_NAME
                                                                        type: ENUM_SQL_KNOWN_FUNCTION
                                                                        value: SUBSTRING
                                                                  - type: ARRAY
                                                                    text: "('13', '31..18', '17')"
                                                                    children:
                                                                      - type: LITERAL_STRING
                                                                        text: "'13'"
                                                                      - type: LITERAL_STRING
                                                                        text: "'31'"
                                                                      - type: LITERAL_STRING
                                                                        text: "'23'"
                                                                      - type: LITERAL_STRING
                                                                        text: "'29'"
                                                                      - type: LITERAL_STRING
                                                                        text: "'30'"
                                                                      - type: LITERAL_STRING
                                                                        text: "'18'"
                                                                      - type: LITERAL_STRING
                                                                        text: "'17'"
                                  - type: OBJECT_SQL_NARY_EXPRESSION
                                    text: "not exists..         )"
                                    children:
                                      - key: SQL_EXPRESSION_OPERATOR
                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                        value: NOT
                                      - key: SQL_EXPRESSION_ARGS
                                        type: ARRAY
                                        text: "not exists..         )"
                                        children:
                                          - type: OBJECT_SQL_EXISTS_EXPRESSION
                                            text: "exists (\n ..         )"
                                            children:
                                              - key: SQL_EXISTS_EXPRESSION_STATEMENT
                                                type: OBJECT_SQL_SELECT
                                                text: "(\n        ..         )"
                                                children:
                                                  - key: SQL_SELECT_TARGETS
                                                    type: ARRAY
                                                    text: "*"
                                                    children:
                                                      - type: OBJECT_SQL_RESULT_TARGET
                                                        text: "*"
                                                        children:
                                                          - key: SQL_RESULT_TARGET_STAR
                                                            type: BOOL
                                                            value: 1
                                                  - key: SQL_SELECT_FROM
                                                    type: ARRAY
                                                    text: "from\n     ..    orders"
                                                    children:
                                                      - type: OBJECT_SQL_TABLEREF
                                                        text: "orders"
                                                        children:
                                                          - key: SQL_TABLEREF_NAME
                                                            type: ARRAY
                                                            text: "orders"
                                                            children:
                                                              - type: NAME
                                                                text: "orders"
                                                  - key: SQL_SELECT_WHERE
                                                    type: OBJECT_SQL_NARY_EXPRESSION
                                                    text: "o_custkey .. c_custkey"
                                                    children:
                                                      - key: SQL_EXPRESSION_OPERATOR
                                                        type: ENUM_SQL_EXPRESSION_OPERATOR
                                                        value: EQUAL
                                                      - key: SQL_EXPRESSION_ARGS
                                                        type: ARRAY
                                                        text: "o_custkey .. c_custkey"
                                                        children:
                                                          - type: OBJECT_SQL_COLUMN_REF
                                                            text: "o_custkey"
                                                            children:
                                                              - key: SQL_COLUMN_REF_PATH
                                                                type: ARRAY
                                                                text: "o_custkey"
                                                                children:
                                                                  - type: NAME
                                                                    text: "o_custkey"
                                                          - type: OBJECT_SQL_COLUMN_REF
                                                            text: "c_custkey"
                                                            children:
                                                              - key: SQL_COLUMN_REF_PATH
                                                                type: ARRAY
                                                                text: "c_custkey"
                                                                children:
                                                                  - type: NAME
                                                                    text: "c_custkey"
              - key: SQL_SELECT_GROUPS
                type: ARRAY
                text: "group by\n .. cntrycode"
                children:
                  - type: OBJECT_SQL_GROUP_BY_ITEM
                    text: "cntrycode"
                    children:
                      - key: SQL_GROUP_BY_ITEM_TYPE
                        type: ENUM_SQL_GROUP_BY_ITEM_TYPE
                        value: EXPRESSION
                      - key: SQL_GROUP_BY_ITEM_ARG
                        type: OBJECT_SQL_COLUMN_REF
                        text: "cntrycode"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "cntrycode"
                            children:
                              - type: NAME
                                text: "cntrycode"
              - key: SQL_SELECT_ORDER
                type: ARRAY
                text: "order by\n .. cntrycode"
                children:
                  - type: OBJECT_SQL_ORDER
                    text: "cntrycode"
                    children:
                      - key: SQL_ORDER_VALUE
                        type: OBJECT_SQL_COLUMN_REF
                        text: "cntrycode"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "cntrycode"
                            children:
                              - type: NAME
                                text: "cntrycode"
      scanner-errors: []
      parser-errors: []
      line-breaks:
        - text: [6,7]
        - text: [25,26]
        - text: [54,55]
        - text: [91,92]
        - text: [96,97]
        - text: [106,107]
        - text: [129,130]
        - text: [199,200]
        - text: [233,234]
        - text: [254,255]
        - text: [287,288]
        - text: [309,310]
        - text: [368,369]
        - text: [443,444]
        - text: [485,486]
        - text: [524,525]
        - text: [579,580]
        - text: [616,617]
        - text: [665,666]
        - text: [703,704]
        - text: [760,761]
        - text: [839,840]
        - text: [930,931]
        - text: [956,957]
        - text: [997,998]
        - text: [1036,1037]
        - text: [1078,1079]
        - text: [1115,1116]
        - text: [1162,1163]
        - text: [1200,1201]
        - text: [1262,1263]
        - text: [1288,1289]
        - text: [1310,1311]
        - text: [1319,1320]
        - text: [1337,1338]
        - text: [1346,1347]
      comments: []
