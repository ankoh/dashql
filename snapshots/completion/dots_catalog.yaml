completion-snapshots:

  - name: dots_catalog_complete_trailing_dot
    catalog:
      script:
        input: create table dbname.schemaname.foo(a int);
        catalog-id: 1
        tables:
          - catalog-id: "256.65536.4294967296"
            name: foo
            text: "create tab..foo(a int)"
            columns:
              - catalog-id: "256.65536.4294967296.0"
                name: a
                text: "a int"
        errors: []
    editor:
      input: select * from dbname.
      catalog-id: 0
      errors: []
      table-refs:
        - type: name/unresolved
          statement-id: 0
          text: "dbname."
    cursor:
      search:
        text: dbname.
        index: 7
    completions:
      limit: 3
      strategy: TABLE_REF
      dot: 1
      symbol: OBJECT_EXT_TRAILING_DOT
      relative: END_OF_SYMBOL
      entries:
        - score: 22
          value: schemaname
          name-tags: [SCHEMA_NAME]
          candidate-tags: [DOT_RESOLUTION_SCHEMA,THROUGH_CATALOG]
          location: ""
          location-qualified: "dbname."
          objects:
            - score: 2
              type: schema
              id: "256.65536"
              candidate-tags: [DOT_RESOLUTION_SCHEMA,THROUGH_CATALOG]
      text: "."

  - name: dots_catalog_complete_at_dot
    catalog:
      script:
        input: create table dbname.schemaname.foo(a int);
        catalog-id: 1
        tables:
          - catalog-id: "256.65536.4294967296"
            name: foo
            text: "create tab..foo(a int)"
            columns:
              - catalog-id: "256.65536.4294967296.0"
                name: a
                text: "a int"
        errors: []
    editor:
      input: select * from dbname.sch
      catalog-id: 0
      errors: []
      table-refs:
        - type: name/unresolved
          statement-id: 0
          text: "dbname.sch"
    cursor:
      search:
        text: .sch
        index: 0
    completions:
      limit: 3
      strategy: TABLE_REF
      symbol: NAME
      relative: END_OF_SYMBOL
      entries: []
      text: "dbname"

  - name: dots_catalog_complete_previous_dot
    catalog:
      script:
        input: create table dbname.schemaname.foo(a int);
        catalog-id: 1
        tables:
          - catalog-id: "256.65536.4294967296"
            name: foo
            text: "create tab..foo(a int)"
            columns:
              - catalog-id: "256.65536.4294967296.0"
                name: a
                text: "a int"
        errors: []
    editor:
      input: select * from dbname.sch
      catalog-id: 0
      errors: []
      table-refs:
        - type: name/unresolved
          statement-id: 0
          text: "dbname.sch"
    cursor:
      search:
        text: .sch
        index: 1
    completions:
      limit: 3
      strategy: TABLE_REF
      dot: 1
      symbol: NAME
      relative: BEGIN_OF_SYMBOL
      entries:
        - score: 22
          value: schemaname
          name-tags: [SCHEMA_NAME]
          candidate-tags: [DOT_RESOLUTION_SCHEMA,THROUGH_CATALOG]
          location: "sch"
          location-qualified: "dbname.sch"
          objects:
            - score: 2
              type: schema
              id: "256.65536"
              candidate-tags: [DOT_RESOLUTION_SCHEMA,THROUGH_CATALOG]
      text: "sch"

  - name: dots_catalog_complete_previous_dot_quotes
    catalog:
      script:
        input: create table dbname.schemaname.foo(a int);
        catalog-id: 1
        tables:
          - catalog-id: "256.65536.4294967296"
            name: foo
            text: "create tab..foo(a int)"
            columns:
              - catalog-id: "256.65536.4294967296.0"
                name: a
                text: "a int"
        errors: []
    editor:
      input: select * from dbname."sch"
      catalog-id: 0
      errors: []
      table-refs:
        - type: name/unresolved
          statement-id: 0
          text: "dbname.\"sch\""
    cursor:
      search:
        text: name.
        index: 5
    completions:
      limit: 3
      strategy: TABLE_REF
      dot: 1
      symbol: NAME
      relative: BEGIN_OF_SYMBOL
      entries:
        - score: 22
          value: schemaname
          name-tags: [SCHEMA_NAME]
          candidate-tags: [DOT_RESOLUTION_SCHEMA,THROUGH_CATALOG]
          location: "\"sch\""
          location-qualified: "dbname.\"sch\""
          objects:
            - score: 2
              type: schema
              id: "256.65536"
              candidate-tags: [DOT_RESOLUTION_SCHEMA,THROUGH_CATALOG]
      text: "\"sch\""

  - name: dots_catalog_same_script_complete_schema
    catalog: {}
    editor:
      input: |-
        create table dbname.schemaname.foo(a int);
        select * from dbname.
      catalog-id: 0
      tables:
        - catalog-id: "256.65536.0"
          name: foo
          text: "create tab..foo(a int)"
          columns:
            - catalog-id: "256.65536.0.0"
              name: a
              text: "a int"
      errors: []
      table-refs:
        - type: name/unresolved
          statement-id: 1
          text: "dbname."
    cursor:
      search:
        text: from dbname.
        index: 12
    completions:
      limit: 3
      strategy: TABLE_REF
      dot: 1
      symbol: OBJECT_EXT_TRAILING_DOT
      relative: END_OF_SYMBOL
      entries:
        - score: 22
          value: schemaname
          name-tags: [SCHEMA_NAME]
          candidate-tags: [DOT_RESOLUTION_SCHEMA]
          location: ""
          location-qualified: "dbname."
          objects:
            - score: 2
              type: schema
              id: "256.65536"
              candidate-tags: [DOT_RESOLUTION_SCHEMA]
      text: "."
