analyzer-snapshots:

  - name: cross_1_entry_explicit
    catalog:
      script:
        input: |-
          create table db1.schema1.A (a int, b int);
          create table db2.schema2.A (c int, d int);
        catalog-id: 1
        tables:
          - catalog-id: "256.65536.4294967296"
            name: a
            text: "create tab..nt, b int)"
            columns:
              - catalog-id: "256.65536.4294967296.0"
                name: a
                text: "a int"
              - catalog-id: "256.65536.4294967296.1"
                name: b
                text: "b int"
          - catalog-id: "257.65537.4294967297"
            name: a
            text: "create tab..nt, d int)"
            columns:
              - catalog-id: "257.65537.4294967297.0"
                name: c
                text: "c int"
              - catalog-id: "257.65537.4294967297.1"
                name: d
                text: "d int"
        errors: []
    script:
      input: select * from db1.schema1.A x, db2.schema2.A y where x.a = c;
      catalog-id: 0
      errors: []
      table-refs:
        - type: name/catalog
          catalog-id: "256.65536.4294967296"
          statement-id: 0
          text: "db1.schema1.A x"
        - type: name/catalog
          catalog-id: "257.65537.4294967297"
          statement-id: 0
          text: "db2.schema2.A y"
      expressions:
        - expression-idx: 0
          type: colref/catalog
          catalog: "256.65536.4294967296.0"
          statement-id: 0
          text: "x.a"
        - expression-idx: 1
          type: colref/catalog
          catalog: "257.65537.4294967297.0"
          statement-id: 0
          text: "c"

  - name: cross_1_entry_implicit
    catalog:
      script:
        input: |-
          create table A (a int, b int);
          create table db2.schema2.A (c int, d int);
        catalog-id: 1
        tables:
          - catalog-id: "256.65536.4294967296"
            name: a
            text: "create tab..nt, b int)"
            columns:
              - catalog-id: "256.65536.4294967296.0"
                name: a
                text: "a int"
              - catalog-id: "256.65536.4294967296.1"
                name: b
                text: "b int"
          - catalog-id: "257.65537.4294967297"
            name: a
            text: "create tab..nt, d int)"
            columns:
              - catalog-id: "257.65537.4294967297.0"
                name: c
                text: "c int"
              - catalog-id: "257.65537.4294967297.1"
                name: d
                text: "d int"
        errors: []
    script:
      input: select * from db1.schema1.A x, db2.schema2.A where x.a = c;
      catalog-id: 0
      errors: []
      table-refs:
        - type: name/unresolved
          statement-id: 0
          text: "db1.schema1.A x"
        - type: name/catalog
          catalog-id: "257.65537.4294967297"
          statement-id: 0
          text: "db2.schema2.A"
      expressions:
        - expression-idx: 0
          type: colref/unresolved
          statement-id: 0
          text: "x.a"
        - expression-idx: 1
          type: colref/catalog
          catalog: "257.65537.4294967297.0"
          statement-id: 0
          text: "c"

  - name: cross_2_entries_implicit
    catalog:
      script:
        input: create table A (a int, b int);
        catalog-id: 1
        tables:
          - catalog-id: "256.65536.4294967296"
            name: a
            text: "create tab..nt, b int)"
            columns:
              - catalog-id: "256.65536.4294967296.0"
                name: a
                text: "a int"
              - catalog-id: "256.65536.4294967296.1"
                name: b
                text: "b int"
        errors: []
    script:
      input: select * from db1.schema1.A, db2.schema2.B where a = c;
      catalog-id: 0
      errors: []
      table-refs:
        - type: name/unresolved
          statement-id: 0
          text: "db1.schema1.A"
        - type: name/unresolved
          statement-id: 0
          text: "db2.schema2.B"
      expressions:
        - expression-idx: 0
          type: colref/unresolved
          statement-id: 0
          text: "a"
        - expression-idx: 1
          type: colref/unresolved
          statement-id: 0
          text: "c"

  - name: cross_2_entries_explicit
    catalog:
      script:
        input: create table db1.schema1.A (a int, b int);
        catalog-id: 1
        tables:
          - catalog-id: "256.65536.4294967296"
            name: a
            text: "create tab..nt, b int)"
            columns:
              - catalog-id: "256.65536.4294967296.0"
                name: a
                text: "a int"
              - catalog-id: "256.65536.4294967296.1"
                name: b
                text: "b int"
        errors: []
    script:
      input: select * from db1.schema1.A, db2.schema2.B where a = c;
      catalog-id: 0
      errors: []
      table-refs:
        - type: name/catalog
          catalog-id: "256.65536.4294967296"
          statement-id: 0
          text: "db1.schema1.A"
        - type: name/unresolved
          statement-id: 0
          text: "db2.schema2.B"
      expressions:
        - expression-idx: 0
          type: colref/catalog
          catalog: "256.65536.4294967296.0"
          statement-id: 0
          text: "a"
        - expression-idx: 1
          type: colref/unresolved
          statement-id: 0
          text: "c"

  - name: cross_first_schema_wins
    catalog:
      script:
        input: create table db1.schema1.A (a int, b int);
        catalog-id: 1
        tables:
          - catalog-id: "256.65536.4294967296"
            name: a
            text: "create tab..nt, b int)"
            columns:
              - catalog-id: "256.65536.4294967296.0"
                name: a
                text: "a int"
              - catalog-id: "256.65536.4294967296.1"
                name: b
                text: "b int"
        errors: []
    script:
      input: |-
        select * from db1.schema1.A where a = 1;
        select * from db1.schema1.A where c = 1;
      catalog-id: 0
      errors: []
      table-refs:
        - type: name/catalog
          catalog-id: "256.65536.4294967296"
          statement-id: 0
          text: "db1.schema1.A"
        - type: name/catalog
          catalog-id: "256.65536.4294967296"
          statement-id: 1
          text: "db1.schema1.A"
      expressions:
        - expression-idx: 0
          type: colref/catalog
          catalog: "256.65536.4294967296.0"
          statement-id: 0
          text: "a"
        - expression-idx: 1
          type: colref/unresolved
          statement-id: 1
          text: "c"
        - expression-idx: 2
          type: literal/integer
          is-const: true
          text: "1"
        - expression-idx: 3
          type: literal/integer
          is-const: true
          statement-id: 1
          text: "1"
        - expression-idx: 4
          type: comparison
          op: EQUAL
          arg-left: 0
          arg-right: 2
          restriction-target: 0
          text: "a = 1"
        - expression-idx: 5
          type: comparison
          op: EQUAL
          arg-left: 1
          arg-right: 3
          restriction-target: 1
          statement-id: 1
          text: "c = 1"
      constants:
        - expression: 2
          text: "1"
        - expression: 3
          text: "1"
      column-filters:
        - expression: 4
          snippet:
            signature-template: 1794172684583478586
            signature-raw: 6895659058441710673
            text: a = 1
            ast:
              ast-nodes: 7
              ast-bytes: 168
              ast:
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "a = 1"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: EQUAL
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "a = 1"
                    children:
                      - type: OBJECT_SQL_COLUMN_REF
                        text: "a"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "a"
                            children:
                              - type: NAME
                                text: "a"
                      - type: LITERAL_INTEGER
                        text: "1"
        - expression: 5
          snippet:
            signature-template: 1794172684583478586
            signature-raw: 4667908901404270351
            text: c = 1
            ast:
              ast-nodes: 7
              ast-bytes: 168
              ast:
                type: OBJECT_SQL_NARY_EXPRESSION
                text: "c = 1"
                children:
                  - key: SQL_EXPRESSION_OPERATOR
                    type: ENUM_SQL_EXPRESSION_OPERATOR
                    value: EQUAL
                  - key: SQL_EXPRESSION_ARGS
                    type: ARRAY
                    text: "c = 1"
                    children:
                      - type: OBJECT_SQL_COLUMN_REF
                        text: "c"
                        children:
                          - key: SQL_COLUMN_REF_PATH
                            type: ARRAY
                            text: "c"
                            children:
                              - type: NAME
                                text: "c"
                      - type: LITERAL_INTEGER
                        text: "1"
